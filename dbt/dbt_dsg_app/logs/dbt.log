[0m16:59:06.896861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3817c8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb370727cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb370727e80>]}


============================== 16:59:06.901655 | 023dfbba-6fea-4606-989d-b0904c6e47c4 ==============================
[0m16:59:06.901655 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:59:06.902213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:59:06.902687 [info ] [MainThread]: dbt version: 1.5.1
[0m16:59:06.902963 [info ] [MainThread]: python version: 3.9.13
[0m16:59:06.903223 [info ] [MainThread]: python path: /Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/bin/python
[0m16:59:06.903480 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m16:59:06.903731 [info ] [MainThread]: Using profiles.yml file at /Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/profiles.yml
[0m16:59:06.903992 [info ] [MainThread]: Using dbt_project.yml file at /Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/dbt_project.yml
[0m16:59:06.904251 [info ] [MainThread]: Configuration:
[0m16:59:11.310665 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:59:11.330686 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:59:11.331212 [info ] [MainThread]: Required dependencies:
[0m16:59:11.331994 [debug] [MainThread]: Executing "git --help"
[0m16:59:11.686470 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:59:11.687443 [debug] [MainThread]: STDERR: "b''"
[0m16:59:11.687752 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:59:11.688076 [info ] [MainThread]: Connection:
[0m16:59:11.688429 [info ] [MainThread]:   account: bcb55215.us-east-1
[0m16:59:11.688701 [info ] [MainThread]:   user: aokubanjo
[0m16:59:11.688953 [info ] [MainThread]:   database: DEV_QA
[0m16:59:11.689533 [info ] [MainThread]:   schema: DBT_POC
[0m16:59:11.689876 [info ] [MainThread]:   warehouse: dev_transform
[0m16:59:11.690147 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:59:11.690416 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:59:11.690682 [info ] [MainThread]:   query_tag: None
[0m16:59:11.699565 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:59:11.700879 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:59:11.701139 [debug] [MainThread]: On debug: select 1 as id
[0m16:59:11.701379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:15.341226 [debug] [MainThread]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:59:15.346880 [debug] [MainThread]: On debug: Close
[0m16:59:15.551595 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:59:15.552916 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:59:15.555416 [debug] [MainThread]: Command `dbt debug` succeeded at 16:59:15.554727 after 8.70 seconds
[0m16:59:15.556173 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:59:15.556845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3817c8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3902790a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb390d4a700>]}
[0m16:59:15.557610 [debug] [MainThread]: Flushing usage events
[0m23:22:18.286801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dcb2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dcb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dcbf90>]}


============================== 23:22:18.294672 | 6d71e9cc-4c7c-4dac-ba93-8e4cb2491932 ==============================
[0m23:22:18.294672 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:22:18.298069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:22:18.799791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dcba10>]}
[0m23:22:18.825528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dfd7d0>]}
[0m23:22:18.844525 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:22:18.859097 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:22:18.861758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff787ab790>]}
[0m23:22:19.445404 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m23:22:19.458211 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m23:22:19.463346 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m23:22:19.468654 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_output.sql
[0m23:22:19.475746 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m23:22:19.484738 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m23:22:19.493155 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m23:22:19.498790 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m23:22:19.508658 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m23:22:19.514067 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m23:22:19.520879 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m23:22:19.527195 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m23:22:19.534421 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m23:22:19.539497 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m23:22:19.546855 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m23:22:19.593013 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m23:22:19.707592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7877b250>]}
[0m23:22:19.715743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7817fb50>]}
[0m23:22:19.718723 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:22:19.722275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7817fd10>]}
[0m23:22:19.732070 [info ] [MainThread]: 
[0m23:22:19.735773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:22:19.739198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m23:22:19.751358 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m23:22:19.754392 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m23:22:19.758431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:20.822409 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m23:22:20.833467 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m23:22:21.084084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m23:22:21.094479 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m23:22:21.097615 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m23:22:21.106558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:21.511588 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m23:22:21.518403 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m23:22:21.729995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78173d10>]}
[0m23:22:21.735644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:22:21.740627 [info ] [MainThread]: 
[0m23:22:21.787258 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m23:22:21.790967 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m23:22:21.802797 [info ] [Thread-3  ]: 3 of 12 START sql table model DBT_POC.stg_ipflow_success_data .................. [RUN]
[0m23:22:21.799638 [info ] [Thread-1  ]: 1 of 12 START sql table model DBT_POC.src_ipflow_merge_output .................. [RUN]
[0m23:22:21.810482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m23:22:21.805967 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m23:22:21.791723 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m23:22:21.860536 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m23:22:21.865546 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m23:22:21.868723 [info ] [Thread-2  ]: 2 of 12 START sql table model DBT_POC.stg_ipflow_input_data .................... [RUN]
[0m23:22:21.884869 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_input_data'
[0m23:22:21.887786 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m23:22:21.874662 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m23:22:21.880792 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m23:22:21.911842 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 23:22:21.878653 => 23:22:21.911561
[0m23:22:21.915865 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m23:22:21.903851 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m23:22:21.938852 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 23:22:21.901496 => 23:22:21.938648
[0m23:22:21.908750 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 23:22:21.871836 => 23:22:21.908421
[0m23:22:21.953187 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m23:22:21.949496 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m23:22:21.947869 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m23:22:21.960355 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m23:22:21.966256 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m23:22:21.982348 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m23:22:21.992141 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m23:22:21.997032 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m23:22:21.999788 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m23:22:22.003237 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m23:22:22.011663 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 3700
        );
[0m23:22:22.015854 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:22:22.019662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:22:22.023962 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:22:24.299046 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m23:22:24.346631 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 23:22:21.918532 => 23:22:24.346355
[0m23:22:24.350855 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m23:22:24.408744 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m23:22:24.414309 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 23:22:21.957953 => 23:22:24.414160
[0m23:22:24.419132 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m23:22:24.561684 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72cbbad0>]}
[0m23:22:24.565560 [info ] [Thread-3  ]: 3 of 12 OK created sql table model DBT_POC.stg_ipflow_success_data ............. [[32mSUCCESS 1[0m in 2.76s]
[0m23:22:24.568782 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m23:22:24.574566 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m23:22:24.574898 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m23:22:24.577375 [info ] [Thread-4  ]: 4 of 12 START sql table model DBT_POC.src_ipflow_merge_domain_observations ..... [RUN]
[0m23:22:24.584327 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m23:22:24.580459 [info ] [Thread-3  ]: 5 of 12 START sql table model DBT_POC.src_ipflow_merge_success_output .......... [RUN]
[0m23:22:24.586767 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m23:22:24.593432 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.src_ipflow_merge_success_output)
[0m23:22:24.606687 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m23:22:24.613191 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m23:22:24.600550 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m23:22:24.659818 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 23:22:24.610632 => 23:22:24.659579
[0m23:22:24.663273 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 23:22:24.596600 => 23:22:24.662968
[0m23:22:24.665802 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m23:22:24.669087 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m23:22:24.674087 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m23:22:24.678932 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m23:22:24.680750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b83950>]}
[0m23:22:24.681726 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m23:22:24.695084 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m23:22:24.698743 [info ] [Thread-1  ]: 1 of 12 OK created sql table model DBT_POC.src_ipflow_merge_output ............. [[32mSUCCESS 1[0m in 2.87s]
[0m23:22:24.702091 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m23:22:24.704812 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m23:22:24.715326 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m23:22:24.717750 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:22:24.722113 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:22:24.725259 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m23:22:24.739521 [info ] [Thread-1  ]: 6 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_output ............ [RUN]
[0m23:22:24.742789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.stg_ipflow_merge_output)
[0m23:22:24.746727 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m23:22:24.756217 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:24.759215 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 23:22:24.752157 => 23:22:24.758943
[0m23:22:24.761544 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m23:22:24.791170 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:24.794849 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m23:22:24.797874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:22:25.272254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:25.305454 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:25.311540 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m23:22:25.418746 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:22:25.435273 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:25.444596 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m23:22:25.485802 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:22:25.492455 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 23:22:24.676576 => 23:22:25.492266
[0m23:22:25.500925 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m23:22:25.566916 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:22:25.576796 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:25.579605 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m23:22:25.685254 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:22:25.711441 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:25.715437 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:25.727352 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m23:22:25.770299 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71328ed0>]}
[0m23:22:25.773833 [info ] [Thread-4  ]: 4 of 12 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 1.19s]
[0m23:22:25.776860 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m23:22:25.790364 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m23:22:25.793391 [info ] [Thread-4  ]: 7 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m23:22:25.796508 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m23:22:25.804217 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m23:22:25.819821 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:25.823627 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 23:22:25.815216 => 23:22:25.823425
[0m23:22:25.826692 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m23:22:25.833759 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:25.836564 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m23:22:25.844159 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:22:25.855883 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:25.858766 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:25.861336 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m23:22:26.080856 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:22:26.092584 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 23:22:24.671581 => 23:22:26.092383
[0m23:22:26.098281 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m23:22:26.314612 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c951d0>]}
[0m23:22:26.326423 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:22:26.327644 [info ] [Thread-3  ]: 5 of 12 OK created sql table model DBT_POC.src_ipflow_merge_success_output ..... [[32mSUCCESS 1[0m in 1.72s]
[0m23:22:26.339721 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:26.340896 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:26.347009 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m23:22:26.352218 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m23:22:26.359955 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:26.364171 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m23:22:26.415627 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m23:22:26.418663 [info ] [Thread-3  ]: 8 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_success_output .... [RUN]
[0m23:22:26.426314 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m23:22:26.428841 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m23:22:26.443909 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:26.446611 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 23:22:26.440931 => 23:22:26.446453
[0m23:22:26.449843 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m23:22:26.455219 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:26.457647 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m23:22:26.468823 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:22:26.520062 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:22:26.525427 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:26.534077 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m23:22:26.586442 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:26.620478 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m23:22:26.631452 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m23:22:26.640624 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:22:26.646589 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:26.649621 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m23:22:26.768148 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:26.774388 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 23:22:24.763668 => 23:22:26.774236
[0m23:22:26.777017 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m23:22:26.822319 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:22:26.829520 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:26.833613 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:26.836294 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m23:22:26.940484 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:26.943866 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:26.948374 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m23:22:26.995553 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:22:27.000592 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:27.002648 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m23:22:27.009394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c54fd0>]}
[0m23:22:27.012238 [info ] [Thread-1  ]: 6 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ....... [[32mSUCCESS 0[0m in 2.27s]
[0m23:22:27.014703 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m23:22:27.103031 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:22:27.109755 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:27.112742 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m23:22:27.225399 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:22:27.241882 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:27.245246 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m23:22:27.353255 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:22:27.359210 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:27.368606 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:27.371306 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m23:22:27.497161 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:27.500309 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:27.508049 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m23:22:27.786946 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m23:22:27.791529 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:27.796245 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m23:22:27.962092 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:27.968768 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m23:22:27.971703 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m23:22:28.017162 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m23:22:28.020434 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:28.023488 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m23:22:28.126174 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:28.133342 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 23:22:25.829581 => 23:22:28.132880
[0m23:22:28.136690 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m23:22:28.244181 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:28.252108 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m23:22:28.255148 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m23:22:28.351561 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72bbbcd0>]}
[0m23:22:28.367295 [info ] [Thread-4  ]: 7 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 2.56s]
[0m23:22:28.372378 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m23:22:28.376607 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m23:22:28.380247 [info ] [Thread-1  ]: 9 of 12 START sql table model DBT_POC.fact_ip_to_company_domain ................ [RUN]
[0m23:22:28.391346 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:28.393715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m23:22:28.397668 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 23:22:26.452278 => 23:22:28.397546
[0m23:22:28.399564 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m23:22:28.401839 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m23:22:28.407710 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m23:22:28.414813 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 23:22:28.403843 => 23:22:28.414619
[0m23:22:28.417656 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m23:22:28.423029 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m23:22:28.426682 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m23:22:28.428820 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m23:22:28.431857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:22:28.651933 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c0af50>]}
[0m23:22:28.658309 [info ] [Thread-3  ]: 8 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 2.23s]
[0m23:22:28.662747 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m23:22:28.667320 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m23:22:28.671083 [info ] [Thread-4  ]: 10 of 12 START sql table model DBT_POC.src_ipflow_normalized_location .......... [RUN]
[0m23:22:28.675229 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m23:22:28.679660 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m23:22:28.728142 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m23:22:28.731450 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 23:22:28.725854 => 23:22:28.731096
[0m23:22:28.735458 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m23:22:28.740021 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m23:22:28.743523 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m23:22:28.745514 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m23:22:28.748163 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:22:29.382794 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:22:29.421837 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 23:22:28.420462 => 23:22:29.421574
[0m23:22:29.426826 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m23:22:29.634345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72bd43d0>]}
[0m23:22:29.641803 [info ] [Thread-1  ]: 9 of 12 OK created sql table model DBT_POC.fact_ip_to_company_domain ........... [[32mSUCCESS 1[0m in 1.24s]
[0m23:22:29.646510 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m23:22:29.715372 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:22:29.720519 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 23:22:28.737784 => 23:22:29.720402
[0m23:22:29.723452 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m23:22:29.914410 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72be72d0>]}
[0m23:22:29.918359 [info ] [Thread-4  ]: 10 of 12 OK created sql table model DBT_POC.src_ipflow_normalized_location ..... [[32mSUCCESS 1[0m in 1.24s]
[0m23:22:29.922451 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m23:22:29.925647 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m23:22:29.929903 [info ] [Thread-3  ]: 11 of 12 START sql table model DBT_POC.src_ipflow_ip_to_location ............... [RUN]
[0m23:22:29.932714 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m23:22:29.936479 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m23:22:29.941362 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m23:22:29.990737 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 23:22:29.938663 => 23:22:29.990502
[0m23:22:29.994222 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m23:22:29.999459 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m23:22:30.003169 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m23:22:30.005547 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m23:22:30.008264 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m23:22:31.337689 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:22:31.361554 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 23:22:29.997185 => 23:22:31.360683
[0m23:22:31.368093 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m23:22:31.600854 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ba9650>]}
[0m23:22:31.615807 [info ] [Thread-3  ]: 11 of 12 OK created sql table model DBT_POC.src_ipflow_ip_to_location .......... [[32mSUCCESS 1[0m in 1.67s]
[0m23:22:31.622572 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m23:22:31.642431 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m23:22:31.646743 [info ] [Thread-4  ]: 12 of 12 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [RUN]
[0m23:22:31.652429 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m23:22:31.656822 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m23:22:31.669333 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:31.672968 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 23:22:31.664776 => 23:22:31.672630
[0m23:22:31.675476 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m23:22:31.682080 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:31.685738 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m23:22:31.690746 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m23:22:32.727828 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:22:32.762951 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:32.782402 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m23:22:32.993563 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:22:33.021675 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:33.032072 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m23:22:33.224324 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:22:33.232436 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:33.237848 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m23:22:33.349343 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:22:33.356906 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:33.360708 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:33.366433 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m23:22:33.498126 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:33.501572 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:33.551393 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m23:22:34.092619 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m23:22:34.101958 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:34.105949 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m23:22:34.297466 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:34.307176 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m23:22:34.324614 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m23:22:34.440834 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:22:34.449596 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 23:22:31.677778 => 23:22:34.449112
[0m23:22:34.453804 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m23:22:34.677583 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712c4e10>]}
[0m23:22:34.691874 [info ] [Thread-4  ]: 12 of 12 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 0[0m in 3.02s]
[0m23:22:34.709888 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m23:23:30.226940 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 68.0 seconds
[0m23:23:30.291933 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 23:22:21.963300 => 23:23:30.291377
[0m23:23:30.295627 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m23:23:30.563625 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d71e9cc-4c7c-4dac-ba93-8e4cb2491932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72cd7090>]}
[0m23:23:30.572142 [info ] [Thread-2  ]: 2 of 12 OK created sql table model DBT_POC.stg_ipflow_input_data ............... [[32mSUCCESS 1[0m in 68.68s]
[0m23:23:30.579449 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m23:23:30.646967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:30.651043 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m23:23:30.654373 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m23:23:30.657520 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m23:23:30.660762 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m23:23:30.674969 [info ] [MainThread]: 
[0m23:23:30.678273 [info ] [MainThread]: Finished running 8 table models, 4 incremental models in 0 hours 1 minutes and 10.94 seconds (70.94s).
[0m23:23:30.682589 [debug] [MainThread]: Command end result
[0m23:23:30.712645 [info ] [MainThread]: 
[0m23:23:30.716941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:30.728241 [info ] [MainThread]: 
[0m23:23:30.732084 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m23:23:30.736210 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:30.736017 after 72.54 seconds
[0m23:23:30.740487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dcb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dcbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dcbc10>]}
[0m23:23:30.746014 [debug] [MainThread]: Flushing usage events
[0m19:46:12.535809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1110580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0a2fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0a2ff40>]}


============================== 19:46:12.542059 | 3b161040-b0a5-44df-87e9-63bc05b93784 ==============================
[0m19:46:12.542059 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:46:12.542932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:46:12.930273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b161040-b0a5-44df-87e9-63bc05b93784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0a2f640>]}
[0m19:46:12.942110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b161040-b0a5-44df-87e9-63bc05b93784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0d2da90>]}
[0m19:46:12.962863 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:46:12.995671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:12.996061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:13.002694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b161040-b0a5-44df-87e9-63bc05b93784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0e0af70>]}
[0m19:46:13.009039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b161040-b0a5-44df-87e9-63bc05b93784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc0e4eeb0>]}
[0m19:46:13.009456 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:46:13.009803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b161040-b0a5-44df-87e9-63bc05b93784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc0edd070>]}
[0m19:46:13.011176 [info ] [MainThread]: 
[0m19:46:13.011570 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:46:13.012053 [debug] [MainThread]: Command end result
[0m19:46:13.017466 [debug] [MainThread]: Command `dbt test` succeeded at 19:46:13.016970 after 0.54 seconds
[0m19:46:13.017913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1110580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc0edd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0d2ddf0>]}
[0m19:46:13.018234 [debug] [MainThread]: Flushing usage events
[0m19:52:02.607243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2603b3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd260737d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd260737f40>]}


============================== 19:52:02.613928 | 799adcdc-f3e3-4538-83bb-b6068a5d02fc ==============================
[0m19:52:02.613928 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:52:02.615393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:52:03.000544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '799adcdc-f3e3-4538-83bb-b6068a5d02fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd260737610>]}
[0m19:52:03.014692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '799adcdc-f3e3-4538-83bb-b6068a5d02fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25037da90>]}
[0m19:52:03.042074 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:52:03.079806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:03.080222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:03.087615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '799adcdc-f3e3-4538-83bb-b6068a5d02fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd260c41f70>]}
[0m19:52:03.094875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '799adcdc-f3e3-4538-83bb-b6068a5d02fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd281793ee0>]}
[0m19:52:03.095466 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:52:03.095984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '799adcdc-f3e3-4538-83bb-b6068a5d02fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd260c0d070>]}
[0m19:52:03.097809 [info ] [MainThread]: 
[0m19:52:03.098269 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:52:03.098791 [debug] [MainThread]: Command end result
[0m19:52:03.104894 [debug] [MainThread]: Command `dbt test` succeeded at 19:52:03.104364 after 0.54 seconds
[0m19:52:03.105430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2603b3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd260c0d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25037ddf0>]}
[0m19:52:03.105800 [debug] [MainThread]: Flushing usage events
[0m19:55:06.790400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d91e8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d9787dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d9787f70>]}


============================== 19:55:06.794356 | 6d643b7b-ac8e-4681-a389-4ef02894f12b ==============================
[0m19:55:06.794356 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:55:06.794874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:55:07.092995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d643b7b-ac8e-4681-a389-4ef02894f12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d9787670>]}
[0m19:55:07.104216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d643b7b-ac8e-4681-a389-4ef02894f12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d9c2dac0>]}
[0m19:55:07.124386 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:55:07.152081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:07.152426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:07.158180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d643b7b-ac8e-4681-a389-4ef02894f12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e8b69fa0>]}
[0m19:55:07.164143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d643b7b-ac8e-4681-a389-4ef02894f12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e8aa3fa0>]}
[0m19:55:07.164511 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:55:07.164835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d643b7b-ac8e-4681-a389-4ef02894f12b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e8b360a0>]}
[0m19:55:07.166121 [info ] [MainThread]: 
[0m19:55:07.166495 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:55:07.167047 [debug] [MainThread]: Command end result
[0m19:55:07.172709 [debug] [MainThread]: Command `dbt test` succeeded at 19:55:07.172269 after 0.42 seconds
[0m19:55:07.173138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d91e8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e8b360a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87d9bc8a00>]}
[0m19:55:07.173438 [debug] [MainThread]: Flushing usage events
[0m00:00:13.203570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85948a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85948f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85948e50>]}


============================== 00:00:13.210652 | d86146fb-183f-4280-a72a-9872d54fda58 ==============================
[0m00:00:13.210652 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:13.213762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:13.694891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858e6f10>]}
[0m00:00:13.707136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85948cd0>]}
[0m00:00:13.721788 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:00:13.943624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:13.946351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:13.953650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74098390>]}
[0m00:00:13.963044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7405df90>]}
[0m00:00:13.965867 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:13.968803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7405d0d0>]}
[0m00:00:13.972476 [info ] [MainThread]: 
[0m00:00:13.976263 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:14.024622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:14.036795 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:14.039790 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:14.042629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:14.834014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:00:14.840016 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:00:15.057082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:00:15.121253 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:00:15.124763 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:00:15.127486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:15.894326 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m00:00:15.913160 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:00:16.165878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c3fa410>]}
[0m00:00:16.170653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:16.174413 [info ] [MainThread]: 
[0m00:00:16.182271 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:00:16.182628 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:16.183155 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:00:16.186363 [info ] [Thread-1  ]: 1 of 12 START sql table model DBT_POC.src_ipflow_merge_output .................. [RUN]
[0m00:00:16.189329 [info ] [Thread-2  ]: 2 of 12 START sql table model DBT_POC.stg_ipflow_input_data .................... [RUN]
[0m00:00:16.245805 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_input_data'
[0m00:00:16.241790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m00:00:16.237666 [info ] [Thread-3  ]: 3 of 12 START sql table model DBT_POC.stg_ipflow_success_data .................. [RUN]
[0m00:00:16.249146 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:16.260657 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:00:16.263281 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m00:00:16.282902 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:00:16.280542 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:00:16.267957 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:16.301869 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:00:16.265489 => 00:00:16.301725
[0m00:00:16.295489 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:00:16.301131 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 00:00:16.278284 => 00:00:16.300818
[0m00:00:16.304038 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:16.307533 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 00:00:16.293094 => 00:00:16.307310
[0m00:00:16.313929 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:00:16.356677 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:00:16.351974 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:16.337894 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:00:16.361393 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:00:16.363634 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:16.367741 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:00:16.370066 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m00:00:16.380295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:16.378396 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:00:16.372557 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 3700
        );
[0m00:00:16.393360 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:00:16.386643 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m00:00:16.399985 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:00:18.586672 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:00:18.613036 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 00:00:16.353662 => 00:00:18.612761
[0m00:00:18.616558 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m00:00:18.614669 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:00:18.625649 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 00:00:16.364991 => 00:00:18.625503
[0m00:00:18.628441 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m00:00:18.839289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c264890>]}
[0m00:00:18.843413 [info ] [Thread-1  ]: 1 of 12 OK created sql table model DBT_POC.src_ipflow_merge_output ............. [[32mSUCCESS 1[0m in 2.60s]
[0m00:00:18.851760 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:00:18.864708 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:00:18.866692 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c33c210>]}
[0m00:00:18.868358 [info ] [Thread-4  ]: 4 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_output ............ [RUN]
[0m00:00:18.875023 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_merge_output'
[0m00:00:18.871996 [info ] [Thread-3  ]: 3 of 12 OK created sql table model DBT_POC.stg_ipflow_success_data ............. [[32mSUCCESS 1[0m in 2.60s]
[0m00:00:18.924683 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:00:18.944723 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:18.932400 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:00:18.948429 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 00:00:18.935407 => 00:00:18.948052
[0m00:00:18.952095 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:00:18.956789 [info ] [Thread-1  ]: 5 of 12 START sql table model DBT_POC.src_ipflow_merge_domain_observations ..... [RUN]
[0m00:00:18.954604 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:00:18.952617 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:00:18.970160 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.src_ipflow_merge_domain_observations)
[0m00:00:18.990828 [info ] [Thread-3  ]: 6 of 12 START sql table model DBT_POC.src_ipflow_merge_success_output .......... [RUN]
[0m00:00:19.015717 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.src_ipflow_merge_success_output)
[0m00:00:19.012651 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:00:19.009553 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:19.017868 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:00:19.023337 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:00:19.028677 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:00:19.040809 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:00:19.044645 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 00:00:19.019952 => 00:00:19.044409
[0m00:00:19.056791 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:00:19.067777 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:00:19.046687 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:00:19.049394 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 00:00:19.037759 => 00:00:19.049011
[0m00:00:19.072004 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:00:19.079976 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:00:19.090792 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m00:00:19.102875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:19.099060 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:00:19.114384 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:00:19.118369 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m00:00:19.122081 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:00:19.796322 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:19.815682 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:19.825000 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m00:00:19.930535 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:00:19.948700 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:19.956672 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m00:00:19.979498 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:19.987071 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 00:00:19.095534 => 00:00:19.986851
[0m00:00:19.990500 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m00:00:20.074563 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:00:20.086434 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:20.095908 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m00:00:20.201947 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0aa550>]}
[0m00:00:20.208548 [info ] [Thread-3  ]: 6 of 12 OK created sql table model DBT_POC.src_ipflow_merge_success_output ..... [[32mSUCCESS 1[0m in 1.19s]
[0m00:00:20.206734 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:00:20.212433 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:00:20.288559 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:00:20.310053 [info ] [Thread-3  ]: 7 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_success_output .... [RUN]
[0m00:00:20.321033 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m00:00:20.327149 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:00:20.316440 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:20.350698 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:20.354481 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:20.343602 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:20.380741 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 00:00:20.333128 => 00:00:20.380109
[0m00:00:20.385165 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:20.385812 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:00:20.395413 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 00:00:19.061241 => 00:00:20.394979
[0m00:00:20.424747 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m00:00:20.421427 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:20.443880 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:00:20.447975 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:00:20.501359 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:20.520404 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:20.524896 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:00:20.679695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c265d50>]}
[0m00:00:20.687408 [info ] [Thread-1  ]: 5 of 12 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 1.71s]
[0m00:00:20.699041 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:00:20.715717 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:00:20.739150 [info ] [Thread-1  ]: 8 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m00:00:20.749732 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m00:00:20.754934 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:00:20.764308 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:20.781623 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 00:00:20.759612 => 00:00:20.781154
[0m00:00:20.788706 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:00:20.806496 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:20.818211 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:00:20.825674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:21.018034 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:21.025069 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:21.029092 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m00:00:21.160931 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:00:21.169481 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:21.181584 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m00:00:21.295925 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:00:21.307409 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:21.310149 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m00:00:21.360553 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:00:21.363611 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:21.366949 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m00:00:21.420529 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:00:21.426353 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:21.430530 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:21.432978 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:21.448135 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:21.454939 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:21.458718 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m00:00:21.570466 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:00:21.576599 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:21.579217 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:21.580099 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:21.580513 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m00:00:21.583675 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:21.644157 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:00:21.592970 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:00:21.652603 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m00:00:21.734851 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:00:21.742431 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:21.745405 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m00:00:21.790880 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:21.796142 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 00:00:18.972475 => 00:00:21.795984
[0m00:00:21.798971 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m00:00:21.844615 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:00:21.849863 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:21.853765 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:21.856136 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:22.053998 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c1e58d0>]}
[0m00:00:22.063233 [info ] [Thread-4  ]: 4 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ....... [[32mSUCCESS 0[0m in 3.18s]
[0m00:00:22.066203 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:00:22.069163 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:22.073440 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:22.075953 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m00:00:22.170975 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:00:22.179253 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:22.184033 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m00:00:22.446573 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:22.458810 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:00:22.461820 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m00:00:22.594457 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:22.599900 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 00:00:20.409107 => 00:00:22.599757
[0m00:00:22.603556 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m00:00:22.838776 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c144a10>]}
[0m00:00:22.885068 [info ] [Thread-3  ]: 7 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 2.52s]
[0m00:00:22.888320 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:00:22.891896 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:00:22.895075 [info ] [Thread-4  ]: 9 of 12 START sql table model DBT_POC.src_ipflow_normalized_location ........... [RUN]
[0m00:00:22.898673 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_output, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m00:00:22.901451 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:00:22.908316 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:00:22.919775 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 00:00:22.904183 => 00:00:22.919355
[0m00:00:22.924832 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:00:22.930695 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:00:22.934486 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:00:22.945338 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m00:00:22.950437 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:00:22.993782 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:00:23.004605 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:23.007337 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m00:00:23.182667 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:23.197937 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:00:23.201161 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m00:00:23.352403 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:23.357455 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 00:00:20.796197 => 00:00:23.357333
[0m00:00:23.360071 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m00:00:23.613535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c14ba50>]}
[0m00:00:23.619069 [info ] [Thread-1  ]: 8 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 2.87s]
[0m00:00:23.640575 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:00:23.644240 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:00:23.646959 [info ] [Thread-3  ]: 10 of 12 START sql table model DBT_POC.fact_ip_to_company_domain ............... [RUN]
[0m00:00:23.650024 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m00:00:23.654170 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:00:23.659511 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:00:23.662236 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 00:00:23.656707 => 00:00:23.662057
[0m00:00:23.665660 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:00:23.670252 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:00:23.720416 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:00:23.722856 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m00:00:23.725774 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:00:23.823944 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:23.837402 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 00:00:22.927712 => 00:00:23.837239
[0m00:00:23.840170 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m00:00:24.067034 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c108990>]}
[0m00:00:24.070967 [info ] [Thread-4  ]: 9 of 12 OK created sql table model DBT_POC.src_ipflow_normalized_location ...... [[32mSUCCESS 1[0m in 1.17s]
[0m00:00:24.083735 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:00:24.087011 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:00:24.089921 [info ] [Thread-1  ]: 11 of 12 START sql table model DBT_POC.src_ipflow_ip_to_location ............... [RUN]
[0m00:00:24.093082 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m00:00:24.095822 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:00:24.101286 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:00:24.103875 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 00:00:24.098582 => 00:00:24.103704
[0m00:00:24.106107 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:00:24.110681 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:00:24.113931 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:00:24.136678 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m00:00:24.145686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:25.186968 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:25.210637 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 00:00:24.108061 => 00:00:25.210219
[0m00:00:25.217857 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m00:00:25.457528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c081c90>]}
[0m00:00:25.468566 [info ] [Thread-1  ]: 11 of 12 OK created sql table model DBT_POC.src_ipflow_ip_to_location .......... [[32mSUCCESS 1[0m in 1.36s]
[0m00:00:25.494114 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:00:25.502135 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:00:25.505984 [info ] [Thread-4  ]: 12 of 12 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [RUN]
[0m00:00:25.510673 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m00:00:25.523403 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:00:25.530046 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:25.533193 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 00:00:25.525972 => 00:00:25.533031
[0m00:00:25.535723 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:00:25.549149 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:25.551702 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:00:25.554369 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:00:25.612367 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:00:25.622377 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 00:00:23.667853 => 00:00:25.622105
[0m00:00:25.627603 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m00:00:25.861448 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0f2090>]}
[0m00:00:25.866563 [info ] [Thread-3  ]: 10 of 12 OK created sql table model DBT_POC.fact_ip_to_company_domain .......... [[32mSUCCESS 1[0m in 2.21s]
[0m00:00:25.870196 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:00:26.304881 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:00:26.311482 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:26.315034 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m00:00:26.425667 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:00:26.434033 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:26.447829 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m00:00:26.543812 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:00:26.551925 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:26.554955 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m00:00:26.668022 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:00:26.673943 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:26.677916 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:26.680823 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m00:00:26.833638 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:26.836524 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:26.838894 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m00:00:27.777532 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:00:27.796179 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:27.804238 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m00:00:27.996191 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:28.003471 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:00:28.006478 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m00:00:28.177929 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:00:28.185028 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 00:00:25.545557 => 00:00:28.184841
[0m00:00:28.188295 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m00:00:28.484927 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c0fa8d0>]}
[0m00:00:28.494797 [info ] [Thread-4  ]: 12 of 12 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 0[0m in 2.97s]
[0m00:00:28.502233 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:25.023384 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 69.0 seconds
[0m00:01:25.038803 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:00:16.316759 => 00:01:25.038258
[0m00:01:25.043456 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:01:25.347117 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86146fb-183f-4280-a72a-9872d54fda58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74098490>]}
[0m00:01:25.360956 [info ] [Thread-2  ]: 2 of 12 OK created sql table model DBT_POC.stg_ipflow_input_data ............... [[32mSUCCESS 1[0m in 69.10s]
[0m00:01:25.372945 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:01:25.442664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:25.448499 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m00:01:25.454037 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:01:25.463408 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m00:01:25.467497 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m00:01:25.471857 [info ] [MainThread]: 
[0m00:01:25.475574 [info ] [MainThread]: Finished running 8 table models, 4 incremental models in 0 hours 1 minutes and 11.50 seconds (71.50s).
[0m00:01:25.523095 [debug] [MainThread]: Command end result
[0m00:01:25.537322 [info ] [MainThread]: 
[0m00:01:25.540219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:25.543024 [info ] [MainThread]: 
[0m00:01:25.546408 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m00:01:25.549854 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:25.549745 after 72.38 seconds
[0m00:01:25.552213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858e6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858e6c50>]}
[0m00:01:25.566812 [debug] [MainThread]: Flushing usage events
[0m20:02:33.187044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7582c0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd739500d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd739500f40>]}


============================== 20:02:33.191803 | 4bb395be-3342-4c29-8c05-9dc2216cf559 ==============================
[0m20:02:33.191803 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:02:33.192354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:02:33.528177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb395be-3342-4c29-8c05-9dc2216cf559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd739500640>]}
[0m20:02:33.540039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb395be-3342-4c29-8c05-9dc2216cf559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd739b2ca90>]}
[0m20:02:33.564970 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:02:33.599412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:33.599788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:33.605979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb395be-3342-4c29-8c05-9dc2216cf559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd748c61f70>]}
[0m20:02:33.612865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb395be-3342-4c29-8c05-9dc2216cf559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd739b6bee0>]}
[0m20:02:33.613302 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:02:33.613645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb395be-3342-4c29-8c05-9dc2216cf559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7682ad070>]}
[0m20:02:33.615003 [info ] [MainThread]: 
[0m20:02:33.615473 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:02:33.616057 [debug] [MainThread]: Command end result
[0m20:02:33.620745 [debug] [MainThread]: Command `dbt test` succeeded at 20:02:33.620350 after 0.47 seconds
[0m20:02:33.621121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7582c0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7682ad070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd739b2cd60>]}
[0m20:02:33.621402 [debug] [MainThread]: Flushing usage events
[0m20:06:06.654173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a909a0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab1059d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab1059ee0>]}


============================== 20:06:06.658377 | a32a7efa-5ca3-4c93-95a6-1d4d1ebec778 ==============================
[0m20:06:06.658377 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:06:06.658945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:06:06.980834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a32a7efa-5ca3-4c93-95a6-1d4d1ebec778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab1047af0>]}
[0m20:06:06.992932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a32a7efa-5ca3-4c93-95a6-1d4d1ebec778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab13bca30>]}
[0m20:06:07.017610 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:06:07.052261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:07.052648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:07.058965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a32a7efa-5ca3-4c93-95a6-1d4d1ebec778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab1401f10>]}
[0m20:06:07.065720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a32a7efa-5ca3-4c93-95a6-1d4d1ebec778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90683f10>]}
[0m20:06:07.066149 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:06:07.066493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a32a7efa-5ca3-4c93-95a6-1d4d1ebec778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90683ee0>]}
[0m20:06:07.068160 [info ] [MainThread]: 
[0m20:06:07.068562 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:06:07.069045 [debug] [MainThread]: Command end result
[0m20:06:07.074913 [debug] [MainThread]: Command `dbt test` succeeded at 20:06:07.074460 after 0.46 seconds
[0m20:06:07.075348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a909a0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab13bca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90683820>]}
[0m20:06:07.075683 [debug] [MainThread]: Flushing usage events
[0m20:07:43.408323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9738ee8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9739941d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9739941f10>]}


============================== 20:07:43.412724 | f27eb0e1-c88d-4a32-b2fd-6e330b66cbbd ==============================
[0m20:07:43.412724 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:07:43.413298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:07:43.736570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f27eb0e1-c88d-4a32-b2fd-6e330b66cbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97399416a0>]}
[0m20:07:43.748540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f27eb0e1-c88d-4a32-b2fd-6e330b66cbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f971899da60>]}
[0m20:07:43.770958 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:07:43.801224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:43.801631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:43.807700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27eb0e1-c88d-4a32-b2fd-6e330b66cbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9739a93f40>]}
[0m20:07:43.814254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f27eb0e1-c88d-4a32-b2fd-6e330b66cbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9738b47f40>]}
[0m20:07:43.814715 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:07:43.815066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27eb0e1-c88d-4a32-b2fd-6e330b66cbbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9738bd6070>]}
[0m20:07:43.816527 [info ] [MainThread]: 
[0m20:07:43.816928 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:07:43.817418 [debug] [MainThread]: Command end result
[0m20:07:43.825778 [debug] [MainThread]: Command `dbt test` succeeded at 20:07:43.823640 after 0.45 seconds
[0m20:07:43.826330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9738ee8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9738bd6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f971899df70>]}
[0m20:07:43.826670 [debug] [MainThread]: Flushing usage events
[0m20:08:21.293615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd970b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd9caad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd9caaf40>]}


============================== 20:08:21.298367 | 3f3f8f8b-09af-43f2-b62e-ce9d75dd8219 ==============================
[0m20:08:21.298367 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:08:21.298893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:08:21.643294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f3f8f8b-09af-43f2-b62e-ce9d75dd8219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd9caa6d0>]}
[0m20:08:21.655416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f3f8f8b-09af-43f2-b62e-ce9d75dd8219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba89d6a60>]}
[0m20:08:21.677907 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:08:21.708735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:08:21.709145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:08:21.715385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f3f8f8b-09af-43f2-b62e-ce9d75dd8219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd9322f40>]}
[0m20:08:21.721295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f3f8f8b-09af-43f2-b62e-ce9d75dd8219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb80a6f40>]}
[0m20:08:21.721695 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:08:21.722018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f3f8f8b-09af-43f2-b62e-ce9d75dd8219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb80a6fa0>]}
[0m20:08:21.723171 [info ] [MainThread]: 
[0m20:08:21.723512 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:08:21.723976 [debug] [MainThread]: Command end result
[0m20:08:21.730038 [debug] [MainThread]: Command `dbt test` succeeded at 20:08:21.729536 after 0.47 seconds
[0m20:08:21.730546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febd970b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba89d6a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb80a6af0>]}
[0m20:08:21.730874 [debug] [MainThread]: Flushing usage events
[0m20:08:38.977114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba8af8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb881bfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb881bffa0>]}


============================== 20:08:38.981571 | ef35cbed-96ed-497c-8804-a2111f93b9da ==============================
[0m20:08:38.981571 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:08:38.982125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'debug': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:08:39.298363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef35cbed-96ed-497c-8804-a2111f93b9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb881bf730>]}
[0m20:08:39.309592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef35cbed-96ed-497c-8804-a2111f93b9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba927cac0>]}
[0m20:08:39.332543 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:08:39.365454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:08:39.365861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:08:39.372867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef35cbed-96ed-497c-8804-a2111f93b9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb791ebfa0>]}
[0m20:08:39.380613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef35cbed-96ed-497c-8804-a2111f93b9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb88225fa0>]}
[0m20:08:39.381170 [info ] [MainThread]: Found 12 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:08:39.381540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef35cbed-96ed-497c-8804-a2111f93b9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb882b80a0>]}
[0m20:08:39.382899 [info ] [MainThread]: 
[0m20:08:39.383960 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:08:39.385270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m20:08:39.397185 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m20:08:39.397691 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m20:08:39.397963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:40.389575 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:08:40.394224 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m20:08:40.530576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m20:08:40.536934 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:08:40.537311 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:08:40.537546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:41.231794 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:08:41.236942 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:08:41.377482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef35cbed-96ed-497c-8804-a2111f93b9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb88225c70>]}
[0m20:08:41.379107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:08:41.379865 [info ] [MainThread]: 
[0m20:08:41.391065 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:08:41.392048 [info ] [Thread-1  ]: 1 of 1 START sql incremental model DBT_POC.stg_ipflow_merge_success_output ..... [RUN]
[0m20:08:41.393167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m20:08:41.393877 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:08:41.406341 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:41.407651 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 20:08:41.394272 => 20:08:41.407380
[0m20:08:41.408065 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:08:41.452744 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:41.453263 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m20:08:41.453668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:41.883837 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:41.895596 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:41.896164 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m20:08:42.003094 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:08:42.014475 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:42.015361 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m20:08:42.091690 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:08:42.109916 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:42.110872 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m20:08:42.175286 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:08:42.202659 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:42.204302 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:42.204622 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m20:08:42.327309 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:42.328724 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:42.329595 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m20:08:44.182490 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2.0 seconds
[0m20:08:44.183025 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:44.183304 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m20:08:44.349789 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:44.355701 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:08:44.356038 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m20:08:44.460220 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:08:44.476902 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 20:08:41.408333 => 20:08:44.476722
[0m20:08:44.477334 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m20:08:44.607798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef35cbed-96ed-497c-8804-a2111f93b9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb85f2f10>]}
[0m20:08:44.608764 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 3.22s]
[0m20:08:44.609381 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:08:44.611417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:44.611683 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_success_output' was properly closed.
[0m20:08:44.611915 [info ] [MainThread]: 
[0m20:08:44.612341 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m20:08:44.613093 [debug] [MainThread]: Command end result
[0m20:08:44.617695 [info ] [MainThread]: 
[0m20:08:44.618058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:44.618340 [info ] [MainThread]: 
[0m20:08:44.618646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:08:44.619225 [debug] [MainThread]: Command `dbt run` succeeded at 20:08:44.619150 after 5.68 seconds
[0m20:08:44.619497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba8af8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb982b4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba921bd90>]}
[0m20:08:44.619760 [debug] [MainThread]: Flushing usage events
[0m20:10:10.297236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb140bd0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1410efdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1410eff70>]}


============================== 20:10:10.301713 | 90cc2644-e4ad-4d8a-bafd-d9a7490dfe94 ==============================
[0m20:10:10.301713 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:10:10.302361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:10:10.607980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90cc2644-e4ad-4d8a-bafd-d9a7490dfe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1410ef700>]}
[0m20:10:10.620009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90cc2644-e4ad-4d8a-bafd-d9a7490dfe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1212ccac0>]}
[0m20:10:10.641362 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:10:10.671719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:10:10.672285 [debug] [MainThread]: Partial parsing: added file: dbt_dsg_app://models/schema.yml
[0m20:10:10.714843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90cc2644-e4ad-4d8a-bafd-d9a7490dfe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150ea00d0>]}
[0m20:10:10.721509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90cc2644-e4ad-4d8a-bafd-d9a7490dfe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150d77f10>]}
[0m20:10:10.722088 [info ] [MainThread]: Found 12 models, 1 test, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:10:10.722475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90cc2644-e4ad-4d8a-bafd-d9a7490dfe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb121307f40>]}
[0m20:10:10.724083 [info ] [MainThread]: 
[0m20:10:10.724933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:10.727352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m20:10:10.740939 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:10:10.741361 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:10:10.741603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:11.517094 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:10:11.519396 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:10:11.648129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90cc2644-e4ad-4d8a-bafd-d9a7490dfe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb150e07700>]}
[0m20:10:11.648931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:11.649265 [info ] [MainThread]: 
[0m20:10:11.655721 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:10:11.656660 [info ] [Thread-1  ]: 1 of 1 START test unique_stg_ipflow_merge_success_output_user_ip ............... [RUN]
[0m20:10:11.657516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77)
[0m20:10:11.657871 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:10:11.666309 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:10:11.667469 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (compile): 20:10:11.658082 => 20:10:11.667193
[0m20:10:11.667836 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:10:11.687488 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:10:11.688862 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:10:11.689338 [debug] [Thread-1  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_ip as unique_field,
    count(*) as n_records

from DEV_QA.DBT_POC.stg_ipflow_merge_success_output
where user_ip is not null
group by user_ip
having count(*) > 1



      
    ) dbt_internal_test
[0m20:10:11.689661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:12.547671 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:10:12.564445 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (execute): 20:10:11.668036 => 20:10:12.564210
[0m20:10:12.564823 [debug] [Thread-1  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: Close
[0m20:10:12.679556 [info ] [Thread-1  ]: 1 of 1 PASS unique_stg_ipflow_merge_success_output_user_ip ..................... [[32mPASS[0m in 1.02s]
[0m20:10:12.680318 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:10:12.683655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:12.684038 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77' was properly closed.
[0m20:10:12.684299 [info ] [MainThread]: 
[0m20:10:12.684638 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m20:10:12.685320 [debug] [MainThread]: Command end result
[0m20:10:12.691454 [info ] [MainThread]: 
[0m20:10:12.692049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:10:12.692605 [info ] [MainThread]: 
[0m20:10:12.692969 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:10:12.693628 [debug] [MainThread]: Command `dbt test` succeeded at 20:10:12.693530 after 2.43 seconds
[0m20:10:12.693986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb140bd0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb121307fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1410eff70>]}
[0m20:10:12.694299 [debug] [MainThread]: Flushing usage events
[0m20:12:09.237492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f8bf0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e8f0fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e8f57070>]}


============================== 20:12:09.241663 | 24d19f0a-d23c-4e22-b6f4-d9cc8aa82545 ==============================
[0m20:12:09.241663 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:12:09.242308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:12:09.542713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24d19f0a-d23c-4e22-b6f4-d9cc8aa82545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e8f0f1c0>]}
[0m20:12:09.554287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24d19f0a-d23c-4e22-b6f4-d9cc8aa82545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc408b74b80>]}
[0m20:12:09.572923 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:12:09.600978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:09.601593 [debug] [MainThread]: Partial parsing: updated file: dbt_dsg_app://models/schema.yml
[0m20:12:09.620909 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m20:12:09.635036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m20:12:09.666930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24d19f0a-d23c-4e22-b6f4-d9cc8aa82545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e97dee80>]}
[0m20:12:09.668524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24d19f0a-d23c-4e22-b6f4-d9cc8aa82545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e96b6c70>]}
[0m20:12:09.668851 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:12:09.669172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d19f0a-d23c-4e22-b6f4-d9cc8aa82545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e96b6cd0>]}
[0m20:12:09.670772 [info ] [MainThread]: 
[0m20:12:09.671483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:09.672633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m20:12:09.683280 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:12:09.683724 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:12:09.683971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:10.486428 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:12:10.491533 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:12:10.698629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d19f0a-d23c-4e22-b6f4-d9cc8aa82545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9753850>]}
[0m20:12:10.700489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:10.701573 [info ] [MainThread]: 
[0m20:12:10.710196 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m20:12:10.711021 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m20:12:10.712055 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m20:12:10.713656 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:12:10.714604 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_input_data'
[0m20:12:10.715124 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m20:12:10.716065 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m20:12:10.716554 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m20:12:10.720168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m20:12:10.720737 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:12:10.723960 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m20:12:10.727054 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m20:12:10.727968 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 20:12:10.716973 => 20:12:10.727696
[0m20:12:10.728600 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m20:12:10.729178 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 20:12:10.724449 => 20:12:10.728948
[0m20:12:10.729654 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 20:12:10.729421 => 20:12:10.729465
[0m20:12:10.730038 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 20:12:10.721063 => 20:12:10.729858
[0m20:12:10.730469 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:12:10.731704 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m20:12:10.732154 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m20:12:10.732642 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 20:12:10.732415 => 20:12:10.732422
[0m20:12:10.733373 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m20:12:10.733911 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 20:12:10.733699 => 20:12:10.733708
[0m20:12:10.734828 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:12:10.735480 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_merge_output'
[0m20:12:10.736363 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m20:12:10.736950 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:12:10.737238 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m20:12:10.737556 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:12:10.738198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.src_ipflow_merge_domain_observations)
[0m20:12:10.743675 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m20:12:10.744289 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.src_ipflow_merge_success_output)
[0m20:12:10.744823 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:12:10.745309 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:12:10.745973 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 20:12:10.738453 => 20:12:10.745754
[0m20:12:10.748928 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m20:12:10.751474 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m20:12:10.751833 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m20:12:10.752605 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 20:12:10.752332 => 20:12:10.752349
[0m20:12:10.753553 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m20:12:10.753917 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 20:12:10.746213 => 20:12:10.753729
[0m20:12:10.754297 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 20:12:10.749244 => 20:12:10.754120
[0m20:12:10.754681 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:12:10.754973 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:12:10.755340 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 20:12:10.755178 => 20:12:10.755184
[0m20:12:10.755732 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 20:12:10.755572 => 20:12:10.755577
[0m20:12:10.756398 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:12:10.757079 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:12:10.757552 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:12:10.757953 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:12:10.758381 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_input_data, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m20:12:10.758853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m20:12:10.759141 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:12:10.759416 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:12:10.763288 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:12:10.766972 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:12:10.767863 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 20:12:10.759617 => 20:12:10.767662
[0m20:12:10.768199 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:12:10.768963 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 20:12:10.768658 => 20:12:10.768678
[0m20:12:10.769494 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 20:12:10.763793 => 20:12:10.769258
[0m20:12:10.770569 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:12:10.771025 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:12:10.771716 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 20:12:10.771523 => 20:12:10.771530
[0m20:12:10.772806 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:12:10.773144 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:12:10.773769 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:12:10.774130 [debug] [Thread-4  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:12:10.774401 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:12:10.774968 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m20:12:10.775564 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m20:12:10.776157 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_output, now test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149)
[0m20:12:10.776822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77)
[0m20:12:10.777175 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:12:10.777693 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:12:10.778095 [debug] [Thread-4  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:12:10.778523 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:12:10.782246 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:12:10.785153 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m20:12:10.795710 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m20:12:10.800732 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:12:10.801706 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 20:12:10.782667 => 20:12:10.801448
[0m20:12:10.802175 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 20:12:10.778790 => 20:12:10.802022
[0m20:12:10.802630 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:12:10.803072 [debug] [Thread-4  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (compile): 20:12:10.785731 => 20:12:10.802827
[0m20:12:10.803632 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (compile): 20:12:10.796122 => 20:12:10.803408
[0m20:12:10.803917 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:12:10.804277 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 20:12:10.804130 => 20:12:10.804139
[0m20:12:10.804559 [debug] [Thread-4  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:12:10.804908 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:12:10.805337 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 20:12:10.805173 => 20:12:10.805180
[0m20:12:10.806181 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:12:10.806620 [debug] [Thread-4  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (execute): 20:12:10.806432 => 20:12:10.806440
[0m20:12:10.806979 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (execute): 20:12:10.806833 => 20:12:10.806837
[0m20:12:10.807642 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:12:10.808098 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:12:10.808676 [debug] [Thread-4  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:12:10.809253 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:12:10.809758 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m20:12:10.810428 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:12:10.813052 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m20:12:10.813852 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 20:12:10.810676 => 20:12:10.813621
[0m20:12:10.814170 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:12:10.814532 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 20:12:10.814387 => 20:12:10.814395
[0m20:12:10.815228 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:12:10.815894 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:12:10.816486 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m20:12:10.816784 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:12:10.820109 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:12:10.821078 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 20:12:10.816996 => 20:12:10.820784
[0m20:12:10.821439 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:12:10.821785 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 20:12:10.821632 => 20:12:10.821640
[0m20:12:10.822484 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:12:10.824196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:10.824493 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77' was properly closed.
[0m20:12:10.824695 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m20:12:10.824895 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m20:12:10.825088 [debug] [MainThread]: Connection 'test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149' was properly closed.
[0m20:12:10.826890 [debug] [MainThread]: Command end result
[0m20:12:10.835189 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:12:10.835524 [info ] [MainThread]: Building catalog
[0m20:12:10.837421 [debug] [ThreadPool]: Acquiring new snowflake connection 'DEV_QA.information_schema'
[0m20:12:10.844871 [debug] [ThreadPool]: Using snowflake connection "DEV_QA.information_schema"
[0m20:12:10.845397 [debug] [ThreadPool]: On DEV_QA.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "DEV_QA.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from DEV_QA.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from DEV_QA.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_poc'))
      order by "column_index"
[0m20:12:10.845734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:13.355720 [debug] [ThreadPool]: SQL status: SUCCESS 52 in 3.0 seconds
[0m20:12:13.381001 [debug] [ThreadPool]: On DEV_QA.information_schema: Close
[0m20:12:13.521644 [info ] [MainThread]: Catalog written to /Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/target/catalog.json
[0m20:12:13.522873 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:12:13.522532 after 4.32 seconds
[0m20:12:13.523274 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:12:13.523497 [debug] [MainThread]: Connection 'DEV_QA.information_schema' was properly closed.
[0m20:12:13.523766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f8bf0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e8f0f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e96b6610>]}
[0m20:12:13.524072 [debug] [MainThread]: Flushing usage events
[0m20:13:01.436199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6393b0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc608757df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc608757fa0>]}


============================== 20:13:01.440946 | 46adb932-e9bb-4e3a-897e-3984b0c58434 ==============================
[0m20:13:01.440946 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:13:01.441486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:13:01.754513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46adb932-e9bb-4e3a-897e-3984b0c58434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc608757730>]}
[0m20:13:01.766399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46adb932-e9bb-4e3a-897e-3984b0c58434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc638fa9a90>]}
[0m20:13:02.128973 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m20:13:02.131839 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/lib/python3.9/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/Users/dayookubanjo/opt/anaconda3/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Users/dayookubanjo/opt/anaconda3/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m20:13:02.133478 [debug] [MainThread]: Command `dbt docs serve` failed at 20:13:02.132971 after 0.75 seconds
[0m20:13:02.134258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6393b0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc638fbc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc638fbc2b0>]}
[0m20:13:02.134953 [debug] [MainThread]: Flushing usage events
[0m20:17:47.268359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe940558b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9001e7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9001e7fd0>]}


============================== 20:17:47.273104 | 239ffa9a-2a5f-4d12-a8a6-1947f7309d8f ==============================
[0m20:17:47.273104 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:17:47.273649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:17:47.598007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '239ffa9a-2a5f-4d12-a8a6-1947f7309d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9001e7760>]}
[0m20:17:47.611219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '239ffa9a-2a5f-4d12-a8a6-1947f7309d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe930fa2ac0>]}
[0m20:32:45.935484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f08f68280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef822adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef822af70>]}


============================== 20:32:45.940928 | 3208a653-4e26-4d90-966c-61d398c4435a ==============================
[0m20:32:45.940928 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:32:45.941783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:32:46.225876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3208a653-4e26-4d90-966c-61d398c4435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef822a640>]}
[0m20:32:46.238497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3208a653-4e26-4d90-966c-61d398c4435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed8144a90>]}
[0m20:32:46.260383 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:32:46.299231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:32:46.299667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:32:46.306484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3208a653-4e26-4d90-966c-61d398c4435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb805ce80>]}
[0m20:32:46.314537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3208a653-4e26-4d90-966c-61d398c4435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec8bace80>]}
[0m20:32:46.315036 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:32:46.315398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3208a653-4e26-4d90-966c-61d398c4435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec8bacee0>]}
[0m20:32:46.316720 [info ] [MainThread]: 
[0m20:32:46.317466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:32:46.318460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m20:32:46.329955 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m20:32:46.330370 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m20:32:46.330638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:47.049144 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:32:47.052015 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m20:32:47.198624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m20:32:47.205604 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:32:47.205986 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:32:47.206211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:47.751341 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:32:47.752991 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:32:47.863596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3208a653-4e26-4d90-966c-61d398c4435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ec8baca90>]}
[0m20:32:47.864344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:32:47.864679 [info ] [MainThread]: 
[0m20:32:47.870246 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:32:47.870830 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m20:32:47.871472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m20:32:47.871778 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:32:47.874429 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:32:47.875473 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 20:32:47.871971 => 20:32:47.875297
[0m20:32:47.875747 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:32:47.904694 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:32:47.907589 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:32:47.908028 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m20:32:47.908331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:49.536293 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:32:49.564030 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 20:32:47.875917 => 20:32:49.563818
[0m20:32:49.564443 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m20:32:49.686070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208a653-4e26-4d90-966c-61d398c4435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee8f9bd90>]}
[0m20:32:49.687864 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 1.81s]
[0m20:32:49.689030 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:32:49.692526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:49.693148 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m20:32:49.693630 [info ] [MainThread]: 
[0m20:32:49.694327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m20:32:49.695741 [debug] [MainThread]: Command end result
[0m20:32:49.704400 [info ] [MainThread]: 
[0m20:32:49.704974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:32:49.705529 [info ] [MainThread]: 
[0m20:32:49.706047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:32:49.706952 [debug] [MainThread]: Command `dbt run` succeeded at 20:32:49.706837 after 3.83 seconds
[0m20:32:49.707343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f08f68280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed8144e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef822a640>]}
[0m20:32:49.707775 [debug] [MainThread]: Flushing usage events
[0m20:36:24.853512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe088868280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0993badc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0993baf70>]}


============================== 20:36:24.858490 | 6ac763c7-f2b0-42c2-81b6-1beda582fa17 ==============================
[0m20:36:24.858490 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:24.859059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:25.128866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ac763c7-f2b0-42c2-81b6-1beda582fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0993ba700>]}
[0m20:36:25.141314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ac763c7-f2b0-42c2-81b6-1beda582fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0884dca90>]}
[0m20:36:25.161713 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:25.190975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:25.191338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:25.197315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac763c7-f2b0-42c2-81b6-1beda582fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe099a7de80>]}
[0m20:36:25.203683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac763c7-f2b0-42c2-81b6-1beda582fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe099a4ce80>]}
[0m20:36:25.204079 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:25.204405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac763c7-f2b0-42c2-81b6-1beda582fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe099a4cee0>]}
[0m20:36:25.205861 [info ] [MainThread]: 
[0m20:36:25.206602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:25.207614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m20:36:25.218863 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m20:36:25.219302 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m20:36:25.219560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:25.953702 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:36:25.958347 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m20:36:26.097291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m20:36:26.110128 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:36:26.110689 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:36:26.111102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:26.430087 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m20:36:26.432368 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:36:26.547377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac763c7-f2b0-42c2-81b6-1beda582fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe099a4ca90>]}
[0m20:36:26.548707 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:36:26.549296 [info ] [MainThread]: 
[0m20:36:26.556786 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:36:26.557792 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m20:36:26.559294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m20:36:26.560260 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:36:26.565288 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:36:26.567788 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 20:36:26.560693 => 20:36:26.567345
[0m20:36:26.568316 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:36:26.601140 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:36:26.603615 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:36:26.604019 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m20:36:26.604364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:27.528165 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:36:27.562210 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 20:36:26.568598 => 20:36:27.561983
[0m20:36:27.562712 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m20:36:27.684804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac763c7-f2b0-42c2-81b6-1beda582fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe048087d90>]}
[0m20:36:27.686627 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 1.13s]
[0m20:36:27.687991 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:36:27.692020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:27.692688 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m20:36:27.693203 [info ] [MainThread]: 
[0m20:36:27.693864 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m20:36:27.695629 [debug] [MainThread]: Command end result
[0m20:36:27.705909 [info ] [MainThread]: 
[0m20:36:27.706625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:27.707166 [info ] [MainThread]: 
[0m20:36:27.707746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:27.708757 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:27.708585 after 2.89 seconds
[0m20:36:27.709271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe088868280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0884dcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0993ba700>]}
[0m20:36:27.709743 [debug] [MainThread]: Flushing usage events
[0m20:39:00.719035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe707e8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe504bfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe6189d040>]}


============================== 20:39:00.726190 | f1c125f1-d8f5-42d7-b856-7e05f5c202c5 ==============================
[0m20:39:00.726190 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:39:00.726727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:39:00.967055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c125f1-d8f5-42d7-b856-7e05f5c202c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe504bf640>]}
[0m20:39:00.978636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c125f1-d8f5-42d7-b856-7e05f5c202c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe62045b20>]}
[0m20:39:00.998434 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:39:01.027464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:01.027814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:01.033968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c125f1-d8f5-42d7-b856-7e05f5c202c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70714f10>]}
[0m20:39:01.041359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c125f1-d8f5-42d7-b856-7e05f5c202c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70e86e80>]}
[0m20:39:01.041781 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:39:01.042106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c125f1-d8f5-42d7-b856-7e05f5c202c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70e86ee0>]}
[0m20:39:01.043254 [info ] [MainThread]: 
[0m20:39:01.043888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:39:01.044938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m20:39:01.056451 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m20:39:01.056887 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m20:39:01.057128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:01.898402 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:39:01.900200 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m20:39:02.036936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m20:39:02.043074 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:39:02.043371 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:39:02.043603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:02.626263 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:39:02.628106 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:39:02.778553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c125f1-d8f5-42d7-b856-7e05f5c202c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70e86a60>]}
[0m20:39:02.779365 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:02.779729 [info ] [MainThread]: 
[0m20:39:02.784885 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:39:02.785890 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m20:39:02.786582 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m20:39:02.786911 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:39:02.789753 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:39:02.790981 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 20:39:02.787126 => 20:39:02.790774
[0m20:39:02.791301 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:39:02.822690 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:39:02.825143 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:39:02.825595 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m20:39:02.825950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:39:04.045381 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:39:04.062799 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 20:39:02.791495 => 20:39:04.062638
[0m20:39:04.063134 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m20:39:04.180791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c125f1-d8f5-42d7-b856-7e05f5c202c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe50586e20>]}
[0m20:39:04.181914 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 1.39s]
[0m20:39:04.182778 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:39:04.185360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:04.185825 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m20:39:04.186194 [info ] [MainThread]: 
[0m20:39:04.186681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m20:39:04.187479 [debug] [MainThread]: Command end result
[0m20:39:04.195228 [info ] [MainThread]: 
[0m20:39:04.195794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:04.196254 [info ] [MainThread]: 
[0m20:39:04.196745 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:39:04.197576 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:04.197457 after 3.51 seconds
[0m20:39:04.198250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe707e8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe401c35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe70f2c040>]}
[0m20:39:04.198683 [debug] [MainThread]: Flushing usage events
[0m20:40:20.234098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb300668280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32102adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32102af70>]}


============================== 20:40:20.239021 | b57440d9-02a7-4fdb-87c4-814f1682d251 ==============================
[0m20:40:20.239021 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:40:20.239694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:40:20.513220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32102a700>]}
[0m20:40:20.525246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30819da90>]}
[0m20:40:20.547592 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:40:20.578935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:40:20.579333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:40:20.585859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3004ece80>]}
[0m20:40:20.592997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb300412e80>]}
[0m20:40:20.593538 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:40:20.593901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb300412ee0>]}
[0m20:40:20.596417 [info ] [MainThread]: 
[0m20:40:20.597361 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:40:20.599051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m20:40:20.611293 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m20:40:20.611725 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m20:40:20.611994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:21.465959 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:40:21.468322 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m20:40:21.594992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m20:40:21.601398 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:40:21.601801 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:40:21.602024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:22.281879 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:40:22.283885 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:40:22.395861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb300412a90>]}
[0m20:40:22.396604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:22.396913 [info ] [MainThread]: 
[0m20:40:22.400718 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:40:22.401164 [info ] [Thread-1  ]: 1 of 9 START sql table model DBT_POC.stg_ipflow_success_data ................... [RUN]
[0m20:40:22.401738 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_success_data)
[0m20:40:22.402036 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:40:22.404166 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m20:40:22.405144 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 20:40:22.402220 => 20:40:22.404859
[0m20:40:22.405534 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:40:22.434660 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m20:40:22.436222 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m20:40:22.436577 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m20:40:22.436862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:23.313863 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:23.348384 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 20:40:22.405741 => 20:40:23.348158
[0m20:40:23.348850 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m20:40:23.474247 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30823fd30>]}
[0m20:40:23.476202 [info ] [Thread-1  ]: 1 of 9 OK created sql table model DBT_POC.stg_ipflow_success_data .............. [[32mSUCCESS 1[0m in 1.07s]
[0m20:40:23.477555 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m20:40:23.479500 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:40:23.480115 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:40:23.481580 [info ] [Thread-3  ]: 2 of 9 START sql table model DBT_POC.src_ipflow_merge_domain_observations ...... [RUN]
[0m20:40:23.482997 [info ] [Thread-4  ]: 3 of 9 START sql table model DBT_POC.src_ipflow_merge_success_output ........... [RUN]
[0m20:40:23.484394 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m20:40:23.485446 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m20:40:23.486115 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:40:23.486693 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:40:23.491225 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m20:40:23.496154 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m20:40:23.497409 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 20:40:23.487065 => 20:40:23.497051
[0m20:40:23.498011 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 20:40:23.491800 => 20:40:23.497735
[0m20:40:23.498481 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:40:23.498908 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:40:23.502589 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m20:40:23.505614 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m20:40:23.507663 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m20:40:23.508218 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m20:40:23.509353 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m20:40:23.509869 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:40:23.510295 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m20:40:23.511446 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:40:24.328982 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:24.331869 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 20:40:23.502897 => 20:40:24.331685
[0m20:40:24.332269 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m20:40:24.443089 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3110b1eb0>]}
[0m20:40:24.444282 [info ] [Thread-4  ]: 3 of 9 OK created sql table model DBT_POC.src_ipflow_merge_success_output ...... [[32mSUCCESS 1[0m in 0.96s]
[0m20:40:24.445227 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m20:40:24.446082 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:40:24.446782 [info ] [Thread-1  ]: 4 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_success_output ..... [RUN]
[0m20:40:24.448039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m20:40:24.448636 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:40:24.459640 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:24.461019 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 20:40:24.448936 => 20:40:24.460686
[0m20:40:24.461519 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:40:24.500155 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:24.500696 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m20:40:24.501025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:24.578954 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:24.581483 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 20:40:23.499196 => 20:40:24.581317
[0m20:40:24.581829 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m20:40:24.701413 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3110b1f10>]}
[0m20:40:24.702376 [info ] [Thread-3  ]: 2 of 9 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations . [[32mSUCCESS 1[0m in 1.22s]
[0m20:40:24.703141 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m20:40:24.704042 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:40:24.706724 [info ] [Thread-4  ]: 5 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m20:40:24.707709 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m20:40:24.708740 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:40:24.713514 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:24.715148 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 20:40:24.709200 => 20:40:24.714892
[0m20:40:24.715607 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:40:24.720462 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:24.720965 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m20:40:24.721345 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:40:24.932083 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:24.940625 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:24.941102 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m20:40:25.051580 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:40:25.054752 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:25.055110 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m20:40:25.143558 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:40:25.152475 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:25.152958 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m20:40:25.161494 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:25.164853 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:25.165222 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m20:40:25.233983 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:40:25.252376 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m20:40:25.258429 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:25.261374 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:25.261970 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m20:40:25.263890 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:25.264297 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m20:40:25.329991 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m20:40:25.333142 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:25.333482 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m20:40:25.363408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:25.363836 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:25.364135 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m20:40:25.408241 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m20:40:25.411774 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:25.413292 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:25.413597 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m20:40:25.523972 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:25.524651 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:25.524968 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m20:40:26.070540 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:40:26.071969 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:26.072891 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m20:40:26.225935 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m20:40:26.226936 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:26.227696 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:26.240326 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m20:40:26.240915 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m20:40:26.241427 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m20:40:26.349151 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:26.355565 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 20:40:24.461797 => 20:40:26.355117
[0m20:40:26.356258 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m20:40:26.406448 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:26.412698 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m20:40:26.413293 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m20:40:26.494036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb308229e20>]}
[0m20:40:26.495708 [info ] [Thread-1  ]: 4 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 2.05s]
[0m20:40:26.497146 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m20:40:26.498557 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:40:26.499442 [info ] [Thread-3  ]: 6 of 9 START sql table model DBT_POC.src_ipflow_normalized_location ............ [RUN]
[0m20:40:26.500842 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m20:40:26.501558 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:40:26.507261 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m20:40:26.508684 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 20:40:26.501996 => 20:40:26.508351
[0m20:40:26.509214 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:40:26.513485 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m20:40:26.516579 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m20:40:26.517614 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m20:40:26.518387 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:26.518833 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:40:26.521740 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 20:40:24.715997 => 20:40:26.521514
[0m20:40:26.523779 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m20:40:26.668708 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31110f5e0>]}
[0m20:40:26.669474 [info ] [Thread-4  ]: 5 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 1.96s]
[0m20:40:26.670138 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m20:40:26.670702 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:40:26.671095 [info ] [Thread-1  ]: 7 of 9 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m20:40:26.671899 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m20:40:26.672392 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:40:26.710009 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:40:26.710945 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 20:40:26.672622 => 20:40:26.710613
[0m20:40:26.711348 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:40:26.713822 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:40:26.715712 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m20:40:26.716030 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m20:40:26.716319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:27.586127 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:27.589220 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 20:40:26.509540 => 20:40:27.589025
[0m20:40:27.589583 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m20:40:27.649586 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:27.652539 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 20:40:26.711554 => 20:40:27.652333
[0m20:40:27.652941 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m20:40:27.706030 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb311129220>]}
[0m20:40:27.707013 [info ] [Thread-3  ]: 6 of 9 OK created sql table model DBT_POC.src_ipflow_normalized_location ....... [[32mSUCCESS 1[0m in 1.21s]
[0m20:40:27.708009 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m20:40:27.709064 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:40:27.709809 [info ] [Thread-4  ]: 8 of 9 START sql table model DBT_POC.src_ipflow_ip_to_location ................. [RUN]
[0m20:40:27.710795 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m20:40:27.711275 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:40:27.715494 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m20:40:27.716421 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 20:40:27.711558 => 20:40:27.716196
[0m20:40:27.716809 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:40:27.719910 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m20:40:27.721353 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m20:40:27.721758 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m20:40:27.722137 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:40:27.773495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30824ad00>]}
[0m20:40:27.774220 [info ] [Thread-1  ]: 7 of 9 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 1.10s]
[0m20:40:27.774824 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m20:40:28.838998 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:28.846493 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 20:40:27.717056 => 20:40:28.846157
[0m20:40:28.847174 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m20:40:28.967672 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3110a1790>]}
[0m20:40:28.969487 [info ] [Thread-4  ]: 8 of 9 OK created sql table model DBT_POC.src_ipflow_ip_to_location ............ [[32mSUCCESS 1[0m in 1.26s]
[0m20:40:28.971043 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m20:40:28.973183 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:40:28.974308 [info ] [Thread-3  ]: 9 of 9 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings .. [RUN]
[0m20:40:28.975543 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m20:40:28.976134 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:40:28.983274 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:28.984475 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 20:40:28.976497 => 20:40:28.984192
[0m20:40:28.984952 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:40:28.991246 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:28.991923 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m20:40:28.992408 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:40:29.556020 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:29.562515 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:29.563086 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m20:40:29.644996 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m20:40:29.652661 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:29.653398 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m20:40:29.750768 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m20:40:29.760729 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:29.761673 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m20:40:29.851291 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m20:40:29.858501 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:29.861790 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:29.862475 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m20:40:29.968616 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:29.970008 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:29.971049 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m20:40:30.374107 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:40:30.375716 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:30.376215 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m20:40:30.542413 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:30.553362 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m20:40:30.553816 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m20:40:30.663465 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:40:30.667384 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 20:40:28.985261 => 20:40:30.667193
[0m20:40:30.668014 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m20:40:30.808884 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57440d9-02a7-4fdb-87c4-814f1682d251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb310f5f190>]}
[0m20:40:30.809620 [info ] [Thread-3  ]: 9 of 9 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 0[0m in 1.83s]
[0m20:40:30.810183 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m20:40:30.812853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:30.813229 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m20:40:30.813456 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m20:40:30.813665 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m20:40:30.814014 [info ] [MainThread]: 
[0m20:40:30.814356 [info ] [MainThread]: Finished running 6 table models, 3 incremental models in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m20:40:30.816180 [debug] [MainThread]: Command end result
[0m20:40:30.822629 [info ] [MainThread]: 
[0m20:40:30.823144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:30.823454 [info ] [MainThread]: 
[0m20:40:30.823783 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:40:30.824848 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:30.824680 after 10.63 seconds
[0m20:40:30.825600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb300668280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb310fdbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30819dd90>]}
[0m20:40:30.826051 [debug] [MainThread]: Flushing usage events
[0m00:44:22.651676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa484d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa484df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa484dcd0>]}


============================== 00:44:22.659351 | 0a71cdf7-0460-4a27-8d61-c80c9d2563a5 ==============================
[0m00:44:22.659351 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:44:22.672459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:44:23.197358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47e7150>]}
[0m00:44:23.209587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa484d2d0>]}
[0m00:44:23.219347 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:44:23.410167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:44:23.413095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:44:23.420435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1aabd0>]}
[0m00:44:23.427332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c11e410>]}
[0m00:44:23.430221 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:44:23.433070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c11e5d0>]}
[0m00:44:23.436608 [info ] [MainThread]: 
[0m00:44:23.441285 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:44:23.444367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:44:23.459645 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:44:23.462684 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:44:23.465402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:24.266631 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:44:24.273829 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:44:24.514708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:44:24.581469 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:44:24.585980 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:44:24.589560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:25.126691 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m00:44:25.143300 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:44:25.394167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f49e10>]}
[0m00:44:25.398787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:44:25.402591 [info ] [MainThread]: 
[0m00:44:25.413932 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:44:25.414682 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:44:25.415557 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:44:25.418784 [info ] [Thread-1  ]: 1 of 12 START sql table model DBT_POC.src_ipflow_merge_output .................. [RUN]
[0m00:44:25.421912 [info ] [Thread-2  ]: 2 of 12 START sql table model DBT_POC.stg_ipflow_input_data .................... [RUN]
[0m00:44:25.424868 [info ] [Thread-3  ]: 3 of 12 START sql table model DBT_POC.stg_ipflow_success_data .................. [RUN]
[0m00:44:25.432220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m00:44:25.435815 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_input_data'
[0m00:44:25.439188 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m00:44:25.444430 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:44:25.447308 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:44:25.449922 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:44:25.454893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:44:25.458814 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:44:25.508872 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:44:25.512584 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 00:44:25.452669 => 00:44:25.512394
[0m00:44:25.515521 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:44:25.457134 => 00:44:25.515212
[0m00:44:25.517683 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 00:44:25.506849 => 00:44:25.517545
[0m00:44:25.520212 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:44:25.523356 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:44:25.525832 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:44:25.548885 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:44:25.551392 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:44:25.555484 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:44:25.559936 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:44:25.561594 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:44:25.563497 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:44:25.574369 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m00:44:25.576659 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 3700
        );
[0m00:44:25.579298 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m00:44:25.581974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:44:25.592844 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:44:25.595613 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:44:26.527043 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:26.572506 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 00:44:25.553707 => 00:44:26.572279
[0m00:44:26.575841 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m00:44:26.594377 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:26.599714 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 00:44:25.528341 => 00:44:26.599546
[0m00:44:26.602583 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m00:44:26.772643 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87146fd0>]}
[0m00:44:26.777902 [info ] [Thread-3  ]: 3 of 12 OK created sql table model DBT_POC.stg_ipflow_success_data ............. [[32mSUCCESS 1[0m in 1.33s]
[0m00:44:26.782293 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:44:26.838599 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:44:26.839166 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:44:26.840704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87143550>]}
[0m00:44:26.842836 [info ] [Thread-4  ]: 4 of 12 START sql table model DBT_POC.src_ipflow_merge_domain_observations ..... [RUN]
[0m00:44:26.845667 [info ] [Thread-3  ]: 5 of 12 START sql table model DBT_POC.src_ipflow_merge_success_output .......... [RUN]
[0m00:44:26.849557 [info ] [Thread-1  ]: 1 of 12 OK created sql table model DBT_POC.src_ipflow_merge_output ............. [[32mSUCCESS 1[0m in 1.41s]
[0m00:44:26.853488 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m00:44:26.873582 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:44:26.870458 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:44:26.857741 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.src_ipflow_merge_success_output)
[0m00:44:26.896504 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:44:26.885283 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:44:26.880143 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:44:26.902217 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:44:26.904728 [info ] [Thread-1  ]: 6 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_output ............ [RUN]
[0m00:44:26.912531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.stg_ipflow_merge_output)
[0m00:44:26.910398 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 00:44:26.899669 => 00:44:26.910207
[0m00:44:26.908201 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 00:44:26.876316 => 00:44:26.907930
[0m00:44:26.921898 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:44:26.924797 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:44:26.927616 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:44:26.937828 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:26.946748 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:44:26.951143 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:44:26.954511 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 00:44:26.930110 => 00:44:26.954290
[0m00:44:26.958244 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:44:26.961192 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:44:26.962692 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:44:26.965127 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m00:44:26.967444 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m00:44:26.990758 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:44:26.998962 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:27.002020 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:44:27.010806 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:44:27.017596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:44:27.600330 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:27.616726 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:27.620458 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m00:44:27.738143 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:44:27.746163 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:27.749493 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m00:44:27.838353 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:44:27.853852 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:27.854767 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:27.856624 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m00:44:27.861841 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 00:44:26.948832 => 00:44:27.861631
[0m00:44:27.866438 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:27.871309 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m00:44:27.876061 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 00:44:26.944272 => 00:44:27.875900
[0m00:44:27.880886 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m00:44:27.999063 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:44:28.030528 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:28.074529 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c089650>]}
[0m00:44:28.076213 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:28.077942 [info ] [Thread-4  ]: 4 of 12 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 1.22s]
[0m00:44:28.086225 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:44:28.082658 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:44:28.080165 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872362d0>]}
[0m00:44:28.099614 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:44:28.108271 [info ] [Thread-4  ]: 7 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m00:44:28.119728 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m00:44:28.122474 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:44:28.105652 [info ] [Thread-3  ]: 5 of 12 OK created sql table model DBT_POC.src_ipflow_merge_success_output ..... [[32mSUCCESS 1[0m in 1.22s]
[0m00:44:28.129223 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:28.143248 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 00:44:28.125159 => 00:44:28.142889
[0m00:44:28.132408 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:44:28.146123 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:44:28.149175 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:44:28.154475 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:28.165744 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:44:28.168625 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:44:28.157373 [info ] [Thread-3  ]: 8 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_success_output .... [RUN]
[0m00:44:28.177705 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m00:44:28.180967 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:44:28.188278 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:28.191406 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 00:44:28.183948 => 00:44:28.190969
[0m00:44:28.194390 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:44:28.200382 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:28.209195 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:44:28.218011 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:44:28.234141 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:28.237786 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:28.241384 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:44:28.679497 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:28.683421 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:44:28.690546 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:28.687174 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:28.738983 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m00:44:28.741656 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m00:44:28.767646 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:28.772740 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:28.775653 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m00:44:28.883759 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:44:28.889460 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:28.892361 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m00:44:28.913861 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:44:28.924707 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:28.929160 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m00:44:28.973570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:28.982549 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:44:28.985945 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m00:44:29.011257 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:44:29.017525 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:29.019962 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m00:44:29.024972 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:44:29.031429 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:29.036404 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m00:44:29.114981 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:29.119838 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 00:44:26.970090 => 00:44:29.119706
[0m00:44:29.122384 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m00:44:29.126430 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:44:29.133472 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:29.136862 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:29.139392 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m00:44:29.163084 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:44:29.215558 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:29.219779 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:29.222476 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:44:29.257163 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:29.260538 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:29.263225 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m00:44:29.368049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4808610>]}
[0m00:44:29.371576 [info ] [Thread-1  ]: 6 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ....... [[32mSUCCESS 0[0m in 2.46s]
[0m00:44:29.385853 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:44:29.397771 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:29.401099 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:29.403819 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:44:30.058277 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:44:30.061799 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:30.070321 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m00:44:30.242310 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:44:30.244938 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:30.247551 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m00:44:30.260223 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:30.265634 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:44:30.268609 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m00:44:30.389052 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:30.394043 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 00:44:28.150428 => 00:44:30.393872
[0m00:44:30.439472 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:30.441281 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m00:44:30.446921 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:44:30.453147 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m00:44:30.589457 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:30.596701 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 00:44:28.196547 => 00:44:30.596552
[0m00:44:30.619834 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m00:44:30.661542 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85855050>]}
[0m00:44:30.678545 [info ] [Thread-4  ]: 7 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 2.54s]
[0m00:44:30.689418 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:44:30.694256 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:44:30.705504 [info ] [Thread-1  ]: 9 of 12 START sql table model DBT_POC.fact_ip_to_company_domain ................ [RUN]
[0m00:44:30.709173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m00:44:30.713250 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:44:30.724395 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:44:30.737203 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 00:44:30.718585 => 00:44:30.736827
[0m00:44:30.743841 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:44:30.751781 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:44:30.755834 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:44:30.758321 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m00:44:30.762694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:44:30.874618 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858c6090>]}
[0m00:44:30.879309 [info ] [Thread-3  ]: 8 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 2.70s]
[0m00:44:30.881709 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:44:30.884974 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:44:30.887602 [info ] [Thread-4  ]: 10 of 12 START sql table model DBT_POC.src_ipflow_normalized_location .......... [RUN]
[0m00:44:30.890152 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m00:44:30.938768 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:44:30.943691 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:44:30.946810 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 00:44:30.940979 => 00:44:30.946575
[0m00:44:30.948897 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:44:30.952943 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:44:30.957116 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:44:30.959681 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m00:44:30.972451 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:44:31.732517 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:31.746685 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 00:44:30.749370 => 00:44:31.746448
[0m00:44:31.749868 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m00:44:31.807847 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:31.820766 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 00:44:30.950947 => 00:44:31.820646
[0m00:44:31.823253 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m00:44:31.965288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857ec590>]}
[0m00:44:31.968802 [info ] [Thread-1  ]: 9 of 12 OK created sql table model DBT_POC.fact_ip_to_company_domain ........... [[32mSUCCESS 1[0m in 1.26s]
[0m00:44:31.972527 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:44:32.063972 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85814b50>]}
[0m00:44:32.069925 [info ] [Thread-4  ]: 10 of 12 OK created sql table model DBT_POC.src_ipflow_normalized_location ..... [[32mSUCCESS 1[0m in 1.17s]
[0m00:44:32.078198 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:44:32.082546 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:44:32.087189 [info ] [Thread-3  ]: 11 of 12 START sql table model DBT_POC.src_ipflow_ip_to_location ............... [RUN]
[0m00:44:32.151634 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m00:44:32.155172 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:44:32.165475 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:44:32.169580 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 00:44:32.158872 => 00:44:32.169211
[0m00:44:32.172307 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:44:32.190594 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:44:32.198722 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:44:32.201518 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m00:44:32.204262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:44:33.167321 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:33.173642 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 00:44:32.183506 => 00:44:33.173469
[0m00:44:33.177586 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m00:44:33.390734 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8589a090>]}
[0m00:44:33.395684 [info ] [Thread-3  ]: 11 of 12 OK created sql table model DBT_POC.src_ipflow_ip_to_location .......... [[32mSUCCESS 1[0m in 1.24s]
[0m00:44:33.407071 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:44:33.410576 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:44:33.412976 [info ] [Thread-4  ]: 12 of 12 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [RUN]
[0m00:44:33.416123 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m00:44:33.427656 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:44:33.435325 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:33.438142 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 00:44:33.430618 => 00:44:33.437713
[0m00:44:33.440840 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:44:33.447227 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:33.453511 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:44:33.455814 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:44:33.966713 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:44:33.973128 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:34.021634 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m00:44:34.130437 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:44:34.139151 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:34.142230 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m00:44:34.233308 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:44:34.239256 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:34.247335 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m00:44:34.384197 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:44:34.394124 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:34.411250 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:34.416780 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m00:44:34.546032 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:34.551154 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:34.563281 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m00:44:35.130776 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:44:35.136812 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:35.140300 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m00:44:35.310064 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:35.316238 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:44:35.319427 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m00:44:35.449445 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:44:35.454479 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 00:44:33.443409 => 00:44:35.454327
[0m00:44:35.458775 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m00:44:35.664187 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857a82d0>]}
[0m00:44:35.671669 [info ] [Thread-4  ]: 12 of 12 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 0[0m in 2.25s]
[0m00:44:35.678848 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:45:35.089113 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 69.0 seconds
[0m00:45:35.126919 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:44:25.549181 => 00:45:35.125944
[0m00:45:35.132199 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:45:35.384903 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a71cdf7-0460-4a27-8d61-c80c9d2563a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8726d190>]}
[0m00:45:35.388842 [info ] [Thread-2  ]: 2 of 12 OK created sql table model DBT_POC.stg_ipflow_input_data ............... [[32mSUCCESS 1[0m in 69.95s]
[0m00:45:35.392765 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:45:35.450375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:45:35.455689 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m00:45:35.458714 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:45:35.463521 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m00:45:35.466419 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m00:45:35.469677 [info ] [MainThread]: 
[0m00:45:35.472409 [info ] [MainThread]: Finished running 8 table models, 4 incremental models in 0 hours 1 minutes and 12.03 seconds (72.03s).
[0m00:45:35.526771 [debug] [MainThread]: Command end result
[0m00:45:35.544345 [info ] [MainThread]: 
[0m00:45:35.553205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:45:35.556409 [info ] [MainThread]: 
[0m00:45:35.561839 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m00:45:35.568342 [debug] [MainThread]: Command `dbt run` succeeded at 00:45:35.567405 after 72.94 seconds
[0m00:45:35.581618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47fbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47fbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47fbbd0>]}
[0m00:45:35.584616 [debug] [MainThread]: Flushing usage events
[0m00:46:13.646030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36b69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36b6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36b6e10>]}


============================== 00:46:13.653153 | 8363a069-9c1c-4098-87ae-3164e23256f1 ==============================
[0m00:46:13.653153 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:46:13.656081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:46:14.611105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3653ed0>]}
[0m00:46:14.635617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e95a150>]}
[0m00:46:14.678445 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:46:14.869775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:14.874336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:14.894397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afc6d90>]}
[0m00:46:14.979184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af9e750>]}
[0m00:46:14.982715 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:46:14.985850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af9eb10>]}
[0m00:46:14.989811 [info ] [MainThread]: 
[0m00:46:14.994389 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:14.998563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:46:15.015271 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:46:15.018906 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:46:15.021406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:16.345091 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:46:16.359947 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:46:16.656861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:46:16.729032 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:46:16.732073 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:46:16.734329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:46:17.147614 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:46:17.156839 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:46:17.369818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af2f9d0>]}
[0m00:46:17.374545 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:46:17.387982 [info ] [MainThread]: 
[0m00:46:17.396886 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:46:17.397565 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:46:17.398355 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:46:17.400655 [info ] [Thread-1  ]: 1 of 12 START sql table model DBT_POC.src_ipflow_merge_output .................. [RUN]
[0m00:46:17.404188 [info ] [Thread-2  ]: 2 of 12 START sql table model DBT_POC.stg_ipflow_input_data .................... [RUN]
[0m00:46:17.406876 [info ] [Thread-3  ]: 3 of 12 START sql table model DBT_POC.stg_ipflow_success_data .................. [RUN]
[0m00:46:17.427435 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m00:46:17.424048 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_input_data'
[0m00:46:17.420163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m00:46:17.444176 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:46:17.450237 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:46:17.438442 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:46:17.441444 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:46:17.478988 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:46:17.491607 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:46:17.496266 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 00:46:17.446991 => 00:46:17.495299
[0m00:46:17.504205 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 00:46:17.476379 => 00:46:17.503890
[0m00:46:17.506958 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:46:17.513771 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:46:17.515694 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:46:17.483307 => 00:46:17.514340
[0m00:46:17.559172 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:46:17.566625 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:46:17.572654 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:46:17.575561 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:46:17.589438 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:46:17.637722 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:46:17.638194 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m00:46:17.641922 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:46:17.642703 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m00:46:17.657416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:46:17.654347 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 3700
        );
[0m00:46:17.650582 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:46:17.677661 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:46:18.560036 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:18.584085 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 00:46:17.517270 => 00:46:18.583941
[0m00:46:18.591073 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m00:46:18.792987 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0b2190>]}
[0m00:46:18.800172 [info ] [Thread-1  ]: 1 of 12 OK created sql table model DBT_POC.src_ipflow_merge_output ............. [[32mSUCCESS 1[0m in 1.37s]
[0m00:46:18.803152 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:46:18.807036 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:46:18.809350 [info ] [Thread-4  ]: 4 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_output ............ [RUN]
[0m00:46:18.813669 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_merge_output'
[0m00:46:18.816148 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:46:18.825201 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:18.833841 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 00:46:18.818644 => 00:46:18.833583
[0m00:46:18.836420 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:46:18.865112 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:18.868194 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:46:18.873278 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:46:18.941923 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:18.946860 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 00:46:17.536768 => 00:46:18.946711
[0m00:46:18.949825 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m00:46:19.162278 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a029e90>]}
[0m00:46:19.213054 [info ] [Thread-3  ]: 3 of 12 OK created sql table model DBT_POC.stg_ipflow_success_data ............. [[32mSUCCESS 1[0m in 1.74s]
[0m00:46:19.215990 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:46:19.219590 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:46:19.219952 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:46:19.222109 [info ] [Thread-1  ]: 5 of 12 START sql table model DBT_POC.src_ipflow_merge_domain_observations ..... [RUN]
[0m00:46:19.225335 [info ] [Thread-3  ]: 6 of 12 START sql table model DBT_POC.src_ipflow_merge_success_output .......... [RUN]
[0m00:46:19.228293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.src_ipflow_merge_domain_observations)
[0m00:46:19.231608 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.src_ipflow_merge_success_output)
[0m00:46:19.242992 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:46:19.245612 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:46:19.250272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:46:19.254774 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:46:19.273906 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 00:46:19.247826 => 00:46:19.273198
[0m00:46:19.276048 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 00:46:19.252973 => 00:46:19.275870
[0m00:46:19.277150 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:46:19.286863 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:46:19.292021 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:46:19.296641 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:46:19.312041 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:46:19.314256 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:46:19.315369 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m00:46:19.317480 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m00:46:19.320437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:46:19.322892 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:46:19.363958 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:19.381629 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:19.385592 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m00:46:19.497447 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:46:19.512325 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:19.516929 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m00:46:19.622944 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:46:19.635877 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:19.640309 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m00:46:19.808997 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:46:19.837371 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:19.852885 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:19.857035 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:46:19.977411 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:19.980207 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:19.982883 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:46:20.160736 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:20.164043 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:20.177286 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 00:46:19.294817 => 00:46:20.177069
[0m00:46:20.169278 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 00:46:19.289646 => 00:46:20.169033
[0m00:46:20.180325 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m00:46:20.184044 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m00:46:20.415543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887d8b10>]}
[0m00:46:20.417325 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88731f10>]}
[0m00:46:20.419035 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:46:20.420345 [info ] [Thread-1  ]: 5 of 12 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 1.19s]
[0m00:46:20.424243 [info ] [Thread-3  ]: 6 of 12 OK created sql table model DBT_POC.src_ipflow_merge_success_output ..... [[32mSUCCESS 1[0m in 1.19s]
[0m00:46:20.479670 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:20.489575 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m00:46:20.486371 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:46:20.483700 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:46:20.513949 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:46:20.509096 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:46:20.518434 [info ] [Thread-1  ]: 8 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m00:46:20.535824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m00:46:20.532257 [info ] [Thread-3  ]: 7 of 12 START sql incremental model DBT_POC.stg_ipflow_merge_success_output .... [RUN]
[0m00:46:20.541833 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m00:46:20.538687 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:46:20.552691 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:46:20.560272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:20.569060 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:20.591573 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 00:46:20.555768 => 00:46:20.591075
[0m00:46:20.592780 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 00:46:20.564823 => 00:46:20.592298
[0m00:46:20.598167 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:46:20.595128 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:46:20.607839 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:20.621210 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:46:20.619354 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:20.631442 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:46:20.635074 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:46:20.696298 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:20.697134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:46:20.709822 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:46:20.717427 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m00:46:20.846524 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:20.851244 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 00:46:18.838755 => 00:46:20.851104
[0m00:46:20.853698 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m00:46:21.117749 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a012d10>]}
[0m00:46:21.121611 [info ] [Thread-4  ]: 4 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ....... [[32mSUCCESS 0[0m in 2.30s]
[0m00:46:21.130598 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:46:21.212183 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:21.220111 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:21.223396 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:21.223927 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m00:46:21.235671 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:21.243254 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m00:46:21.351981 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:46:21.358188 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:21.359426 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:46:21.361999 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m00:46:21.367112 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:21.392175 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m00:46:21.475228 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:46:21.481203 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:21.527832 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m00:46:21.530565 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:46:21.538134 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:21.541061 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m00:46:21.663321 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:46:21.665276 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:46:21.672387 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:21.690923 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:21.712027 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:21.713144 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:21.714888 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:46:21.718141 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m00:46:21.839645 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:21.842856 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:21.845452 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m00:46:21.885289 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:21.887801 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:21.890422 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:46:22.377943 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:46:22.387615 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:22.393936 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m00:46:22.537404 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:46:22.542407 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:22.545856 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m00:46:22.590288 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:22.598669 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:46:22.602308 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m00:46:22.734877 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:22.739747 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:46:22.742068 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m00:46:22.744998 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:22.749930 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 00:46:20.602987 => 00:46:22.749794
[0m00:46:22.753169 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m00:46:22.880201 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:22.885019 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 00:46:20.612979 => 00:46:22.884899
[0m00:46:22.887752 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m00:46:23.036162 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8868ed50>]}
[0m00:46:23.051030 [info ] [Thread-3  ]: 7 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 2.49s]
[0m00:46:23.054920 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:46:23.059002 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:46:23.061521 [info ] [Thread-4  ]: 9 of 12 START sql table model DBT_POC.src_ipflow_normalized_location ........... [RUN]
[0m00:46:23.071572 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_output, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m00:46:23.074951 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:46:23.079803 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:46:23.092637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8862dcd0>]}
[0m00:46:23.095385 [info ] [Thread-1  ]: 8 of 12 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 2.56s]
[0m00:46:23.098952 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:46:23.093516 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 00:46:23.077216 => 00:46:23.093025
[0m00:46:23.101941 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:46:23.103355 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:46:23.105849 [info ] [Thread-3  ]: 10 of 12 START sql table model DBT_POC.fact_ip_to_company_domain ............... [RUN]
[0m00:46:23.111108 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:46:23.115131 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m00:46:23.122732 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:46:23.125401 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:46:23.128040 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:46:23.130247 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m00:46:23.138011 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:46:23.140620 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 00:46:23.125790 => 00:46:23.140419
[0m00:46:23.145450 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:46:23.193397 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:46:23.211208 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:46:23.214225 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m00:46:23.227189 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:46:23.916633 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:23.949524 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 00:46:23.108790 => 00:46:23.949132
[0m00:46:23.965618 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m00:46:24.002497 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:24.009430 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 00:46:23.191077 => 00:46:24.009245
[0m00:46:24.012888 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m00:46:24.180404 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885d3250>]}
[0m00:46:24.187604 [info ] [Thread-4  ]: 9 of 12 OK created sql table model DBT_POC.src_ipflow_normalized_location ...... [[32mSUCCESS 1[0m in 1.11s]
[0m00:46:24.194549 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:46:24.200815 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:46:24.205297 [info ] [Thread-1  ]: 11 of 12 START sql table model DBT_POC.src_ipflow_ip_to_location ............... [RUN]
[0m00:46:24.210441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m00:46:24.213599 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:46:24.219922 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:46:24.230378 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 00:46:24.216494 => 00:46:24.230113
[0m00:46:24.233464 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:46:24.238299 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:46:24.247955 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:46:24.294483 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m00:46:24.294040 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88623fd0>]}
[0m00:46:24.297314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:46:24.300626 [info ] [Thread-3  ]: 10 of 12 OK created sql table model DBT_POC.fact_ip_to_company_domain .......... [[32mSUCCESS 1[0m in 1.18s]
[0m00:46:24.307852 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:46:25.114978 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:46:25.144401 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 00:46:24.235895 => 00:46:25.144097
[0m00:46:25.166509 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m00:46:25.387615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8868f190>]}
[0m00:46:25.402099 [info ] [Thread-1  ]: 11 of 12 OK created sql table model DBT_POC.src_ipflow_ip_to_location .......... [[32mSUCCESS 1[0m in 1.18s]
[0m00:46:25.422540 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:46:25.427813 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:46:25.433267 [info ] [Thread-4  ]: 12 of 12 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [RUN]
[0m00:46:25.438475 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m00:46:25.442329 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:46:25.457530 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:25.465239 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 00:46:25.453724 => 00:46:25.464947
[0m00:46:25.467936 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:46:25.474095 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:25.476479 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:46:25.478930 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:46:25.953845 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:26.002710 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:26.005163 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m00:46:26.117856 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:46:26.123516 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:26.126400 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m00:46:26.230648 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:46:26.242796 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:26.247367 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m00:46:26.399444 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:46:26.406529 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:26.426632 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:26.429140 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m00:46:26.552995 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:26.555979 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:26.558524 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m00:46:27.025867 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.0 seconds
[0m00:46:27.028877 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:27.032789 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m00:46:27.214815 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:27.220462 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:46:27.229781 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m00:46:27.416190 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:46:27.423550 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 00:46:25.470872 => 00:46:27.423293
[0m00:46:27.427377 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m00:46:27.674793 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8865fa50>]}
[0m00:46:27.679618 [info ] [Thread-4  ]: 12 of 12 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 0[0m in 2.24s]
[0m00:46:27.692654 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:47:24.817166 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 67.0 seconds
[0m00:47:24.841372 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:46:17.572968 => 00:47:24.840954
[0m00:47:24.845260 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:47:25.057594 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8363a069-9c1c-4098-87ae-3164e23256f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5dcd10>]}
[0m00:47:25.063789 [info ] [Thread-2  ]: 2 of 12 OK created sql table model DBT_POC.stg_ipflow_input_data ............... [[32mSUCCESS 1[0m in 67.63s]
[0m00:47:25.068039 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:47:25.165116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:25.168535 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m00:47:25.174474 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:47:25.177261 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m00:47:25.179563 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m00:47:25.182539 [info ] [MainThread]: 
[0m00:47:25.232488 [info ] [MainThread]: Finished running 8 table models, 4 incremental models in 0 hours 1 minutes and 10.19 seconds (70.19s).
[0m00:47:25.237569 [debug] [MainThread]: Command end result
[0m00:47:25.296655 [info ] [MainThread]: 
[0m00:47:25.300128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:47:25.302168 [info ] [MainThread]: 
[0m00:47:25.313674 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m00:47:25.317782 [debug] [MainThread]: Command `dbt run` succeeded at 00:47:25.317638 after 71.71 seconds
[0m00:47:25.320112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3656f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3653fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3653d50>]}
[0m00:47:25.322751 [debug] [MainThread]: Flushing usage events
[0m20:51:32.231532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c11d0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0812dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0812f70>]}


============================== 20:51:32.236275 | 34fd7cbe-43bd-4342-9d0f-2267c626cd14 ==============================
[0m20:51:32.236275 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:51:32.236970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:51:32.484346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34fd7cbe-43bd-4342-9d0f-2267c626cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0812700>]}
[0m20:51:32.496799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34fd7cbe-43bd-4342-9d0f-2267c626cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c81dda90>]}
[0m20:51:32.530725 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:51:32.565565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:32.565962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:32.572506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34fd7cbe-43bd-4342-9d0f-2267c626cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6d03e3e80>]}
[0m20:51:32.580358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34fd7cbe-43bd-4342-9d0f-2267c626cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c8258e80>]}
[0m20:51:32.580855 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:51:32.581379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34fd7cbe-43bd-4342-9d0f-2267c626cd14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c8258ee0>]}
[0m20:51:32.582880 [info ] [MainThread]: 
[0m20:51:32.583265 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:51:32.583756 [debug] [MainThread]: Command end result
[0m20:51:32.589442 [debug] [MainThread]: Command `dbt test` succeeded at 20:51:32.588876 after 0.40 seconds
[0m20:51:32.591500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c11d0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c81ddeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0812700>]}
[0m20:51:32.592549 [debug] [MainThread]: Flushing usage events
[0m20:51:42.511948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4489730a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa448e11d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa448e11f10>]}


============================== 20:51:42.515770 | 93eba1f3-3fd0-4b44-9c89-a48e6e036b9a ==============================
[0m20:51:42.515770 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:51:42.516397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'debug': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:51:42.772709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93eba1f3-3fd0-4b44-9c89-a48e6e036b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa448e116a0>]}
[0m20:51:42.784118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93eba1f3-3fd0-4b44-9c89-a48e6e036b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa448ff4a60>]}
[0m20:51:42.803527 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:51:42.831864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:42.832221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:42.837907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93eba1f3-3fd0-4b44-9c89-a48e6e036b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4290d2e50>]}
[0m20:51:42.843774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93eba1f3-3fd0-4b44-9c89-a48e6e036b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa438f63e50>]}
[0m20:51:42.844161 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:51:42.844495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93eba1f3-3fd0-4b44-9c89-a48e6e036b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa438f63eb0>]}
[0m20:51:42.846071 [info ] [MainThread]: 
[0m20:51:42.846862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:51:42.848296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m20:51:42.860265 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:51:42.860720 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:51:42.860989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:43.686858 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:51:43.690980 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:51:43.825600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93eba1f3-3fd0-4b44-9c89-a48e6e036b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa448e11f10>]}
[0m20:51:43.826506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:51:43.826941 [info ] [MainThread]: 
[0m20:51:43.837013 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:51:43.837879 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_ipflow_merge_success_output_user_ip ............. [RUN]
[0m20:51:43.838908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149)
[0m20:51:43.839361 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:51:43.845313 [debug] [Thread-2  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:51:43.852406 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_ipflow_merge_success_output_user_ip ............... [RUN]
[0m20:51:43.853182 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77'
[0m20:51:43.853608 [debug] [Thread-2  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:51:43.860892 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m20:51:43.859463 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:51:43.862946 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (compile): 20:51:43.839625 => 20:51:43.862667
[0m20:51:43.863415 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:51:43.863796 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (compile): 20:51:43.853961 => 20:51:43.863601
[0m20:51:43.880195 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m20:51:43.880632 [debug] [Thread-2  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:51:43.882926 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:51:43.883669 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m20:51:43.883977 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_ip
from DEV_QA.DBT_POC.stg_ipflow_merge_success_output
where user_ip is null



      
    ) dbt_internal_test
[0m20:51:43.884250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:51:43.885565 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:51:43.886268 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_ip as unique_field,
    count(*) as n_records

from DEV_QA.DBT_POC.stg_ipflow_merge_success_output
where user_ip is not null
group by user_ip
having count(*) > 1



      
    ) dbt_internal_test
[0m20:51:43.886628 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:51:44.198058 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:51:44.212722 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (execute): 20:51:43.880955 => 20:51:44.212496
[0m20:51:44.213117 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: Close
[0m20:51:44.331586 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_ipflow_merge_success_output_user_ip ..................... [[32mPASS[0m in 0.48s]
[0m20:51:44.332313 [debug] [Thread-2  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:51:44.395899 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:51:44.397816 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (execute): 20:51:43.864039 => 20:51:44.397623
[0m20:51:44.398163 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149: Close
[0m20:51:44.511447 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_ipflow_merge_success_output_user_ip ................... [[32mPASS[0m in 0.67s]
[0m20:51:44.512328 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:51:44.513951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:44.514192 [debug] [MainThread]: Connection 'test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149' was properly closed.
[0m20:51:44.514394 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77' was properly closed.
[0m20:51:44.514630 [info ] [MainThread]: 
[0m20:51:44.514935 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m20:51:44.515587 [debug] [MainThread]: Command end result
[0m20:51:44.521777 [info ] [MainThread]: 
[0m20:51:44.522317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:44.522764 [info ] [MainThread]: 
[0m20:51:44.523206 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:51:44.523873 [debug] [MainThread]: Command `dbt test` succeeded at 20:51:44.523775 after 2.04 seconds
[0m20:51:44.524208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4489730a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa448ff4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa438f63760>]}
[0m20:51:44.524521 [debug] [MainThread]: Flushing usage events
[0m20:53:33.469770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e80518280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e90f5adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e90f5af70>]}


============================== 20:53:33.473798 | 2b15c550-a7e8-4cf4-8aba-1261e0856a48 ==============================
[0m20:53:33.473798 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:53:33.474312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:53:33.706896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b15c550-a7e8-4cf4-8aba-1261e0856a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e90f5a700>]}
[0m20:53:33.718152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b15c550-a7e8-4cf4-8aba-1261e0856a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e811e5a90>]}
[0m20:53:33.739189 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:53:33.775464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:53:33.775869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:53:33.782276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b15c550-a7e8-4cf4-8aba-1261e0856a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e60193e80>]}
[0m20:53:33.790553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b15c550-a7e8-4cf4-8aba-1261e0856a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e701c0e80>]}
[0m20:53:33.791131 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:53:33.791502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b15c550-a7e8-4cf4-8aba-1261e0856a48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e701c0ee0>]}
[0m20:53:33.792894 [info ] [MainThread]: 
[0m20:53:33.793351 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:53:33.794820 [debug] [MainThread]: Command end result
[0m20:53:33.800648 [debug] [MainThread]: Command `dbt test` succeeded at 20:53:33.800205 after 0.36 seconds
[0m20:53:33.801094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e80518280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e811e5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e90f5a700>]}
[0m20:53:33.801417 [debug] [MainThread]: Flushing usage events
[0m20:54:31.488158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf80280a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51577e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51577fd0>]}


============================== 20:54:31.492411 | 4f085718-6551-4a5e-8fa2-c615cb94b175 ==============================
[0m20:54:31.492411 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:54:31.492969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:54:31.738193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f085718-6551-4a5e-8fa2-c615cb94b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf515776d0>]}
[0m20:54:31.750256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f085718-6551-4a5e-8fa2-c615cb94b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7093faf0>]}
[0m20:54:31.770568 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:54:31.804232 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:54:31.804842 [debug] [MainThread]: Partial parsing: added file: dbt_dsg_app://models/stg_ipflow_input_data.yml
[0m20:54:31.825466 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m20:54:31.841084 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m20:54:31.877185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f085718-6551-4a5e-8fa2-c615cb94b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf6024ddf0>]}
[0m20:54:31.883379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f085718-6551-4a5e-8fa2-c615cb94b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51c64e50>]}
[0m20:54:31.883814 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:54:31.884190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f085718-6551-4a5e-8fa2-c615cb94b175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf51c64ee0>]}
[0m20:54:31.885511 [info ] [MainThread]: 
[0m20:54:31.885905 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:54:31.886387 [debug] [MainThread]: Command end result
[0m20:54:31.892051 [debug] [MainThread]: Command `dbt test` succeeded at 20:54:31.891606 after 0.44 seconds
[0m20:54:31.892526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf80280a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf602275e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf515776d0>]}
[0m20:54:31.892870 [debug] [MainThread]: Flushing usage events
[0m20:56:41.961471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd806f0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5196fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5196ffd0>]}


============================== 20:56:41.965435 | f4a1d9f4-b51e-4e35-9c77-2e0e2d7b2226 ==============================
[0m20:56:41.965435 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:56:41.966019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:56:42.219101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4a1d9f4-b51e-4e35-9c77-2e0e2d7b2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5196f760>]}
[0m20:56:42.230557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4a1d9f4-b51e-4e35-9c77-2e0e2d7b2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd70185af0>]}
[0m20:56:42.248942 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:56:42.277258 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:56:42.277780 [debug] [MainThread]: Partial parsing: added file: dbt_dsg_app://models/schema.yml
[0m20:56:42.295279 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m20:56:42.309430 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m20:56:42.340643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4a1d9f4-b51e-4e35-9c77-2e0e2d7b2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80f16df0>]}
[0m20:56:42.345970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4a1d9f4-b51e-4e35-9c77-2e0e2d7b2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80e64e50>]}
[0m20:56:42.346309 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:56:42.346623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4a1d9f4-b51e-4e35-9c77-2e0e2d7b2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80e64ee0>]}
[0m20:56:42.347918 [info ] [MainThread]: 
[0m20:56:42.348302 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:56:42.348770 [debug] [MainThread]: Command end result
[0m20:56:42.354571 [debug] [MainThread]: Command `dbt test` succeeded at 20:56:42.354157 after 0.42 seconds
[0m20:56:42.355045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd806f0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd5196f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd80e64f10>]}
[0m20:56:42.355347 [debug] [MainThread]: Flushing usage events
[0m20:56:51.086825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f8bb8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa908cdfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa908cdff70>]}


============================== 20:56:51.091488 | afc6917e-ac58-46a3-bfc8-09b5986a8046 ==============================
[0m20:56:51.091488 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:56:51.092038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:56:51.350541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afc6917e-ac58-46a3-bfc8-09b5986a8046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa908cdf640>]}
[0m20:56:51.363220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afc6917e-ac58-46a3-bfc8-09b5986a8046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f933cac0>]}
[0m20:56:51.395895 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:56:51.427354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:51.427788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:51.434537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afc6917e-ac58-46a3-bfc8-09b5986a8046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e8e82e50>]}
[0m20:56:51.442233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afc6917e-ac58-46a3-bfc8-09b5986a8046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f93bbdc0>]}
[0m20:56:51.442856 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:56:51.443296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc6917e-ac58-46a3-bfc8-09b5986a8046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f93bbe50>]}
[0m20:56:51.446161 [info ] [MainThread]: 
[0m20:56:51.447159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:56:51.449000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m20:56:51.461610 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m20:56:51.462097 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m20:56:51.462388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:52.332822 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m20:56:52.337523 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m20:56:52.475200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc6917e-ac58-46a3-bfc8-09b5986a8046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa908cdff70>]}
[0m20:56:52.477066 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:52.477858 [info ] [MainThread]: 
[0m20:56:52.489461 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:56:52.490163 [debug] [Thread-2  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:56:52.490926 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_ipflow_merge_success_output_user_ip ............. [RUN]
[0m20:56:52.491865 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_ipflow_merge_success_output_user_ip ............... [RUN]
[0m20:56:52.493007 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149)
[0m20:56:52.493897 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77'
[0m20:56:52.494358 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:56:52.494767 [debug] [Thread-2  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:56:52.509604 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m20:56:52.516403 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:56:52.519161 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (compile): 20:56:52.495064 => 20:56:52.518815
[0m20:56:52.519656 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (compile): 20:56:52.510049 => 20:56:52.519441
[0m20:56:52.520035 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:56:52.520365 [debug] [Thread-2  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:56:52.537824 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m20:56:52.540308 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:56:52.541554 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m20:56:52.542248 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m20:56:52.542590 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_ip as unique_field,
    count(*) as n_records

from DEV_QA.DBT_POC.stg_ipflow_merge_success_output
where user_ip is not null
group by user_ip
having count(*) > 1



      
    ) dbt_internal_test
[0m20:56:52.542906 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_ip
from DEV_QA.DBT_POC.stg_ipflow_merge_success_output
where user_ip is null



      
    ) dbt_internal_test
[0m20:56:52.543197 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:56:52.543470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:56:53.039476 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:56:53.055510 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (execute): 20:56:52.520587 => 20:56:53.055014
[0m20:56:53.056245 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149: Close
[0m20:56:53.073402 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:56:53.076272 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (execute): 20:56:52.538194 => 20:56:53.075968
[0m20:56:53.076792 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: Close
[0m20:56:53.184233 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_ipflow_merge_success_output_user_ip ................... [[32mPASS[0m in 0.69s]
[0m20:56:53.186118 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m20:56:53.205150 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_ipflow_merge_success_output_user_ip ..................... [[32mPASS[0m in 0.71s]
[0m20:56:53.206682 [debug] [Thread-2  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m20:56:53.209799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:53.210367 [debug] [MainThread]: Connection 'test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149' was properly closed.
[0m20:56:53.210728 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77' was properly closed.
[0m20:56:53.211158 [info ] [MainThread]: 
[0m20:56:53.211706 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m20:56:53.212969 [debug] [MainThread]: Command end result
[0m20:56:53.221964 [info ] [MainThread]: 
[0m20:56:53.222729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:53.223372 [info ] [MainThread]: 
[0m20:56:53.223833 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:56:53.224581 [debug] [MainThread]: Command `dbt test` succeeded at 20:56:53.224471 after 2.17 seconds
[0m20:56:53.224971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f8bb8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f933cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f93bbe80>]}
[0m20:56:53.225349 [debug] [MainThread]: Flushing usage events
[0m01:16:33.498224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d392a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d392f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d392e90>]}


============================== 01:16:33.506237 | 7c67452d-68c2-4f2e-bcf3-0b0173ce59bc ==============================
[0m01:16:33.506237 [info ] [MainThread]: Running with dbt=1.5.1
[0m01:16:33.510553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:16:34.113887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c67452d-68c2-4f2e-bcf3-0b0173ce59bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d331fd0>]}
[0m01:16:34.136459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c67452d-68c2-4f2e-bcf3-0b0173ce59bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d34b690>]}
[0m01:16:34.147739 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m01:16:34.285934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:16:34.288227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:16:34.302709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c67452d-68c2-4f2e-bcf3-0b0173ce59bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff656db190>]}
[0m01:16:34.351258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c67452d-68c2-4f2e-bcf3-0b0173ce59bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65698e90>]}
[0m01:16:34.353756 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:16:34.356311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c67452d-68c2-4f2e-bcf3-0b0173ce59bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff656987d0>]}
[0m01:16:34.360824 [info ] [MainThread]: 
[0m01:16:34.363509 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:16:34.366210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m01:16:34.378075 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m01:16:34.383453 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m01:16:34.386064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:35.197096 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m01:16:35.201803 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m01:16:35.434068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m01:16:35.495554 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m01:16:35.500432 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m01:16:35.503688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:35.945866 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m01:16:35.956462 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m01:16:36.170336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c67452d-68c2-4f2e-bcf3-0b0173ce59bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64afb1d0>]}
[0m01:16:36.191720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:16:36.197862 [info ] [MainThread]: 
[0m01:16:36.210298 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m01:16:36.223012 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m01:16:36.226245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m01:16:36.229339 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m01:16:36.233721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m01:16:36.246518 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 01:16:36.231739 => 01:16:36.246305
[0m01:16:36.250710 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m01:16:36.283652 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m01:16:36.303218 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m01:16:36.360958 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 3700
        );
[0m01:16:36.366222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:17.556720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9100da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9100ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9100df50>]}


============================== 01:17:17.565861 | 4501e338-69d4-481c-ba53-0069ac5e5b20 ==============================
[0m01:17:17.565861 [info ] [MainThread]: Running with dbt=1.5.1
[0m01:17:17.578912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:17:18.638562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4501e338-69d4-481c-ba53-0069ac5e5b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fcf5d0>]}
[0m01:17:18.659559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4501e338-69d4-481c-ba53-0069ac5e5b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff794dec90>]}
[0m01:17:18.678486 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m01:17:18.796262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:17:18.799284 [debug] [MainThread]: Partial parsing: updated file: dbt_dsg_app://models/ipflow/stg_ipflow_input_data.sql
[0m01:17:18.865408 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m01:17:18.927442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4501e338-69d4-481c-ba53-0069ac5e5b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff795266d0>]}
[0m01:17:18.990218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4501e338-69d4-481c-ba53-0069ac5e5b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79514d90>]}
[0m01:17:18.993815 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:17:18.998838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4501e338-69d4-481c-ba53-0069ac5e5b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79514b10>]}
[0m01:17:19.004751 [info ] [MainThread]: 
[0m01:17:19.008340 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:19.012476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m01:17:19.027590 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m01:17:19.084936 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m01:17:19.088700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:20.023337 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m01:17:20.038380 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m01:17:20.254396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m01:17:20.280390 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m01:17:20.311930 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m01:17:20.317237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:20.943301 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m01:17:20.948135 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m01:17:21.196142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4501e338-69d4-481c-ba53-0069ac5e5b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b1981d0>]}
[0m01:17:21.200882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:17:21.204251 [info ] [MainThread]: 
[0m01:17:21.215569 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m01:17:21.219434 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m01:17:21.222799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m01:17:21.225556 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m01:17:21.231823 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m01:17:21.241271 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 01:17:21.229441 => 01:17:21.240937
[0m01:17:21.245724 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m01:17:21.270324 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m01:17:21.329798 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m01:17:21.332717 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m01:17:21.336702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:18:48.824558 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 87.0 seconds
[0m01:18:48.873187 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 01:17:21.248679 => 01:18:48.872637
[0m01:18:48.881776 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m01:18:49.115121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4501e338-69d4-481c-ba53-0069ac5e5b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff698d4b90>]}
[0m01:18:49.120565 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 87.89s]
[0m01:18:49.123941 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m01:18:49.170369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:49.173558 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m01:18:49.177371 [info ] [MainThread]: 
[0m01:18:49.185204 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 30.17 seconds (90.17s).
[0m01:18:49.190242 [debug] [MainThread]: Command end result
[0m01:18:49.316204 [info ] [MainThread]: 
[0m01:18:49.319734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:49.323072 [info ] [MainThread]: 
[0m01:18:49.325757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:18:49.337971 [debug] [MainThread]: Command `dbt run` succeeded at 01:18:49.337723 after 91.83 seconds
[0m01:18:49.340721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fa8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fa8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fa8bd0>]}
[0m01:18:49.343420 [debug] [MainThread]: Flushing usage events
[0m01:18:54.433135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6afb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6aff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6affd0>]}


============================== 01:18:54.440810 | 421070e1-cc4a-4b7b-b493-30d51bc749d7 ==============================
[0m01:18:54.440810 [info ] [MainThread]: Running with dbt=1.5.1
[0m01:18:54.445262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:18:55.204654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '421070e1-cc4a-4b7b-b493-30d51bc749d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac674650>]}
[0m01:18:55.219403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '421070e1-cc4a-4b7b-b493-30d51bc749d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf21bed0>]}
[0m01:18:55.232568 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m01:18:55.382750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:55.386233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:55.401786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421070e1-cc4a-4b7b-b493-30d51bc749d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4b1e90>]}
[0m01:18:55.454596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421070e1-cc4a-4b7b-b493-30d51bc749d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f9dbd0>]}
[0m01:18:55.457763 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:18:55.461680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421070e1-cc4a-4b7b-b493-30d51bc749d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f9dd90>]}
[0m01:18:55.464893 [info ] [MainThread]: 
[0m01:18:55.468172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:18:55.471674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m01:18:55.486353 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m01:18:55.497118 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m01:18:55.503419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:56.298573 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m01:18:56.312232 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m01:18:56.570050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421070e1-cc4a-4b7b-b493-30d51bc749d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae080f10>]}
[0m01:18:56.581045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:18:56.584253 [info ] [MainThread]: 
[0m01:18:56.593344 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m01:18:56.593704 [debug] [Thread-2  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m01:18:56.596076 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_ipflow_merge_success_output_user_ip ............. [RUN]
[0m01:18:56.606970 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_ipflow_merge_success_output_user_ip ............... [RUN]
[0m01:18:56.610388 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149)
[0m01:18:56.613355 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77'
[0m01:18:56.616073 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m01:18:56.618558 [debug] [Thread-2  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m01:18:56.638513 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m01:18:56.644983 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m01:18:56.659946 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (compile): 01:18:56.629780 => 01:18:56.659657
[0m01:18:56.660724 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (compile): 01:18:56.640042 => 01:18:56.660500
[0m01:18:56.663798 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m01:18:56.667197 [debug] [Thread-2  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m01:18:56.684809 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m01:18:56.688458 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m01:18:56.702488 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"
[0m01:18:56.704371 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"
[0m01:18:56.706079 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_ip
from DEV_QA.DBT_POC.stg_ipflow_merge_success_output
where user_ip is null



      
    ) dbt_internal_test
[0m01:18:56.710951 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_ip as unique_field,
    count(*) as n_records

from DEV_QA.DBT_POC.stg_ipflow_merge_success_output
where user_ip is not null
group by user_ip
having count(*) > 1



      
    ) dbt_internal_test
[0m01:18:56.714537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:18:56.717438 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:18:57.141809 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:18:57.155474 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:18:57.174830 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149 (execute): 01:18:56.669631 => 01:18:57.174484
[0m01:18:57.176907 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77 (execute): 01:18:56.686482 => 01:18:57.176763
[0m01:18:57.194161 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77: Close
[0m01:18:57.186578 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149: Close
[0m01:18:57.427678 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_ipflow_merge_success_output_user_ip ................... [[32mPASS[0m in 0.82s]
[0m01:18:57.431014 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_ipflow_merge_success_output_user_ip ..................... [[32mPASS[0m in 0.82s]
[0m01:18:57.455208 [debug] [Thread-2  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77
[0m01:18:57.439224 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149
[0m01:18:57.513329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:57.517870 [debug] [MainThread]: Connection 'test.dbt_dsg_app.not_null_stg_ipflow_merge_success_output_user_ip.0857220149' was properly closed.
[0m01:18:57.531265 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_merge_success_output_user_ip.4d69f32a77' was properly closed.
[0m01:18:57.534439 [info ] [MainThread]: 
[0m01:18:57.538148 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m01:18:57.542190 [debug] [MainThread]: Command end result
[0m01:18:57.581732 [info ] [MainThread]: 
[0m01:18:57.584829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:57.588807 [info ] [MainThread]: 
[0m01:18:57.639968 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:18:57.643594 [debug] [MainThread]: Command `dbt test` succeeded at 01:18:57.643475 after 3.24 seconds
[0m01:18:57.646410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac64de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac64de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e3cc10>]}
[0m01:18:57.649581 [debug] [MainThread]: Flushing usage events
[0m01:19:08.484034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d26a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1a3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d26e90>]}
[0m01:19:08.484031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9167fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9167ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9167ff90>]}


============================== 01:19:08.495980 | 82b0140d-4ca2-4972-ae1c-db93873001c5 ==============================
[0m01:19:08.495980 [info ] [MainThread]: Running with dbt=1.5.1


============================== 01:19:08.492685 | 8b2f665c-e6d9-42b3-b348-08ab16e5de21 ==============================
[0m01:19:08.492685 [info ] [MainThread]: Running with dbt=1.5.1
[0m01:19:08.498997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:19:08.507666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:19:09.115004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9162ef10>]}
[0m01:19:09.115006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cc3c50>]}
[0m01:19:09.129884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71622dd0>]}
[0m01:19:09.129420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827b3f90>]}
[0m01:19:09.140210 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m01:19:09.145197 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m01:19:09.277946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:09.280792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:09.289014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78480410>]}
[0m01:19:09.292611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:09.305700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:09.313861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8048d590>]}
[0m01:19:09.350594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7842be10>]}
[0m01:19:09.375935 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:19:09.425536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7842bb90>]}
[0m01:19:09.430714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80433f10>]}
[0m01:19:09.441703 [info ] [MainThread]: 
[0m01:19:09.443727 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:19:09.449253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:19:09.450775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804336d0>]}
[0m01:19:09.463115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m01:19:09.465229 [info ] [MainThread]: 
[0m01:19:09.469463 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:19:09.472949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m01:19:09.478500 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m01:19:09.484593 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m01:19:09.486826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:09.499328 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m01:19:09.531187 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m01:19:09.537707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:10.188831 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m01:19:10.193650 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m01:19:10.199688 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m01:19:10.204757 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m01:19:10.403263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m01:19:10.407857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m01:19:10.465546 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m01:19:10.468733 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m01:19:10.469228 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m01:19:10.474236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:10.471899 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m01:19:10.477628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:11.080503 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m01:19:11.084832 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m01:19:11.091669 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m01:19:11.106082 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m01:19:11.324024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f88e50>]}
[0m01:19:11.338206 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:19:11.342160 [info ] [MainThread]: 
[0m01:19:11.342887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707a4c10>]}
[0m01:19:11.348872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:19:11.351758 [info ] [MainThread]: 
[0m01:19:11.354661 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:11.358489 [info ] [Thread-1  ]: 1 of 9 START sql table model DBT_POC.stg_ipflow_success_data ................... [RUN]
[0m01:19:11.362172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_success_data)
[0m01:19:11.363117 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m01:19:11.375509 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:11.377227 [info ] [Thread-1  ]: 1 of 11 START sql table model DBT_POC.src_ipflow_merge_output .................. [RUN]
[0m01:19:11.382046 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m01:19:11.363810 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:11.384466 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m01:19:11.396963 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 01:19:11.378905 => 01:19:11.396682
[0m01:19:11.393540 [info ] [Thread-2  ]: 2 of 11 START sql table model DBT_POC.stg_ipflow_success_data .................. [RUN]
[0m01:19:11.450047 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:11.398358 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m01:19:11.459950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m01:19:11.453011 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m01:19:11.465890 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:11.471888 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m01:19:11.468391 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 01:19:11.456653 => 01:19:11.467994
[0m01:19:11.480890 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m01:19:11.485867 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m01:19:11.501837 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m01:19:11.503471 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m01:19:11.505774 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:11.499950 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 01:19:11.469635 => 01:19:11.499621
[0m01:19:11.513778 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:11.523673 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m01:19:11.527221 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m01:19:11.541257 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m01:19:11.543856 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m01:19:11.546011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:11.542086 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m01:19:11.552651 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m01:19:11.556407 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m01:19:12.519545 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:12.571546 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 01:19:11.525058 => 01:19:12.571339
[0m01:19:12.575959 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m01:19:12.686709 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:12.692763 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 01:19:11.488980 => 01:19:12.692616
[0m01:19:12.695592 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m01:19:12.785938 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:12.788144 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70778810>]}
[0m01:19:12.793088 [info ] [Thread-2  ]: 2 of 11 OK created sql table model DBT_POC.stg_ipflow_success_data ............. [[32mSUCCESS 1[0m in 1.34s]
[0m01:19:12.796960 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:12.800587 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:12.804129 [info ] [Thread-4  ]: 3 of 11 START sql table model DBT_POC.src_ipflow_merge_domain_observations ..... [RUN]
[0m01:19:12.811611 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 01:19:11.453043 => 01:19:12.811468
[0m01:19:12.819542 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m01:19:12.807885 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m01:19:12.801230 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:12.824648 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:12.828098 [info ] [Thread-3  ]: 4 of 11 START sql table model DBT_POC.src_ipflow_merge_success_output .......... [RUN]
[0m01:19:12.843207 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m01:19:12.846484 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m01:19:12.852177 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:12.863135 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m01:19:12.863728 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 01:19:12.840481 => 01:19:12.863593
[0m01:19:12.868692 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:12.870955 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 01:19:12.860975 => 01:19:12.870573
[0m01:19:12.874059 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m01:19:12.882153 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:12.889442 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m01:19:12.891927 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m01:19:12.895518 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m01:19:12.898069 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m01:19:12.898889 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:19:12.901114 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m01:19:12.907107 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:19:12.953379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70773390>]}
[0m01:19:12.958148 [info ] [Thread-1  ]: 1 of 11 OK created sql table model DBT_POC.src_ipflow_merge_output ............. [[32mSUCCESS 1[0m in 1.57s]
[0m01:19:12.960698 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m01:19:12.964483 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m01:19:12.966773 [info ] [Thread-2  ]: 5 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_output ............ [RUN]
[0m01:19:13.016693 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_output)
[0m01:19:13.019246 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m01:19:13.022246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80461fd0>]}
[0m01:19:13.025501 [info ] [Thread-1  ]: 1 of 9 OK created sql table model DBT_POC.stg_ipflow_success_data .............. [[32mSUCCESS 1[0m in 1.66s]
[0m01:19:13.028639 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m01:19:13.031692 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:13.032066 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:13.043213 [info ] [Thread-3  ]: 2 of 9 START sql table model DBT_POC.src_ipflow_merge_domain_observations ...... [RUN]
[0m01:19:13.034428 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:13.045885 [info ] [Thread-4  ]: 3 of 9 START sql table model DBT_POC.src_ipflow_merge_success_output ........... [RUN]
[0m01:19:13.048920 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m01:19:13.061771 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m01:19:13.064779 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 01:19:13.021923 => 01:19:13.064520
[0m01:19:13.064853 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:13.069350 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m01:19:13.067926 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:13.073809 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m01:19:13.082970 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m01:19:13.097597 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 01:19:13.071218 => 01:19:13.097052
[0m01:19:13.100478 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:13.105023 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m01:19:13.100890 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 01:19:13.080082 => 01:19:13.100759
[0m01:19:13.109075 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:13.107808 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:13.113487 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m01:19:13.111606 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m01:19:13.115769 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:19:13.114089 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m01:19:13.116794 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m01:19:13.127079 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:19:13.129506 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m01:19:13.133563 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m01:19:13.136905 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:19:13.666167 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:13.682032 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:13.685536 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m01:19:13.789341 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:13.817993 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:13.820948 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m01:19:13.925059 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:13.934599 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:13.937683 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m01:19:14.073260 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:14.118932 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:14.125569 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 01:19:13.102777 => 01:19:14.125369
[0m01:19:14.128915 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:14.128636 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m01:19:14.140103 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:14.142842 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m01:19:14.200208 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:14.206079 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 01:19:12.887369 => 01:19:14.205856
[0m01:19:14.209020 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m01:19:14.237951 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:14.247693 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 01:19:12.871576 => 01:19:14.247226
[0m01:19:14.251081 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m01:19:14.252428 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:14.261142 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:14.264187 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m01:19:14.368025 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f8f410>]}
[0m01:19:14.372780 [info ] [Thread-3  ]: 2 of 9 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations . [[32mSUCCESS 1[0m in 1.32s]
[0m01:19:14.381726 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:14.385558 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:14.388755 [info ] [Thread-1  ]: 4 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m01:19:14.393064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m01:19:14.395872 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:14.396875 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:14.414362 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:14.421658 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7058eb10>]}
[0m01:19:14.417711 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 01:19:13.111965 => 01:19:14.417582
[0m01:19:14.428953 [info ] [Thread-3  ]: 4 of 11 OK created sql table model DBT_POC.src_ipflow_merge_success_output ..... [[32mSUCCESS 1[0m in 1.58s]
[0m01:19:14.442476 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:14.436743 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m01:19:14.446201 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:14.442533 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 01:19:14.406120 => 01:19:14.441960
[0m01:19:14.450015 [info ] [Thread-1  ]: 6 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_success_output .... [RUN]
[0m01:19:14.460828 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:14.462099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m01:19:14.471894 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:14.479879 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:14.489463 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 01:19:14.476095 => 01:19:14.489153
[0m01:19:14.492810 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:14.497756 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:14.499869 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m01:19:14.505310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:14.513962 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70616ed0>]}
[0m01:19:14.520689 [info ] [Thread-4  ]: 3 of 11 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 1.71s]
[0m01:19:14.524607 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m01:19:14.528519 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:14.527789 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:14.532757 [info ] [Thread-3  ]: 7 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m01:19:14.536439 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m01:19:14.533614 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m01:19:14.538805 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:14.541535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:14.595446 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:14.612159 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 01:19:14.591774 => 01:19:14.611883
[0m01:19:14.615022 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:14.620689 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:14.630224 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m01:19:14.634094 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:19:14.671078 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78113c10>]}
[0m01:19:14.674212 [info ] [Thread-4  ]: 3 of 9 OK created sql table model DBT_POC.src_ipflow_merge_success_output ...... [[32mSUCCESS 1[0m in 1.61s]
[0m01:19:14.677252 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m01:19:14.680483 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:14.704190 [info ] [Thread-3  ]: 5 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_success_output ..... [RUN]
[0m01:19:14.707126 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m01:19:14.711099 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:14.716870 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:14.725719 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 01:19:14.713898 => 01:19:14.724640
[0m01:19:14.728848 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:14.734906 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:14.737051 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m01:19:14.739501 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:19:15.039048 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:15.045476 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.048518 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m01:19:15.075109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:15.084879 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.134086 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:15.136020 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m01:19:15.134996 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:15.138253 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:15.145424 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.147738 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m01:19:15.150441 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m01:19:15.161090 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:15.171335 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.173838 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m01:19:15.206133 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:15.211879 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.214839 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m01:19:15.290653 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m01:19:15.297952 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.301669 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m01:19:15.307229 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.310074 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m01:19:15.302168 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m01:19:15.325906 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:15.333593 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:15.333484 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.342855 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m01:19:15.342519 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.349997 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m01:19:15.420181 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m01:19:15.420164 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m01:19:15.426911 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.479059 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:15.481924 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:15.493353 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.494813 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:15.482483 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m01:19:15.497611 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m01:19:15.489503 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.503100 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.517957 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m01:19:15.500667 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m01:19:15.520775 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m01:19:15.534651 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.537154 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m01:19:15.606190 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m01:19:15.607746 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m01:19:15.617830 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.614211 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m01:19:15.657191 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.659215 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:15.666246 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 01:19:13.077800 => 01:19:15.666049
[0m01:19:15.669065 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m01:19:15.661256 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m01:19:15.675989 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:15.683250 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.687530 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m01:19:15.684487 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.689954 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.700831 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.705750 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.707933 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m01:19:15.711715 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m01:19:15.834823 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:15.841180 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.844497 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m01:19:15.924203 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:15.930241 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:15.946788 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78434f10>]}
[0m01:19:15.946255 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:15.956601 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:15.951758 [info ] [Thread-2  ]: 5 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ....... [[32mSUCCESS 1[0m in 2.93s]
[0m01:19:15.967193 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m01:19:15.985689 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m01:19:15.947648 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m01:19:16.623534 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:16.629632 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:16.638412 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m01:19:16.635535 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:16.648020 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:16.664006 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:16.667486 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:16.731663 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m01:19:16.668054 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m01:19:16.895450 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:16.889879 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:16.900529 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:16.905175 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m01:19:16.921223 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:16.943744 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m01:19:17.009825 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:17.042630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:17.064944 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:17.079094 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m01:19:17.086662 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m01:19:17.076747 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:17.098047 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m01:19:17.111499 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 01:19:14.731572 => 01:19:17.110925
[0m01:19:17.114146 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m01:19:17.216559 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:17.216231 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:17.224236 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m01:19:17.230021 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 01:19:14.464337 => 01:19:17.229883
[0m01:19:17.232910 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m01:19:17.228632 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m01:19:17.233914 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:17.245927 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 01:19:14.494677 => 01:19:17.245542
[0m01:19:17.251593 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m01:19:17.327825 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72767690>]}
[0m01:19:17.336844 [info ] [Thread-3  ]: 5 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 1[0m in 2.62s]
[0m01:19:17.409121 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:17.420554 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:17.429234 [info ] [Thread-3  ]: 6 of 9 START sql table model DBT_POC.src_ipflow_normalized_location ............ [RUN]
[0m01:19:17.422062 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:17.435892 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m01:19:17.443205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727306d0>]}
[0m01:19:17.461720 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 01:19:14.617612 => 01:19:17.461373
[0m01:19:17.474493 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m01:19:17.467882 [info ] [Thread-1  ]: 4 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 3.05s]
[0m01:19:17.499213 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:17.513939 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:17.518136 [info ] [Thread-1  ]: 7 of 9 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m01:19:17.460900 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:17.527857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m01:19:17.549191 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:17.580188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7057bcd0>]}
[0m01:19:17.592697 [info ] [Thread-1  ]: 6 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 1[0m in 3.12s]
[0m01:19:17.552438 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m01:19:17.621119 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m01:19:17.588013 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m01:19:17.660008 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 01:19:17.535812 => 01:19:17.657947
[0m01:19:17.667023 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:17.666357 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:17.682463 [info ] [Thread-4  ]: 8 of 11 START sql table model DBT_POC.src_ipflow_normalized_location ........... [RUN]
[0m01:19:17.701025 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m01:19:17.665592 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 01:19:17.569070 => 01:19:17.664965
[0m01:19:17.724073 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:17.706484 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:17.705979 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m01:19:17.776782 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m01:19:17.733211 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff704fadd0>]}
[0m01:19:17.807242 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m01:19:17.822710 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m01:19:17.813047 [info ] [Thread-3  ]: 7 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 3.20s]
[0m01:19:17.852079 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m01:19:17.856940 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m01:19:17.843769 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m01:19:17.838219 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m01:19:17.925793 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:17.938899 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m01:19:17.951582 [info ] [Thread-1  ]: 9 of 11 START sql table model DBT_POC.fact_ip_to_company_domain ................ [RUN]
[0m01:19:18.014971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m01:19:18.001855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:18.062156 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:17.999904 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 01:19:17.755689 => 01:19:17.998923
[0m01:19:18.109768 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:18.091821 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m01:19:18.125096 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m01:19:18.191063 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 01:19:18.082447 => 01:19:18.190659
[0m01:19:18.218489 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m01:19:18.252855 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m01:19:18.282246 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:19:18.247954 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:18.442134 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m01:19:18.474122 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m01:19:18.485874 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m01:19:18.495323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:19.565551 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m01:19:19.671098 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 01:19:17.743615 => 01:19:19.670470
[0m01:19:19.680806 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m01:19:19.748127 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m01:19:19.797347 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 01:19:17.671477 => 01:19:19.797121
[0m01:19:19.812687 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m01:19:19.930724 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:19.952584 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72726710>]}
[0m01:19:19.981835 [info ] [Thread-1  ]: 7 of 9 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 2.42s]
[0m01:19:20.023718 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:20.029735 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 01:19:18.415554 => 01:19:20.026823
[0m01:19:20.044993 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m01:19:20.122060 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72607590>]}
[0m01:19:20.134666 [info ] [Thread-3  ]: 6 of 9 OK created sql table model DBT_POC.src_ipflow_normalized_location ....... [[32mSUCCESS 1[0m in 2.69s]
[0m01:19:20.140096 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:20.156341 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:20.160018 [info ] [Thread-4  ]: 8 of 9 START sql table model DBT_POC.src_ipflow_ip_to_location ................. [RUN]
[0m01:19:20.169654 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m01:19:20.183736 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:20.232580 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m01:19:20.249684 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m01:19:20.273191 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 01:19:20.187067 => 01:19:20.271935
[0m01:19:20.284598 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:20.274906 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 01:19:18.115820 => 01:19:20.274504
[0m01:19:20.315147 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m01:19:20.323748 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m01:19:20.434698 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m01:19:20.421417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707d27d0>]}
[0m01:19:20.438708 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m01:19:20.503982 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:19:20.460907 [info ] [Thread-1  ]: 9 of 11 OK created sql table model DBT_POC.fact_ip_to_company_domain ........... [[32mSUCCESS 1[0m in 2.40s]
[0m01:19:20.541722 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m01:19:20.650125 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff704b4410>]}
[0m01:19:20.657065 [info ] [Thread-4  ]: 8 of 11 OK created sql table model DBT_POC.src_ipflow_normalized_location ...... [[32mSUCCESS 1[0m in 2.95s]
[0m01:19:20.666149 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m01:19:20.681380 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:20.686119 [info ] [Thread-4  ]: 10 of 11 START sql table model DBT_POC.src_ipflow_ip_to_location ............... [RUN]
[0m01:19:20.692012 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m01:19:20.702621 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:20.751666 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m01:19:20.762942 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 01:19:20.706446 => 01:19:20.760965
[0m01:19:20.784872 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:20.814107 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m01:19:20.836176 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m01:19:20.842126 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m01:19:20.848078 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m01:19:21.931261 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:21.966310 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 01:19:20.287848 => 01:19:21.965511
[0m01:19:21.981481 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m01:19:22.167463 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:22.196268 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 01:19:20.794821 => 01:19:22.195525
[0m01:19:22.202032 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m01:19:22.212354 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72701b10>]}
[0m01:19:22.222555 [info ] [Thread-4  ]: 8 of 9 OK created sql table model DBT_POC.src_ipflow_ip_to_location ............ [[32mSUCCESS 1[0m in 2.05s]
[0m01:19:22.226829 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:22.232961 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:22.238434 [info ] [Thread-1  ]: 9 of 9 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings .. [RUN]
[0m01:19:22.243120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m01:19:22.245715 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:22.271552 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:22.300355 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 01:19:22.248558 => 01:19:22.299810
[0m01:19:22.305979 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:22.371839 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:22.377415 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m01:19:22.380687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:22.420296 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7056c8d0>]}
[0m01:19:22.426119 [info ] [Thread-4  ]: 10 of 11 OK created sql table model DBT_POC.src_ipflow_ip_to_location .......... [[32mSUCCESS 1[0m in 1.73s]
[0m01:19:22.439652 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m01:19:22.443656 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:22.449998 [info ] [Thread-1  ]: 11 of 11 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [RUN]
[0m01:19:22.470261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m01:19:22.476746 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:22.501739 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:22.533933 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 01:19:22.482000 => 01:19:22.533547
[0m01:19:22.537513 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:22.546752 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:22.550459 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m01:19:22.554714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:22.937516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:22.994137 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:22.996698 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m01:19:23.085556 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:23.101754 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.104736 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m01:19:23.104951 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m01:19:23.112865 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.125686 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m01:19:23.219681 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m01:19:23.221526 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m01:19:23.227568 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.244893 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.242807 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m01:19:23.246915 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m01:19:23.353734 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m01:19:23.360374 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.364665 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m01:19:23.380289 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m01:19:23.385841 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.395519 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.399997 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m01:19:23.469590 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m01:19:23.494993 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.506142 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.519942 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m01:19:23.567085 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:23.571301 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.574787 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m01:19:23.635865 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:23.640098 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:23.643467 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m01:19:24.160957 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:24.168490 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:24.171403 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m01:19:24.188528 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:24.200593 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:24.203558 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m01:19:24.648439 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:24.654646 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:24.657443 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m01:19:24.818385 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:24.824019 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 01:19:22.365421 => 01:19:24.823875
[0m01:19:24.827962 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m01:19:25.079719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b0140d-4ca2-4972-ae1c-db93873001c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727227d0>]}
[0m01:19:25.084000 [info ] [Thread-1  ]: 9 of 9 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 1[0m in 2.84s]
[0m01:19:25.087951 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:25.127952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:25.131557 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m01:19:25.134345 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_normalized_location' was properly closed.
[0m01:19:25.138251 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m01:19:25.148656 [info ] [MainThread]: 
[0m01:19:25.151824 [info ] [MainThread]: Finished running 6 table models, 3 incremental models in 0 hours 0 minutes and 15.68 seconds (15.68s).
[0m01:19:25.155606 [debug] [MainThread]: Command end result
[0m01:19:25.199405 [info ] [MainThread]: 
[0m01:19:25.203888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:25.206531 [info ] [MainThread]: 
[0m01:19:25.208619 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:19:25.212094 [debug] [MainThread]: Command `dbt run` succeeded at 01:19:25.211950 after 16.78 seconds
[0m01:19:25.261280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9162efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9162ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9162ee50>]}
[0m01:19:25.264410 [debug] [MainThread]: Flushing usage events
[0m01:19:25.544121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:19:25.549966 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m01:19:25.552813 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m01:19:25.688980 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m01:19:25.703862 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 01:19:22.541983 => 01:19:25.703663
[0m01:19:25.706940 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m01:19:25.925544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2f665c-e6d9-42b3-b348-08ab16e5de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7045e5d0>]}
[0m01:19:25.930278 [info ] [Thread-1  ]: 11 of 11 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 1[0m in 3.46s]
[0m01:19:25.934528 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m01:19:26.025320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:26.029905 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m01:19:26.034579 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_output' was properly closed.
[0m01:19:26.039955 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m01:19:26.044318 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_domain_observations' was properly closed.
[0m01:19:26.052421 [info ] [MainThread]: 
[0m01:19:26.055281 [info ] [MainThread]: Finished running 7 table models, 4 incremental models in 0 hours 0 minutes and 16.60 seconds (16.60s).
[0m01:19:26.060243 [debug] [MainThread]: Command end result
[0m01:19:26.171422 [info ] [MainThread]: 
[0m01:19:26.174676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:26.184960 [info ] [MainThread]: 
[0m01:19:26.187630 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m01:19:26.191187 [debug] [MainThread]: Command `dbt run` succeeded at 01:19:26.191019 after 17.76 seconds
[0m01:19:26.193740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d26ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d26410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d26f50>]}
[0m01:19:26.203694 [debug] [MainThread]: Flushing usage events
[0m21:24:37.886897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7893e8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7786eae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7786eafd0>]}


============================== 21:24:37.893323 | d14733cd-cc49-423a-8a56-dae2818ba68f ==============================
[0m21:24:37.893323 [info ] [MainThread]: Running with dbt=1.5.1
[0m21:24:37.893950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:24:38.157781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd14733cd-cc49-423a-8a56-dae2818ba68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7786ea760>]}
[0m21:24:38.169793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd14733cd-cc49-423a-8a56-dae2818ba68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7580d9b20>]}
[0m21:24:38.191721 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m21:24:38.226124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:24:38.226835 [debug] [MainThread]: Partial parsing: updated file: dbt_dsg_app://models/schema.yml
[0m21:24:38.248615 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m21:24:38.265547 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m21:24:38.304522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd14733cd-cc49-423a-8a56-dae2818ba68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa758115e20>]}
[0m21:24:38.307072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd14733cd-cc49-423a-8a56-dae2818ba68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa789d90e80>]}
[0m21:24:38.307615 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:24:38.308178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14733cd-cc49-423a-8a56-dae2818ba68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa789d90ee0>]}
[0m21:24:38.310827 [info ] [MainThread]: 
[0m21:24:38.312773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:24:38.315483 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m21:24:38.327222 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m21:24:38.327643 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m21:24:38.328141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:39.174287 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m21:24:39.176156 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m21:24:39.329703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14733cd-cc49-423a-8a56-dae2818ba68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa789e27ac0>]}
[0m21:24:39.330486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:24:39.330832 [info ] [MainThread]: 
[0m21:24:39.336855 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m21:24:39.337714 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m21:24:39.338408 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m21:24:39.345705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m21:24:39.346909 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_input_data'
[0m21:24:39.347719 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m21:24:39.348451 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m21:24:39.348747 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m21:24:39.349180 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m21:24:39.354964 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m21:24:39.358977 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m21:24:39.361963 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m21:24:39.363917 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 21:24:39.355528 => 21:24:39.363643
[0m21:24:39.364719 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 21:24:39.359361 => 21:24:39.364159
[0m21:24:39.365509 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 21:24:39.349540 => 21:24:39.364983
[0m21:24:39.365825 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m21:24:39.366731 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m21:24:39.367906 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m21:24:39.368794 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 21:24:39.368409 => 21:24:39.368481
[0m21:24:39.369388 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 21:24:39.369107 => 21:24:39.369116
[0m21:24:39.369797 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 21:24:39.369641 => 21:24:39.369647
[0m21:24:39.370603 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m21:24:39.371245 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m21:24:39.371878 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m21:24:39.372800 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m21:24:39.373827 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m21:24:39.374730 [debug] [Thread-3  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m21:24:39.375229 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m21:24:39.375852 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m21:24:39.376879 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_input_data, now model.dbt_dsg_app.src_ipflow_merge_success_output)
[0m21:24:39.377544 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11)
[0m21:24:39.378060 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095)
[0m21:24:39.378375 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m21:24:39.378660 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m21:24:39.378919 [debug] [Thread-3  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m21:24:39.379623 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m21:24:39.382700 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m21:24:39.386474 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m21:24:39.398595 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m21:24:39.404298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m21:24:39.406283 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 21:24:39.383301 => 21:24:39.405864
[0m21:24:39.406714 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m21:24:39.407488 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 21:24:39.379991 => 21:24:39.406992
[0m21:24:39.407992 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 21:24:39.407820 => 21:24:39.407831
[0m21:24:39.408352 [debug] [Thread-3  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (compile): 21:24:39.387041 => 21:24:39.408206
[0m21:24:39.408743 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (compile): 21:24:39.398978 => 21:24:39.408596
[0m21:24:39.409061 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m21:24:39.409876 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m21:24:39.410239 [debug] [Thread-3  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m21:24:39.410549 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m21:24:39.410929 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 21:24:39.410766 => 21:24:39.410774
[0m21:24:39.411294 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m21:24:39.412006 [debug] [Thread-3  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (execute): 21:24:39.411837 => 21:24:39.411844
[0m21:24:39.412441 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (execute): 21:24:39.412236 => 21:24:39.412241
[0m21:24:39.413285 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m21:24:39.413873 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_output)
[0m21:24:39.414580 [debug] [Thread-3  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m21:24:39.415273 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m21:24:39.415628 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m21:24:39.416229 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m21:24:39.416898 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m21:24:39.417803 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m21:24:39.423038 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m21:24:39.423986 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m21:24:39.424525 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m21:24:39.425169 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m21:24:39.429755 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m21:24:39.430739 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 21:24:39.418106 => 21:24:39.430474
[0m21:24:39.434269 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m21:24:39.434979 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m21:24:39.435721 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 21:24:39.435545 => 21:24:39.435554
[0m21:24:39.436717 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m21:24:39.437364 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 21:24:39.430989 => 21:24:39.437054
[0m21:24:39.437843 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 21:24:39.425621 => 21:24:39.437671
[0m21:24:39.438527 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m21:24:39.438965 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m21:24:39.439630 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 21:24:39.439433 => 21:24:39.439443
[0m21:24:39.440103 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 21:24:39.439936 => 21:24:39.439942
[0m21:24:39.441126 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m21:24:39.442145 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m21:24:39.443417 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m21:24:39.443876 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m21:24:39.444604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m21:24:39.445185 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_output, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m21:24:39.445510 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m21:24:39.445794 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m21:24:39.449249 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m21:24:39.453072 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m21:24:39.454519 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 21:24:39.445994 => 21:24:39.454248
[0m21:24:39.454893 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 21:24:39.449944 => 21:24:39.454745
[0m21:24:39.455732 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m21:24:39.456691 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m21:24:39.457183 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 21:24:39.457020 => 21:24:39.457030
[0m21:24:39.457541 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 21:24:39.457399 => 21:24:39.457404
[0m21:24:39.458347 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m21:24:39.459025 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m21:24:39.459957 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m21:24:39.460593 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m21:24:39.460892 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m21:24:39.463545 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m21:24:39.464329 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 21:24:39.461077 => 21:24:39.464090
[0m21:24:39.464613 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m21:24:39.464938 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 21:24:39.464793 => 21:24:39.464801
[0m21:24:39.465649 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m21:24:39.466372 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m21:24:39.467133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m21:24:39.467610 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m21:24:39.471133 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m21:24:39.471907 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 21:24:39.467824 => 21:24:39.471730
[0m21:24:39.472203 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m21:24:39.472543 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 21:24:39.472390 => 21:24:39.472398
[0m21:24:39.473244 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m21:24:39.474392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:39.474669 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m21:24:39.474903 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_normalized_location' was properly closed.
[0m21:24:39.475112 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_domain_observations' was properly closed.
[0m21:24:39.475307 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m21:24:39.477131 [debug] [MainThread]: Command end result
[0m21:24:39.485565 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m21:24:39.485955 [info ] [MainThread]: Building catalog
[0m21:24:39.488282 [debug] [ThreadPool]: Acquiring new snowflake connection 'DEV_QA.information_schema'
[0m21:24:39.495450 [debug] [ThreadPool]: Using snowflake connection "DEV_QA.information_schema"
[0m21:24:39.496734 [debug] [ThreadPool]: On DEV_QA.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "DEV_QA.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from DEV_QA.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from DEV_QA.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dbt_poc'))
      order by "column_index"
[0m21:24:39.497243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:43.409210 [debug] [ThreadPool]: SQL status: SUCCESS 52 in 4.0 seconds
[0m21:24:43.441060 [debug] [ThreadPool]: On DEV_QA.information_schema: Close
[0m21:24:43.589220 [info ] [MainThread]: Catalog written to /Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/target/catalog.json
[0m21:24:43.591150 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:24:43.590688 after 5.74 seconds
[0m21:24:43.591705 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:24:43.592013 [debug] [MainThread]: Connection 'DEV_QA.information_schema' was properly closed.
[0m21:24:43.592475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7893e8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7580d9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7786eafd0>]}
[0m21:24:43.592987 [debug] [MainThread]: Flushing usage events
[0m15:59:32.676124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc711463790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc711cffdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc711cfffa0>]}


============================== 15:59:32.680904 | 7871de39-1a52-41bd-90b2-ec1d1636bda8 ==============================
[0m15:59:32.680904 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:59:32.681547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:59:33.153189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7871de39-1a52-41bd-90b2-ec1d1636bda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc711cff6a0>]}
[0m15:59:33.165382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7871de39-1a52-41bd-90b2-ec1d1636bda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7381eba90>]}
[0m00:46:22.182204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b240b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b240fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b240f90>]}


============================== 00:46:22.189689 | 2baab3db-a8a8-43c5-a1ed-31168f30e154 ==============================
[0m00:46:22.189689 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:46:22.193073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:46:22.689882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2baab3db-a8a8-43c5-a1ed-31168f30e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1edf10>]}
[0m00:46:22.703220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2baab3db-a8a8-43c5-a1ed-31168f30e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f0ba10>]}
[0m00:46:22.720686 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:46:22.927403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:22.930167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:22.937625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2baab3db-a8a8-43c5-a1ed-31168f30e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b4d710>]}
[0m00:46:22.974663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2baab3db-a8a8-43c5-a1ed-31168f30e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b1e3d0>]}
[0m00:46:22.977224 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:46:22.980124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2baab3db-a8a8-43c5-a1ed-31168f30e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b1e5d0>]}
[0m00:46:22.983444 [info ] [MainThread]: 
[0m00:46:22.985924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:22.989126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:46:23.002106 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:46:23.005289 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:46:23.008205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:24.089147 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:46:24.094785 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:46:24.305201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m00:46:24.313340 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:46:24.316110 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:46:24.318347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:24.982565 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m00:46:24.988790 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:46:25.212631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2baab3db-a8a8-43c5-a1ed-31168f30e154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62981910>]}
[0m00:46:25.224269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:46:25.231728 [info ] [MainThread]: 
[0m00:46:25.249247 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:46:25.254347 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:46:25.260357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:46:25.263156 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:46:25.268332 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:46:25.281682 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:46:25.265666 => 00:46:25.281025
[0m00:46:25.284428 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:46:25.308157 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:46:25.323157 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:46:25.326815 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:46:25.329793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:50:10.152839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f52c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f52ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f52f90>]}


============================== 00:50:10.159909 | 60e1ee37-f996-4060-8b9b-945311a4f2f9 ==============================
[0m00:50:10.159909 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:50:10.164531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:50:10.651657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60e1ee37-f996-4060-8b9b-945311a4f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f12710>]}
[0m00:50:10.663648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60e1ee37-f996-4060-8b9b-945311a4f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a58750>]}
[0m00:50:10.676592 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:50:10.771663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:50:10.779094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:50:10.788126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60e1ee37-f996-4060-8b9b-945311a4f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8068b050>]}
[0m00:50:10.833880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60e1ee37-f996-4060-8b9b-945311a4f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8065c710>]}
[0m00:50:10.836624 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:50:10.839954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e1ee37-f996-4060-8b9b-945311a4f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8065ccd0>]}
[0m00:50:10.843161 [info ] [MainThread]: 
[0m00:50:10.846125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:50:10.849207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:50:10.860758 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:50:10.863124 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:50:10.865626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:11.970175 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:50:11.991244 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:50:12.224667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:50:12.236840 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:50:12.239874 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:50:12.242675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:50:12.697059 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:50:12.706427 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:50:12.930258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60e1ee37-f996-4060-8b9b-945311a4f2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78847310>]}
[0m00:50:12.934398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:50:12.943533 [info ] [MainThread]: 
[0m00:50:12.950876 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:50:12.953691 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:50:12.958400 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:50:12.960797 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:50:12.964824 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:50:12.982913 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:50:12.962782 => 00:50:12.982646
[0m00:50:12.984968 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:50:13.005663 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:50:13.019832 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:50:13.021786 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:50:13.024517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:11:28.964664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e83ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e83f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e83f90>]}


============================== 00:11:28.972155 | adc01a28-7b46-47b7-9e0b-ebc54a27159b ==============================
[0m00:11:28.972155 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:11:28.974993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:11:29.531501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adc01a28-7b46-47b7-9e0b-ebc54a27159b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e45610>]}
[0m00:11:29.543845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adc01a28-7b46-47b7-9e0b-ebc54a27159b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e3ecd0>]}
[0m00:11:29.556712 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:11:29.681301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:29.686882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:29.698067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adc01a28-7b46-47b7-9e0b-ebc54a27159b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa018dc50>]}
[0m00:11:29.755853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adc01a28-7b46-47b7-9e0b-ebc54a27159b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa015f250>]}
[0m00:11:29.758202 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:11:29.760373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc01a28-7b46-47b7-9e0b-ebc54a27159b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa015f550>]}
[0m00:11:29.764275 [info ] [MainThread]: 
[0m00:11:29.771410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:11:29.775222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:11:29.786608 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:11:29.789018 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:11:29.791614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:31.395352 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m00:11:31.400870 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:11:31.861363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:11:31.913982 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:11:31.916981 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:11:31.919244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:32.990026 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m00:11:32.997052 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:11:33.523876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc01a28-7b46-47b7-9e0b-ebc54a27159b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995edbd0>]}
[0m00:11:33.527552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:11:33.530455 [info ] [MainThread]: 
[0m00:11:33.539201 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:11:33.541741 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:11:33.544838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:11:33.547195 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:11:33.553247 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:11:33.582038 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:11:33.550161 => 00:11:33.581218
[0m00:11:33.584329 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:11:33.609336 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:11:33.624652 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:11:33.630744 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:11:33.638957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:30:33.459877 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1140.0 seconds
[0m00:30:33.523345 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:11:33.586376 => 00:30:33.522934
[0m00:30:33.527267 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:30:33.757047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc01a28-7b46-47b7-9e0b-ebc54a27159b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ff0390>]}
[0m00:30:33.775550 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 1140.21s]
[0m00:30:33.779065 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:30:33.825852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:33.828655 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:30:33.831978 [info ] [MainThread]: 
[0m00:30:33.836201 [info ] [MainThread]: Finished running 1 table model in 0 hours 19 minutes and 4.06 seconds (1144.06s).
[0m00:30:33.839459 [debug] [MainThread]: Command end result
[0m00:30:33.900432 [info ] [MainThread]: 
[0m00:30:33.903434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:30:33.905950 [info ] [MainThread]: 
[0m00:30:33.909588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:30:33.912881 [debug] [MainThread]: Command `dbt run` succeeded at 00:30:33.912780 after 67.36 seconds
[0m00:30:33.915647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e1d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e1ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e1fd90>]}
[0m00:30:33.918012 [debug] [MainThread]: Flushing usage events
[0m00:00:03.032300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a60da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a60df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a60ded0>]}


============================== 00:00:03.039572 | d8314646-7e03-4069-bd0e-3b5bde9469e2 ==============================
[0m00:00:03.039572 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:03.045339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:03.583053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8314646-7e03-4069-bd0e-3b5bde9469e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5a7290>]}
[0m00:00:03.595687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8314646-7e03-4069-bd0e-3b5bde9469e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d188890>]}
[0m00:00:03.607817 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:00:03.724043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:03.732204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:03.740477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8314646-7e03-4069-bd0e-3b5bde9469e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d4bed0>]}
[0m00:00:03.803243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8314646-7e03-4069-bd0e-3b5bde9469e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d1be50>]}
[0m00:00:03.805609 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:03.808626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8314646-7e03-4069-bd0e-3b5bde9469e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d1b490>]}
[0m00:00:03.811387 [info ] [MainThread]: 
[0m00:00:03.818273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:03.821054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:03.832699 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:03.835386 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:03.839447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.045044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:00:05.071090 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:00:05.314886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:00:05.338521 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:00:05.343029 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:00:05.346740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:05.794223 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:00:05.800529 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:00:06.045614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8314646-7e03-4069-bd0e-3b5bde9469e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88747c90>]}
[0m00:00:06.048653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:06.051991 [info ] [MainThread]: 
[0m00:00:06.076322 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:06.079634 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:00:06.087943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:00:06.092629 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:06.098658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:06.124108 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:00:06.096404 => 00:00:06.123881
[0m00:00:06.126708 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:06.160104 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:06.177549 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:06.182626 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:00:06.186382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:15.189031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 69.0 seconds
[0m00:01:15.244552 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:00:06.135086 => 00:01:15.244015
[0m00:01:15.248034 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:01:15.587864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8314646-7e03-4069-bd0e-3b5bde9469e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b27f50>]}
[0m00:01:15.591700 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 69.50s]
[0m00:01:15.596198 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:01:15.659855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:15.662650 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:01:15.668641 [info ] [MainThread]: 
[0m00:01:15.671175 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 11.85 seconds (71.85s).
[0m00:01:15.674597 [debug] [MainThread]: Command end result
[0m00:01:15.753872 [info ] [MainThread]: 
[0m00:01:15.758508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:15.762626 [info ] [MainThread]: 
[0m00:01:15.769687 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:01:15.774594 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:15.774438 after 72.77 seconds
[0m00:01:15.779138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5aad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5aaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5aab90>]}
[0m00:01:15.783109 [debug] [MainThread]: Flushing usage events
[0m00:01:20.001527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1549a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1549f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1549e50>]}


============================== 00:01:20.007995 | dfc48c26-7fa1-463f-9edc-0bd4b0c5d91a ==============================
[0m00:01:20.007995 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:01:20.011034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:01:20.468165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfc48c26-7fa1-463f-9edc-0bd4b0c5d91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90810150>]}
[0m00:01:20.479777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfc48c26-7fa1-463f-9edc-0bd4b0c5d91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa151e710>]}
[0m00:01:20.489456 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:01:20.562588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:20.565549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:20.572669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc48c26-7fa1-463f-9edc-0bd4b0c5d91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9015a610>]}
[0m00:01:20.617409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc48c26-7fa1-463f-9edc-0bd4b0c5d91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900ff250>]}
[0m00:01:20.637559 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:01:20.640598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc48c26-7fa1-463f-9edc-0bd4b0c5d91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900ffb10>]}
[0m00:01:20.644400 [info ] [MainThread]: 
[0m00:01:20.647996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:20.651441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m00:01:20.662313 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:01:20.664575 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:01:20.669521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:21.555946 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m00:01:21.567114 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:01:21.850987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc48c26-7fa1-463f-9edc-0bd4b0c5d91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880edbd0>]}
[0m00:01:21.855724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:21.858814 [info ] [MainThread]: 
[0m00:01:21.867151 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m00:01:21.869884 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_ipflow_input_data_user_ip ....................... [RUN]
[0m00:01:21.867540 [debug] [Thread-2  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m00:01:21.872403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11)
[0m00:01:21.875091 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_ipflow_input_data_user_ip ......................... [RUN]
[0m00:01:21.877880 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m00:01:21.880868 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095'
[0m00:01:21.893423 [debug] [Thread-2  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m00:01:21.892111 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m00:01:21.900707 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m00:01:21.930824 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (compile): 00:01:21.882711 => 00:01:21.930446
[0m00:01:21.931598 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (compile): 00:01:21.895754 => 00:01:21.931164
[0m00:01:21.934063 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m00:01:21.936441 [debug] [Thread-2  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m00:01:21.953157 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m00:01:21.957026 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m00:01:21.970663 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m00:01:21.978563 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_ip
from DEV_QA.DBT_POC.stg_ipflow_input_data
where user_ip is null



      
    ) dbt_internal_test
[0m00:01:21.980696 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m00:01:21.980991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:21.983179 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_ip as unique_field,
    count(*) as n_records

from DEV_QA.DBT_POC.stg_ipflow_input_data
where user_ip is not null
group by user_ip
having count(*) > 1



      
    ) dbt_internal_test
[0m00:01:21.996553 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:01:22.808453 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:22.835839 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (execute): 00:01:21.938412 => 00:01:22.835538
[0m00:01:22.841166 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11: Close
[0m00:01:23.057750 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_ipflow_input_data_user_ip ............................. [[32mPASS[0m in 1.19s]
[0m00:01:23.067743 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m00:01:23.381032 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:23.405220 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (execute): 00:01:21.954753 => 00:01:23.404708
[0m00:01:23.412715 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095: Close
[0m00:01:23.632542 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_ipflow_input_data_user_ip ............................... [[32mPASS[0m in 1.75s]
[0m00:01:23.635574 [debug] [Thread-2  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m00:01:23.721795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:23.724587 [debug] [MainThread]: Connection 'test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11' was properly closed.
[0m00:01:23.727438 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095' was properly closed.
[0m00:01:23.730477 [info ] [MainThread]: 
[0m00:01:23.733257 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m00:01:23.740092 [debug] [MainThread]: Command end result
[0m00:01:23.796216 [info ] [MainThread]: 
[0m00:01:23.801673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:23.804083 [info ] [MainThread]: 
[0m00:01:23.806703 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:01:23.809948 [debug] [MainThread]: Command `dbt test` succeeded at 00:01:23.809867 after 3.83 seconds
[0m00:01:23.816045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91325b90>]}
[0m00:01:23.818459 [debug] [MainThread]: Flushing usage events
[0m00:01:31.129572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64dbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64b10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64dbf50>]}


============================== 00:01:31.136165 | 09b1b841-26be-4793-9c6f-002cc84859ff ==============================
[0m00:01:31.136165 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:01:31.142643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:01:31.259792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6180a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6180f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6180f10>]}


============================== 00:01:31.268729 | 95db3347-6bd9-4f3b-8c99-d38efd11b6ee ==============================
[0m00:01:31.268729 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:01:31.273800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:01:31.685128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6478e90>]}
[0m00:01:31.697241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9045ed0>]}
[0m00:01:31.707850 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:01:31.783039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:31.785848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:31.793418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c7fdd0>]}
[0m00:01:31.860465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947df150>]}
[0m00:01:31.866101 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:01:31.868998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947df450>]}
[0m00:01:31.872478 [info ] [MainThread]: 
[0m00:01:31.875037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:31.883839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:01:31.875094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6143610>]}
[0m00:01:31.896615 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:01:31.899916 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:01:31.897782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6139710>]}
[0m00:01:31.903753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:31.917058 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:01:31.975592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:31.977997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:31.985227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4920b10>]}
[0m00:01:32.057868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4889750>]}
[0m00:01:32.063769 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:01:32.070233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ab1810>]}
[0m00:01:32.074485 [info ] [MainThread]: 
[0m00:01:32.096075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:32.101670 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:01:32.119131 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:01:32.122623 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:01:32.125795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:32.463601 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:01:32.468619 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:01:32.698902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:01:32.755539 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:01:32.758737 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:01:32.761529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:32.880716 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:01:32.885401 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:01:33.126994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:01:33.192032 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:01:33.197833 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:01:33.198221 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:01:33.202803 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:01:33.205799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:33.424197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940ca790>]}
[0m00:01:33.429822 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:33.433351 [info ] [MainThread]: 
[0m00:01:33.447087 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:33.450463 [info ] [Thread-1  ]: 1 of 9 START sql table model DBT_POC.stg_ipflow_success_data ................... [RUN]
[0m00:01:33.453454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_success_data)
[0m00:01:33.456441 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:33.466513 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:01:33.478862 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 00:01:33.463758 => 00:01:33.478216
[0m00:01:33.488475 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:33.527918 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:01:33.542021 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:01:33.544937 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m00:01:33.547393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:33.622746 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:01:33.628675 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:01:33.831607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42c9a10>]}
[0m00:01:33.835104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:33.856024 [info ] [MainThread]: 
[0m00:01:33.869761 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:01:33.870700 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:33.874891 [info ] [Thread-1  ]: 1 of 11 START sql table model DBT_POC.src_ipflow_merge_output .................. [RUN]
[0m00:01:33.878471 [info ] [Thread-2  ]: 2 of 11 START sql table model DBT_POC.stg_ipflow_success_data .................. [RUN]
[0m00:01:33.881480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m00:01:33.883984 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m00:01:33.887011 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:01:33.892149 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:33.897832 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:01:33.902179 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:01:33.916637 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 00:01:33.895593 => 00:01:33.916250
[0m00:01:33.917094 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 00:01:33.900391 => 00:01:33.916944
[0m00:01:33.919012 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:01:33.926646 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:33.949631 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:01:33.952307 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:01:33.963925 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m00:01:33.964527 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m00:01:33.966648 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m00:01:33.968776 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m00:01:33.971075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:33.973600 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:01:34.665807 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:34.706124 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 00:01:33.491840 => 00:01:34.705908
[0m00:01:34.714033 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m00:01:34.949999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947fdcd0>]}
[0m00:01:34.953809 [info ] [Thread-1  ]: 1 of 9 OK created sql table model DBT_POC.stg_ipflow_success_data .............. [[32mSUCCESS 1[0m in 1.50s]
[0m00:01:34.957024 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:34.964661 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:34.965440 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:34.965167 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:34.967515 [info ] [Thread-3  ]: 2 of 9 START sql table model DBT_POC.src_ipflow_merge_domain_observations ...... [RUN]
[0m00:01:34.981453 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m00:01:34.972143 [info ] [Thread-4  ]: 3 of 9 START sql table model DBT_POC.src_ipflow_merge_success_output ........... [RUN]
[0m00:01:34.988050 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m00:01:34.985107 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:34.990810 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:34.992036 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 00:01:33.950353 => 00:01:34.991853
[0m00:01:34.999607 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m00:01:34.997677 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:01:35.003832 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:01:35.012763 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 00:01:34.994681 => 00:01:35.012249
[0m00:01:35.015542 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 00:01:34.998732 => 00:01:35.015156
[0m00:01:35.016776 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:35.018914 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:35.022870 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:01:35.026972 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:01:35.054262 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:01:35.056768 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:01:35.063450 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m00:01:35.057749 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m00:01:35.067914 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:01:35.070194 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:01:35.212070 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbbc990>]}
[0m00:01:35.216733 [info ] [Thread-2  ]: 2 of 11 OK created sql table model DBT_POC.stg_ipflow_success_data ............. [[32mSUCCESS 1[0m in 1.33s]
[0m00:01:35.220592 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m00:01:35.224083 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:35.224794 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:35.226586 [info ] [Thread-4  ]: 3 of 11 START sql table model DBT_POC.src_ipflow_merge_domain_observations ..... [RUN]
[0m00:01:35.230050 [info ] [Thread-3  ]: 4 of 11 START sql table model DBT_POC.src_ipflow_merge_success_output .......... [RUN]
[0m00:01:35.233187 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m00:01:35.236473 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m00:01:35.238744 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:35.241390 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:35.245767 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:01:35.251176 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:01:35.259454 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 00:01:35.243446 => 00:01:35.259194
[0m00:01:35.278793 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 00:01:35.249363 => 00:01:35.278651
[0m00:01:35.279725 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:35.287186 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:01:35.282412 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:35.293875 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:01:35.296232 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m00:01:35.299933 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:35.302177 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m00:01:35.306148 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 00:01:33.928263 => 00:01:35.306004
[0m00:01:35.306934 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m00:01:35.308410 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m00:01:35.314782 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m00:01:35.317422 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m00:01:35.330427 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:01:35.575405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c261790>]}
[0m00:01:35.581707 [info ] [Thread-1  ]: 1 of 11 OK created sql table model DBT_POC.src_ipflow_merge_output ............. [[32mSUCCESS 1[0m in 1.69s]
[0m00:01:35.586730 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m00:01:35.591116 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:01:35.594809 [info ] [Thread-2  ]: 5 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_output ............ [RUN]
[0m00:01:35.598668 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_output)
[0m00:01:35.607578 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:01:35.618702 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:35.648236 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 00:01:35.609985 => 00:01:35.647805
[0m00:01:35.651542 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:01:35.682382 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:35.684990 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:01:35.687959 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:01:35.914540 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:35.921089 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 00:01:35.020592 => 00:01:35.920920
[0m00:01:35.923736 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m00:01:35.929947 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:35.936727 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 00:01:35.024712 => 00:01:35.936602
[0m00:01:35.938880 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m00:01:36.069876 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:36.075476 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 00:01:35.285078 => 00:01:36.075333
[0m00:01:36.078415 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m00:01:36.121557 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:36.126645 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 00:01:35.291828 => 00:01:36.126538
[0m00:01:36.128629 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m00:01:36.154411 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5e04d0>]}
[0m00:01:36.157206 [info ] [Thread-3  ]: 2 of 9 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations . [[32mSUCCESS 1[0m in 1.17s]
[0m00:01:36.160316 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c572490>]}
[0m00:01:36.163996 [info ] [Thread-4  ]: 3 of 9 OK created sql table model DBT_POC.src_ipflow_merge_success_output ...... [[32mSUCCESS 1[0m in 1.17s]
[0m00:01:36.160995 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:36.167413 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:36.171363 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:36.175869 [info ] [Thread-1  ]: 4 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m00:01:36.174161 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:36.178692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m00:01:36.185130 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:36.181888 [info ] [Thread-3  ]: 5 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_success_output ..... [RUN]
[0m00:01:36.211512 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:36.212416 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:36.214451 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m00:01:36.219665 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:36.222903 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 00:01:36.205158 => 00:01:36.222692
[0m00:01:36.223791 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:36.225881 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:36.229728 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m00:01:36.228480 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:36.246599 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 00:01:36.223092 => 00:01:36.246385
[0m00:01:36.260737 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:36.277712 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:36.280531 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cab5950>]}
[0m00:01:36.280507 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:01:36.289656 [info ] [Thread-4  ]: 3 of 11 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 1.05s]
[0m00:01:36.278695 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:36.295671 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m00:01:36.291180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:36.301886 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:36.305668 [info ] [Thread-1  ]: 6 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m00:01:36.309912 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m00:01:36.297829 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:01:36.312961 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:36.314211 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:01:36.319754 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:36.330842 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 00:01:36.316433 => 00:01:36.330625
[0m00:01:36.333502 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:36.338579 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:36.358120 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:01:36.359189 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:36.360976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:36.365998 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:36.366719 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c24cb10>]}
[0m00:01:36.379928 [info ] [Thread-3  ]: 4 of 11 OK created sql table model DBT_POC.src_ipflow_merge_success_output ..... [[32mSUCCESS 1[0m in 1.13s]
[0m00:01:36.374073 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m00:01:36.383916 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m00:01:36.390661 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:36.397598 [info ] [Thread-4  ]: 7 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_success_output .... [RUN]
[0m00:01:36.400185 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m00:01:36.403002 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:36.409713 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:36.422702 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 00:01:36.405908 => 00:01:36.422531
[0m00:01:36.425425 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:36.432814 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:36.435509 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:01:36.438066 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:01:36.505583 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:36.514184 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:36.521812 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m00:01:36.646380 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:36.670017 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:36.697884 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:36.701202 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:36.836926 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:36.843435 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:36.846202 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:01:36.890805 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:36.900902 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:36.907830 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m00:01:36.965158 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:36.970656 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:36.978572 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m00:01:37.036714 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:37.041715 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.044856 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:01:37.046134 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m00:01:37.050837 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.053208 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m00:01:37.068498 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:37.073137 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.075545 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m00:01:37.109304 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:37.114870 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.118790 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m00:01:37.154596 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:01:37.158739 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:01:37.164162 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.163176 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.182860 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m00:01:37.184045 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m00:01:37.196606 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:37.201176 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.203655 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m00:01:37.245671 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:37.254142 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.256782 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m00:01:37.305298 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:01:37.309224 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:01:37.311141 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.316751 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m00:01:37.319647 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:37.325130 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.332689 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m00:01:37.336425 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.346955 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.349931 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:37.356871 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:37.361840 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.369651 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.371865 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:37.485598 [debug] [Thread-4  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:37.487228 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m00:01:37.492376 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.497653 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.525773 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.528017 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:37.530938 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.529017 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.529520 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:37.533141 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:37.536918 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:37.535897 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m00:01:37.539684 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.549230 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:01:37.664127 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:37.667654 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:37.670605 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m00:01:37.681149 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:37.683965 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:37.686711 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m00:01:38.120201 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:38.127629 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:38.132776 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m00:01:38.528665 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:38.528652 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:01:38.537699 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m00:01:38.540233 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:38.543843 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m00:01:38.540982 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m00:01:38.708635 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:38.713160 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 00:01:35.655110 => 00:01:38.713030
[0m00:01:38.715597 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m00:01:38.767534 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:38.776227 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:38.781949 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m00:01:38.928423 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:01:38.930614 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:38.931410 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:38.935660 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 00:01:36.270090 => 00:01:38.935533
[0m00:01:38.937744 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m00:01:38.945126 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m00:01:38.948560 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c27eb50>]}
[0m00:01:38.953181 [info ] [Thread-2  ]: 5 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ....... [[32mSUCCESS 1[0m in 3.35s]
[0m00:01:38.956423 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m00:01:38.969086 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m00:01:38.971995 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:38.974734 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m00:01:39.133580 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:39.140693 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:39.143654 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m00:01:39.500033 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4f3fd0>]}
[0m00:01:39.505088 [info ] [Thread-3  ]: 5 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 3.29s]
[0m00:01:39.509559 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:39.517756 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:39.527706 [info ] [Thread-4  ]: 6 of 9 START sql table model DBT_POC.src_ipflow_normalized_location ............ [RUN]
[0m00:01:39.532625 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m00:01:39.571174 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:39.580254 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:01:39.589952 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:39.599186 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 00:01:39.576571 => 00:01:39.598749
[0m00:01:39.606821 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:39.613168 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:01:39.602738 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 00:01:36.240256 => 00:01:39.602471
[0m00:01:39.625482 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m00:01:39.639567 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:01:39.643133 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m00:01:39.646861 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:01:39.671834 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:39.681839 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m00:01:39.684876 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m00:01:39.838833 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:39.845651 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 00:01:36.429967 => 00:01:39.845389
[0m00:01:39.851223 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m00:01:39.841384 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2.0 seconds
[0m00:01:39.879054 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4646d0>]}
[0m00:01:39.884605 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:39.891010 [info ] [Thread-1  ]: 4 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 3.70s]
[0m00:01:39.896780 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:39.900841 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:39.893057 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m00:01:39.908195 [info ] [Thread-3  ]: 7 of 9 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m00:01:39.913888 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m00:01:39.916632 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:39.924659 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:01:39.956149 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 00:01:39.920182 => 00:01:39.954981
[0m00:01:39.960784 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:39.970887 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:01:39.987518 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:01:39.991381 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m00:01:39.995539 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:01:40.091840 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c267ad0>]}
[0m00:01:40.107515 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:40.118122 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m00:01:40.110598 [info ] [Thread-4  ]: 7 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 3.69s]
[0m00:01:40.128922 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m00:01:40.124946 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m00:01:40.132536 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:40.159420 [info ] [Thread-3  ]: 8 of 11 START sql table model DBT_POC.src_ipflow_normalized_location ........... [RUN]
[0m00:01:40.163258 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m00:01:40.167220 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:40.178129 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:01:40.196804 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 00:01:40.172856 => 00:01:40.196514
[0m00:01:40.199881 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:40.206261 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:01:40.222618 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m00:01:40.224991 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m00:01:40.228496 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:01:40.294693 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:40.300195 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 00:01:36.335013 => 00:01:40.300055
[0m00:01:40.304128 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m00:01:40.541417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa48dcfd0>]}
[0m00:01:40.564217 [info ] [Thread-1  ]: 6 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 4.23s]
[0m00:01:40.568068 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m00:01:40.575681 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:40.578145 [info ] [Thread-4  ]: 9 of 11 START sql table model DBT_POC.fact_ip_to_company_domain ................ [RUN]
[0m00:01:40.581122 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m00:01:40.583778 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:40.591871 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:01:40.598508 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 00:01:40.589079 => 00:01:40.598163
[0m00:01:40.600906 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:40.611195 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:01:40.619143 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m00:01:40.627002 [debug] [Thread-4  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m00:01:40.629918 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:01:41.493325 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:41.499232 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 00:01:39.966665 => 00:01:41.499096
[0m00:01:41.502568 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m00:01:41.604043 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:41.609164 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 00:01:40.608550 => 00:01:41.609042
[0m00:01:41.615729 [debug] [Thread-4  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m00:01:41.697955 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:41.707951 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 00:01:40.203659 => 00:01:41.707839
[0m00:01:41.710561 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m00:01:41.721931 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940f3790>]}
[0m00:01:41.725195 [info ] [Thread-3  ]: 7 of 9 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 1.81s]
[0m00:01:41.731540 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:41.749576 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:01:41.754892 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 00:01:39.609606 => 00:01:41.754765
[0m00:01:41.757708 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m00:01:41.836139 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1c9e50>]}
[0m00:01:41.839787 [info ] [Thread-4  ]: 9 of 11 OK created sql table model DBT_POC.fact_ip_to_company_domain ........... [[32mSUCCESS 1[0m in 1.26s]
[0m00:01:41.844808 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m00:01:41.923954 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0d61d0>]}
[0m00:01:41.928757 [info ] [Thread-3  ]: 8 of 11 OK created sql table model DBT_POC.src_ipflow_normalized_location ...... [[32mSUCCESS 1[0m in 1.76s]
[0m00:01:41.931529 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:41.952197 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:41.954787 [info ] [Thread-1  ]: 10 of 11 START sql table model DBT_POC.src_ipflow_ip_to_location ............... [RUN]
[0m00:01:41.957803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m00:01:41.960444 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4e0e10>]}
[0m00:01:41.960821 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:41.962836 [info ] [Thread-4  ]: 6 of 9 OK created sql table model DBT_POC.src_ipflow_normalized_location ....... [[32mSUCCESS 1[0m in 2.43s]
[0m00:01:41.967904 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m00:01:41.969622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:01:41.972977 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:41.976869 [info ] [Thread-2  ]: 8 of 9 START sql table model DBT_POC.src_ipflow_ip_to_location ................. [RUN]
[0m00:01:41.979329 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 00:01:41.965495 => 00:01:41.979114
[0m00:01:41.980754 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_ip_to_location'
[0m00:01:41.988680 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:41.986539 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:41.993559 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:01:41.994212 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:01:42.008049 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:01:42.009239 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 00:01:41.990568 => 00:01:42.009054
[0m00:01:42.012708 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:42.010749 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m00:01:42.025849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:42.020402 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:01:42.035877 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m00:01:42.038574 [debug] [Thread-2  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m00:01:42.041893 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:01:43.133560 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:43.143649 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 00:01:41.991362 => 00:01:43.143323
[0m00:01:43.155487 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m00:01:43.180054 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:43.186529 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 00:01:42.017449 => 00:01:43.186330
[0m00:01:43.189596 [debug] [Thread-2  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m00:01:43.366168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c27e210>]}
[0m00:01:43.369868 [info ] [Thread-1  ]: 10 of 11 OK created sql table model DBT_POC.src_ipflow_ip_to_location .......... [[32mSUCCESS 1[0m in 1.41s]
[0m00:01:43.373033 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:43.381175 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:43.383699 [info ] [Thread-4  ]: 11 of 11 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [RUN]
[0m00:01:43.386630 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m00:01:43.388809 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:43.395101 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:43.405505 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 00:01:43.391709 => 00:01:43.405308
[0m00:01:43.407862 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:43.410111 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce22ed0>]}
[0m00:01:43.413774 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:43.415007 [info ] [Thread-2  ]: 8 of 9 OK created sql table model DBT_POC.src_ipflow_ip_to_location ............ [[32mSUCCESS 1[0m in 1.43s]
[0m00:01:43.416601 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:01:43.419890 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m00:01:43.423056 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m00:01:43.425684 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:43.428596 [info ] [Thread-3  ]: 9 of 9 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings .. [RUN]
[0m00:01:43.450229 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m00:01:43.453833 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:43.459940 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:43.467033 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 00:01:43.456635 => 00:01:43.466875
[0m00:01:43.469601 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:43.477527 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:43.480564 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m00:01:43.482854 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m00:01:43.968711 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:43.975922 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:01:43.975167 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:43.980218 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:43.980996 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m00:01:43.983192 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m00:01:44.095582 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:01:44.095652 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:01:44.102453 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.105587 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m00:01:44.103002 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.111040 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m00:01:44.224569 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:01:44.230429 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.232245 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:01:44.233029 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m00:01:44.238461 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.260860 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m00:01:44.350594 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:01:44.358631 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:01:44.364776 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.366754 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.381442 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.384615 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:44.385597 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.391004 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m00:01:44.564868 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:44.568946 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.573475 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m00:01:44.569107 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:44.587738 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:44.591856 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m00:01:45.591556 [debug] [Thread-4  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m00:01:45.595789 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:45.598070 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m00:01:46.000047 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:46.009061 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:46.011974 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m00:01:46.153112 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:46.158063 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 00:01:43.410167 => 00:01:46.157925
[0m00:01:46.160801 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m00:01:46.396963 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95db3347-6bd9-4f3b-8c99-d38efd11b6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1777d0>]}
[0m00:01:46.404756 [info ] [Thread-4  ]: 11 of 11 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 2[0m in 3.01s]
[0m00:01:46.409154 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:46.445667 [debug] [Thread-3  ]: SQL status: SUCCESS 2 in 2.0 seconds
[0m00:01:46.449061 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:46.452091 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m00:01:46.453534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:46.457403 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m00:01:46.459781 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_output' was properly closed.
[0m00:01:46.462331 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m00:01:46.465499 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_normalized_location' was properly closed.
[0m00:01:46.467959 [info ] [MainThread]: 
[0m00:01:46.470800 [info ] [MainThread]: Finished running 7 table models, 4 incremental models in 0 hours 0 minutes and 14.37 seconds (14.37s).
[0m00:01:46.474785 [debug] [MainThread]: Command end result
[0m00:01:46.535756 [info ] [MainThread]: 
[0m00:01:46.538728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:46.540989 [info ] [MainThread]: 
[0m00:01:46.543752 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m00:01:46.547057 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:46.546954 after 15.35 seconds
[0m00:01:46.567786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb611b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb612ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb612efd0>]}
[0m00:01:46.570319 [debug] [MainThread]: Flushing usage events
[0m00:01:46.749194 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:46.761717 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m00:01:46.765795 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m00:01:46.903260 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:01:46.913533 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 00:01:43.474513 => 00:01:46.913352
[0m00:01:46.916566 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m00:01:47.145861 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b1b841-26be-4793-9c6f-002cc84859ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4722d0>]}
[0m00:01:47.162431 [info ] [Thread-3  ]: 9 of 9 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 2[0m in 3.70s]
[0m00:01:47.166061 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m00:01:47.235247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:47.239949 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_domain_observations' was properly closed.
[0m00:01:47.242792 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m00:01:47.245107 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_normalized_location' was properly closed.
[0m00:01:47.247906 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m00:01:47.250721 [info ] [MainThread]: 
[0m00:01:47.253867 [info ] [MainThread]: Finished running 6 table models, 3 incremental models in 0 hours 0 minutes and 15.38 seconds (15.38s).
[0m00:01:47.258991 [debug] [MainThread]: Command end result
[0m00:01:47.329110 [info ] [MainThread]: 
[0m00:01:47.332384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:47.335440 [info ] [MainThread]: 
[0m00:01:47.337796 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m00:01:47.341141 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:47.341012 after 16.24 seconds
[0m00:01:47.343868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6475390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6475350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6475410>]}
[0m00:01:47.346151 [debug] [MainThread]: Flushing usage events
[0m00:25:12.786891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c520ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c520f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c520ed0>]}


============================== 00:25:12.794140 | b2b472ed-ddc4-4474-b4c3-fe3d60924c6a ==============================
[0m00:25:12.794140 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:25:12.798881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:25:13.278830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2b472ed-ddc4-4474-b4c3-fe3d60924c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4e15d0>]}
[0m00:25:13.297725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2b472ed-ddc4-4474-b4c3-fe3d60924c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dbde90>]}
[0m00:25:13.310083 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:25:13.414473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:25:13.418808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:25:13.429119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2b472ed-ddc4-4474-b4c3-fe3d60924c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a71110>]}
[0m00:25:13.502272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2b472ed-ddc4-4474-b4c3-fe3d60924c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ddee50>]}
[0m00:25:13.504895 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:25:13.508648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2b472ed-ddc4-4474-b4c3-fe3d60924c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ddea10>]}
[0m00:25:13.511619 [info ] [MainThread]: 
[0m00:25:13.514558 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:25:13.520549 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:25:13.533593 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:25:13.536032 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:25:13.538826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:32.977345 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 10399.0 seconds
[0m03:18:32.995036 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m03:18:33.239390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m03:18:33.257601 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m03:18:33.260859 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m03:18:33.263873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:33.664072 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m03:18:33.668683 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m03:18:33.876555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2b472ed-ddc4-4474-b4c3-fe3d60924c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a90750>]}
[0m03:18:33.908257 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:18:33.911577 [info ] [MainThread]: 
[0m03:18:33.921633 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m03:18:33.924782 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m03:18:33.927972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m03:18:33.930957 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m03:18:33.938661 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m03:18:33.957339 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 03:18:33.935904 => 03:18:33.956926
[0m03:18:33.960008 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m03:18:33.989309 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m03:18:34.011501 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m03:18:34.013791 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m03:18:34.017119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:20.485874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f14d0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21067fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2106c7070>]}


============================== 14:27:20.491867 | 3108bda0-8ef8-40c0-be2e-6401fdf1554a ==============================
[0m14:27:20.491867 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:27:20.492446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:27:20.813622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21067f160>]}
[0m14:27:20.825819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd220d4db50>]}
[0m14:27:20.848285 [debug] [MainThread]: checksum: 49e139483dadcd05e2451e3e64d06671cb5623b1d6f0e13685681912273c51f9, vars: {'env': 'DEV'}, profile: , target: , version: 1.5.1
[0m14:27:20.858994 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:27:20.859503 [debug] [MainThread]: previous checksum: 49e139483dadcd05e2451e3e64d06671cb5623b1d6f0e13685681912273c51f9, current checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c
[0m14:27:20.859796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd220d5d280>]}
[0m14:27:21.394076 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m14:27:21.408832 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m14:27:21.411480 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m14:27:21.414878 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m14:27:21.417872 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m14:27:21.422487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m14:27:21.423951 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m14:27:21.427186 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m14:27:21.430157 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m14:27:21.434272 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m14:27:21.435860 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m14:27:21.440621 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m14:27:21.442434 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m14:27:21.445509 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m14:27:21.449154 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m14:27:21.450663 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m14:27:21.454395 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m14:27:21.516445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f1cf50d0>]}
[0m14:27:21.523658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f1cf7430>]}
[0m14:27:21.524150 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:27:21.524465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f1d09910>]}
[0m14:27:21.525727 [info ] [MainThread]: 
[0m14:27:21.526476 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:21.527392 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m14:27:21.539245 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m14:27:21.539832 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m14:27:21.540329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:23.132690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m14:27:23.134702 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m14:27:23.268836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m14:27:23.274142 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m14:27:23.274408 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m14:27:23.274617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:23.647223 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m14:27:23.649808 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m14:27:23.785190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f1cfb310>]}
[0m14:27:23.786110 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:23.786484 [info ] [MainThread]: 
[0m14:27:23.792159 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:27:23.792720 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.src_ipflow_merge_output ................... [RUN]
[0m14:27:23.793366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m14:27:23.793685 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:27:23.796149 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:27:23.798402 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 14:27:23.793877 => 14:27:23.798116
[0m14:27:23.798762 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:27:23.826292 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:27:23.832052 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:27:23.833850 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m14:27:23.834624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:25.182710 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:27:25.203363 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 14:27:23.798959 => 14:27:25.203132
[0m14:27:25.203911 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m14:27:25.325051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3108bda0-8ef8-40c0-be2e-6401fdf1554a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f1f4b8e0>]}
[0m14:27:25.326168 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.src_ipflow_merge_output .............. [[32mSUCCESS 1[0m in 1.53s]
[0m14:27:25.326786 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:27:25.329122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:25.329480 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_merge_output' was properly closed.
[0m14:27:25.329762 [info ] [MainThread]: 
[0m14:27:25.330092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m14:27:25.330657 [debug] [MainThread]: Command end result
[0m14:27:25.339335 [info ] [MainThread]: 
[0m14:27:25.339850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:25.340140 [info ] [MainThread]: 
[0m14:27:25.340445 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:25.341005 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:25.340918 after 4.90 seconds
[0m14:27:25.341313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f14d0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2109b5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f1ce7f10>]}
[0m14:27:25.341621 [debug] [MainThread]: Flushing usage events
[0m14:29:08.356169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b0f003d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d090ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d090aeb0>]}


============================== 14:29:08.361180 | 70fcba7f-7b4a-4625-b6e9-ecb06285e016 ==============================
[0m14:29:08.361180 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:29:08.361729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:29:08.598958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d08f87c0>]}
[0m14:29:08.610215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b1e4d9d0>]}
[0m14:29:08.627904 [debug] [MainThread]: checksum: bab420a134071147bb4c58f19adf4a051912827acbb77db45545f788e4842505, vars: {'env': 'DEV'}, profile: , target: dev, version: 1.5.1
[0m14:29:08.636305 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:29:08.636741 [debug] [MainThread]: previous checksum: bab420a134071147bb4c58f19adf4a051912827acbb77db45545f788e4842505, current checksum: 49e139483dadcd05e2451e3e64d06671cb5623b1d6f0e13685681912273c51f9
[0m14:29:08.637242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d090aeb0>]}
[0m14:29:09.167336 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m14:29:09.180829 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m14:29:09.182797 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m14:29:09.186037 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m14:29:09.189246 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m14:29:09.193775 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m14:29:09.195145 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m14:29:09.197794 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m14:29:09.200652 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m14:29:09.204428 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m14:29:09.205784 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m14:29:09.209587 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m14:29:09.211116 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m14:29:09.213797 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m14:29:09.217792 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m14:29:09.219370 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m14:29:09.222116 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m14:29:09.279975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b8b7c0d0>]}
[0m14:29:09.285581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b1e70af0>]}
[0m14:29:09.285938 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:29:09.286251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b1e70b50>]}
[0m14:29:09.287392 [info ] [MainThread]: 
[0m14:29:09.288223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:29:09.289141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m14:29:09.299788 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m14:29:09.300211 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m14:29:09.300455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:10.026947 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:29:10.031695 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m14:29:10.162227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m14:29:10.170344 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m14:29:10.170848 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m14:29:10.171142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:10.734095 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m14:29:10.735675 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m14:29:10.857778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b1ed3160>]}
[0m14:29:10.858559 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:10.858894 [info ] [MainThread]: 
[0m14:29:10.865228 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:29:10.865817 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.src_ipflow_merge_output ................... [RUN]
[0m14:29:10.866444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m14:29:10.866754 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:29:10.869265 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:29:10.871130 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 14:29:10.866938 => 14:29:10.870883
[0m14:29:10.871457 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:29:10.896787 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:29:10.898512 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:29:10.898932 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m14:29:10.899229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:11.951695 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:29:11.970157 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 14:29:10.871642 => 14:29:11.969958
[0m14:29:11.970627 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m14:29:12.095122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fcba7f-7b4a-4625-b6e9-ecb06285e016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b21dd790>]}
[0m14:29:12.096020 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.src_ipflow_merge_output .............. [[32mSUCCESS 1[0m in 1.23s]
[0m14:29:12.096650 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:29:12.098449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:12.098808 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_merge_output' was properly closed.
[0m14:29:12.099064 [info ] [MainThread]: 
[0m14:29:12.099384 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m14:29:12.099946 [debug] [MainThread]: Command end result
[0m14:29:12.110547 [info ] [MainThread]: 
[0m14:29:12.111205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:12.111541 [info ] [MainThread]: 
[0m14:29:12.111870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:29:12.112426 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:12.112343 after 3.80 seconds
[0m14:29:12.112728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b0f003d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b2307fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b8b28160>]}
[0m14:29:12.113045 [debug] [MainThread]: Flushing usage events
[0m14:32:29.228919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3412fb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa341917e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa341917fd0>]}


============================== 14:32:29.233439 | 6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb ==============================
[0m14:32:29.233439 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:32:29.234119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:32:29.484501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa341917760>]}
[0m14:32:29.496071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa33092eaf0>]}
[0m14:32:29.514601 [debug] [MainThread]: checksum: bab420a134071147bb4c58f19adf4a051912827acbb77db45545f788e4842505, vars: {'env': 'DEV'}, profile: , target: dev, version: 1.5.1
[0m14:32:29.548381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:32:29.548767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:32:29.554963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa330983e80>]}
[0m14:32:29.561739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320b34df0>]}
[0m14:32:29.562311 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:32:29.562683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320b34e80>]}
[0m14:32:29.564102 [info ] [MainThread]: 
[0m14:32:29.565008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:29.566214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m14:32:29.578041 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m14:32:29.578474 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m14:32:29.578731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:30.283103 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:32:30.287230 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m14:32:30.421882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m14:32:30.435397 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m14:32:30.435914 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m14:32:30.436307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:30.824041 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:32:30.828604 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m14:32:30.959265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320b34a60>]}
[0m14:32:30.961033 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:30.961858 [info ] [MainThread]: 
[0m14:32:30.971711 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:32:30.972784 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.src_ipflow_merge_output ................... [RUN]
[0m14:32:30.973867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m14:32:30.974418 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:32:30.978742 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:32:30.980657 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 14:32:30.974772 => 14:32:30.980363
[0m14:32:30.981116 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:32:31.012652 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:32:31.014576 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m14:32:31.014911 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m14:32:31.015211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:32:31.945960 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:32:31.978043 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 14:32:30.981396 => 14:32:31.977783
[0m14:32:31.978579 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m14:32:32.093487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e94acf4-6ca5-43f7-b8fd-f5aac2a9b5cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa330c45fd0>]}
[0m14:32:32.095526 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.src_ipflow_merge_output .............. [[32mSUCCESS 1[0m in 1.12s]
[0m14:32:32.096872 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m14:32:32.100788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:32.101482 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_merge_output' was properly closed.
[0m14:32:32.102057 [info ] [MainThread]: 
[0m14:32:32.102822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m14:32:32.103941 [debug] [MainThread]: Command end result
[0m14:32:32.114305 [info ] [MainThread]: 
[0m14:32:32.115233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:32.115860 [info ] [MainThread]: 
[0m14:32:32.116370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:32:32.117285 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:32.117158 after 2.93 seconds
[0m14:32:32.117697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3412fb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa320c85f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa341917fd0>]}
[0m14:32:32.118100 [debug] [MainThread]: Flushing usage events
[0m18:57:26.946050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e3ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e3ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e3ef90>]}


============================== 18:57:26.953240 | a8126807-2a65-483e-995d-9649e1d0977e ==============================
[0m18:57:26.953240 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:57:26.962637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:57:26.970417 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_dsg_app' does not have a target named 'DEV'. The valid target names for this profile are:
   - dev
[0m18:57:26.977080 [debug] [MainThread]: Command `dbt run` failed at 18:57:26.976955 after 0.06 seconds
[0m18:57:26.979341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2debd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2debf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2debf10>]}
[0m18:57:26.982005 [debug] [MainThread]: Flushing usage events
[0m18:58:36.174145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4bcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4bcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4bcf90>]}


============================== 18:58:36.193319 | 3d3fdff9-0706-41bf-be4b-bee151c74a01 ==============================
[0m18:58:36.193319 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:58:36.200660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:58:37.273300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d5f1e90>]}
[0m18:58:37.320631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c515090>]}
[0m18:58:37.346092 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m18:58:37.458101 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:58:37.470982 [debug] [MainThread]: previous checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, current checksum: bab420a134071147bb4c58f19adf4a051912827acbb77db45545f788e4842505
[0m18:58:37.480097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63cdc210>]}
[0m18:58:39.459518 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m18:58:39.524416 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m18:58:39.535720 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m18:58:39.543716 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m18:58:39.559818 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m18:58:39.567276 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m18:58:39.591771 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m18:58:39.607789 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m18:58:39.618689 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m18:58:39.847172 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m18:58:39.855964 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m18:58:39.892384 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m18:58:39.904859 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m18:58:39.923161 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m18:58:39.930753 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m18:58:39.939381 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m18:58:39.954242 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m18:58:40.249412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63cf50d0>]}
[0m18:58:40.318151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff633ae490>]}
[0m18:58:40.321179 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:58:40.324854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff633ae490>]}
[0m18:58:40.330049 [info ] [MainThread]: 
[0m18:58:40.333240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:58:40.362341 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m18:58:40.375602 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m18:58:40.378254 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m18:58:40.381068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:41.126983 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:58:41.133563 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m18:58:41.341804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m18:58:41.363877 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m18:58:41.369362 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m18:58:41.373120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:42.108974 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m18:58:42.115117 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m18:58:42.331313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff626da8d0>]}
[0m18:58:42.336384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:42.339970 [info ] [MainThread]: 
[0m18:58:42.351855 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:58:42.355838 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m18:58:42.360168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m18:58:42.363915 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:58:42.370111 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:58:42.406376 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 18:58:42.366879 => 18:58:42.406065
[0m18:58:42.409639 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:58:42.436016 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:58:42.450793 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:58:42.455640 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m18:58:42.464646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:49.989031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 68.0 seconds
[0m18:59:50.031319 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 18:58:42.413088 => 18:59:50.030761
[0m18:59:50.037764 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m18:59:50.374056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3fdff9-0706-41bf-be4b-bee151c74a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6263e690>]}
[0m18:59:50.385691 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 68.01s]
[0m18:59:50.396373 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:59:50.441842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:50.444621 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m18:59:50.447449 [info ] [MainThread]: 
[0m18:59:50.450386 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 10.11 seconds (70.11s).
[0m18:59:50.460453 [debug] [MainThread]: Command end result
[0m18:59:50.543250 [info ] [MainThread]: 
[0m18:59:50.546199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:50.548559 [info ] [MainThread]: 
[0m18:59:50.558654 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:59:50.563342 [debug] [MainThread]: Command `dbt run` succeeded at 18:59:50.563132 after 74.43 seconds
[0m18:59:50.567070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c528d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c528f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c528f10>]}
[0m18:59:50.569610 [debug] [MainThread]: Flushing usage events
[0m18:59:54.558583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2622d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c262fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c262e10>]}


============================== 18:59:54.565447 | 7f86163f-eb27-468e-bb12-705287dd7463 ==============================
[0m18:59:54.565447 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:59:54.571215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:59:55.093466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f86163f-eb27-468e-bb12-705287dd7463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1fff50>]}
[0m18:59:55.108840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f86163f-eb27-468e-bb12-705287dd7463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b0a1d0>]}
[0m18:59:55.125545 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:59:55.212607 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:59:55.215707 [debug] [MainThread]: previous checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, current checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf
[0m18:59:55.247585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f86163f-eb27-468e-bb12-705287dd7463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a97e10>]}
[0m18:59:55.860374 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m18:59:55.877003 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m18:59:55.884073 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m18:59:55.890249 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m18:59:55.896783 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m18:59:55.901087 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m18:59:55.907330 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m18:59:55.916113 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m18:59:55.921469 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m18:59:55.972363 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m18:59:55.977619 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m18:59:55.985484 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m18:59:55.989846 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m18:59:55.996753 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m18:59:56.004829 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m18:59:56.011519 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m18:59:56.015858 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m18:59:56.150620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f86163f-eb27-468e-bb12-705287dd7463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73bcb390>]}
[0m18:59:56.217772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f86163f-eb27-468e-bb12-705287dd7463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d590d0>]}
[0m18:59:56.248754 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:59:56.251273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f86163f-eb27-468e-bb12-705287dd7463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b71210>]}
[0m18:59:56.256862 [info ] [MainThread]: 
[0m18:59:56.259706 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:59:56.263703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m18:59:56.278439 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m18:59:56.285622 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m18:59:56.288545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:57.129540 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m18:59:57.139997 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m18:59:57.351884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f86163f-eb27-468e-bb12-705287dd7463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73ae6650>]}
[0m18:59:57.358223 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:57.364251 [info ] [MainThread]: 
[0m18:59:57.378701 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m18:59:57.379185 [debug] [Thread-2  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m18:59:57.387170 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_ipflow_input_data_user_ip ......................... [RUN]
[0m18:59:57.381562 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_ipflow_input_data_user_ip ....................... [RUN]
[0m18:59:57.390700 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095'
[0m18:59:57.393735 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11)
[0m18:59:57.397437 [debug] [Thread-2  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m18:59:57.400653 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m18:59:57.413300 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m18:59:57.421902 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m18:59:57.435913 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (compile): 18:59:57.403303 => 18:59:57.435638
[0m18:59:57.463394 [debug] [Thread-2  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m18:59:57.436448 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (compile): 18:59:57.414634 => 18:59:57.436287
[0m18:59:57.483686 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m18:59:57.487223 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m18:59:57.490798 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m18:59:57.505812 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m18:59:57.508073 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m18:59:57.509575 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_ip as unique_field,
    count(*) as n_records

from DEV_QA.DBT_POC.stg_ipflow_input_data
where user_ip is not null
group by user_ip
having count(*) > 1



      
    ) dbt_internal_test
[0m18:59:57.516774 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_ip
from DEV_QA.DBT_POC.stg_ipflow_input_data
where user_ip is null



      
    ) dbt_internal_test
[0m18:59:57.520149 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:59:57.522777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:58.369351 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:59:58.370756 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:59:58.389160 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (execute): 18:59:57.488633 => 18:59:58.388729
[0m18:59:58.391119 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (execute): 18:59:57.465616 => 18:59:58.390903
[0m18:59:58.394249 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11: Close
[0m18:59:58.397649 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095: Close
[0m18:59:58.602269 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_ipflow_input_data_user_ip ............................... [[32mPASS[0m in 1.21s]
[0m18:59:58.608584 [debug] [Thread-2  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m18:59:58.648436 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_ipflow_input_data_user_ip ............................. [[32mPASS[0m in 1.25s]
[0m18:59:58.651594 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m18:59:58.705685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:58.708650 [debug] [MainThread]: Connection 'test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11' was properly closed.
[0m18:59:58.711303 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095' was properly closed.
[0m18:59:58.714081 [info ] [MainThread]: 
[0m18:59:58.717103 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m18:59:58.722733 [debug] [MainThread]: Command end result
[0m18:59:58.796891 [info ] [MainThread]: 
[0m18:59:58.800183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:58.802824 [info ] [MainThread]: 
[0m18:59:58.806194 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:59:58.812847 [debug] [MainThread]: Command `dbt test` succeeded at 18:59:58.812700 after 4.29 seconds
[0m18:59:58.815167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c262d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1fd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1fd510>]}
[0m18:59:58.817535 [debug] [MainThread]: Flushing usage events
[0m19:00:07.808602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f16fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f16ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f16fe50>]}


============================== 19:00:07.818325 | 613e3fc3-23bb-4524-aef1-39a3730fb8e9 ==============================
[0m19:00:07.818325 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:00:07.809970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa020fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa020ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa020ff50>]}
[0m19:00:07.820905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}


============================== 19:00:07.822187 | ec52193b-fa39-4b2b-94f5-a48c151d1573 ==============================
[0m19:00:07.822187 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:00:07.827324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:00:08.409592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01bbf10>]}
[0m19:00:08.432432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886bd610>]}
[0m19:00:08.435504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f10be10>]}
[0m19:00:08.442980 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:00:08.448332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b910590>]}
[0m19:00:08.460643 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:00:08.562146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:08.564892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:08.568293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:08.572864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886f2ed0>]}
[0m19:00:08.571127 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:08.593380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876e3710>]}
[0m19:00:08.690546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8870bd50>]}
[0m19:00:08.693772 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:00:08.697894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8870bdd0>]}
[0m19:00:08.696232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87689f90>]}
[0m19:00:08.701033 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:00:08.705062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87689ad0>]}
[0m19:00:08.702034 [info ] [MainThread]: 
[0m19:00:08.708736 [info ] [MainThread]: 
[0m19:00:08.711135 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:08.713166 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:08.718458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m19:00:08.742348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m19:00:08.753730 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m19:00:08.757283 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m19:00:08.754481 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m19:00:08.759805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:08.762705 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m19:00:08.766606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:09.648742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:00:09.665534 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m19:00:09.790233 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:00:09.799727 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m19:00:09.974563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m19:00:10.041531 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m19:00:10.044592 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m19:00:10.047636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:10.184786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m19:00:10.242421 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m19:00:10.247110 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m19:00:10.249766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:10.574376 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m19:00:10.584875 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m19:00:10.909053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87708210>]}
[0m19:00:10.923194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:10.930068 [info ] [MainThread]: 
[0m19:00:10.943429 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m19:00:10.944053 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:10.950711 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m19:00:10.947573 [info ] [Thread-1  ]: 1 of 11 START sql table model DBT_POC.src_ipflow_merge_output .................. [RUN]
[0m19:00:10.962256 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m19:00:10.958645 [info ] [Thread-2  ]: 2 of 11 START sql table model DBT_POC.stg_ipflow_success_data .................. [RUN]
[0m19:00:10.963614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m19:00:10.968040 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_success_data'
[0m19:00:10.976685 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m19:00:10.979221 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:10.988240 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m19:00:10.988803 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 19:00:10.981675 => 19:00:10.988653
[0m19:00:11.000699 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 19:00:10.986341 => 19:00:11.000496
[0m19:00:11.002750 [debug] [Thread-1  ]: Compilation Error in model src_ipflow_merge_output (models/ipflow/src_ipflow_merge_output.sql)
  Required var 'env' not found in config:
  Vars supplied to src_ipflow_merge_output = {}
[0m19:00:11.003807 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:11.006180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85df0ad0>]}
[0m19:00:11.029007 [error] [Thread-1  ]: 1 of 11 ERROR creating sql table model DBT_POC.src_ipflow_merge_output ......... [[31mERROR[0m in 0.04s]
[0m19:00:11.029611 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m19:00:11.031925 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m19:00:11.039760 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m19:00:11.042685 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m19:00:11.043339 [info ] [Thread-4  ]: 3 of 11 SKIP relation DBT_POC.stg_ipflow_merge_output .......................... [[33mSKIP[0m]
[0m19:00:11.045577 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m19:00:11.072649 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m19:00:11.080190 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:00:11.293109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87947450>]}
[0m19:00:11.302138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:11.310546 [info ] [MainThread]: 
[0m19:00:11.322404 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:11.326633 [info ] [Thread-1  ]: 1 of 9 START sql table model DBT_POC.stg_ipflow_success_data ................... [RUN]
[0m19:00:11.336803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_success_data)
[0m19:00:11.339737 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:11.344637 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m19:00:11.356871 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 19:00:11.342442 => 19:00:11.356481
[0m19:00:11.359412 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:11.389616 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m19:00:11.402237 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m19:00:11.405233 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m19:00:11.407460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:12.110776 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:12.135916 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 19:00:11.008027 => 19:00:12.135687
[0m19:00:12.139368 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m19:00:12.246406 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:12.275120 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 19:00:11.361506 => 19:00:12.274889
[0m19:00:12.278651 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m19:00:12.482695 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85be2310>]}
[0m19:00:12.486589 [info ] [Thread-2  ]: 2 of 11 OK created sql table model DBT_POC.stg_ipflow_success_data ............. [[32mSUCCESS 1[0m in 1.52s]
[0m19:00:12.496870 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:12.500384 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:12.500798 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:12.503559 [info ] [Thread-1  ]: 4 of 11 START sql table model DBT_POC.src_ipflow_merge_domain_observations ..... [RUN]
[0m19:00:12.506349 [info ] [Thread-3  ]: 5 of 11 START sql table model DBT_POC.src_ipflow_merge_success_output .......... [RUN]
[0m19:00:12.513568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_output, now model.dbt_dsg_app.src_ipflow_merge_domain_observations)
[0m19:00:12.516532 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m19:00:12.519938 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:12.522179 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:12.527484 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m19:00:12.531758 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m19:00:12.541799 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 19:00:12.524799 => 19:00:12.541307
[0m19:00:12.545658 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:12.542569 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 19:00:12.529706 => 19:00:12.542420
[0m19:00:12.550797 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m19:00:12.553698 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:12.585605 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m19:00:12.590554 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m19:00:12.593846 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m19:00:12.594726 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m19:00:12.596754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:12.602810 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m19:00:12.609692 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:00:12.649836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887677d0>]}
[0m19:00:12.653274 [info ] [Thread-1  ]: 1 of 9 OK created sql table model DBT_POC.stg_ipflow_success_data .............. [[32mSUCCESS 1[0m in 1.31s]
[0m19:00:12.656365 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m19:00:12.670722 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:12.671438 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:12.676820 [info ] [Thread-4  ]: 3 of 9 START sql table model DBT_POC.src_ipflow_merge_success_output ........... [RUN]
[0m19:00:12.684861 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m19:00:12.673838 [info ] [Thread-3  ]: 2 of 9 START sql table model DBT_POC.src_ipflow_merge_domain_observations ...... [RUN]
[0m19:00:12.691704 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m19:00:12.694675 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:12.687673 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:12.699655 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m19:00:12.706720 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m19:00:12.719587 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 19:00:12.697143 => 19:00:12.719164
[0m19:00:12.722885 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:12.729932 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m19:00:12.723676 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 19:00:12.703334 => 19:00:12.723534
[0m19:00:12.763893 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:12.767128 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m19:00:12.781796 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m19:00:12.787545 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:00:12.769785 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m19:00:12.816347 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m19:00:12.818735 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m19:00:12.827538 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:00:13.558754 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:13.565834 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 19:00:12.548271 => 19:00:13.565669
[0m19:00:13.569280 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m19:00:13.725723 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:13.740366 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 19:00:12.767427 => 19:00:13.740107
[0m19:00:13.748365 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m19:00:13.821301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841cedd0>]}
[0m19:00:13.827373 [info ] [Thread-1  ]: 4 of 11 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations  [[32mSUCCESS 1[0m in 1.31s]
[0m19:00:13.882329 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:13.886529 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:13.891115 [info ] [Thread-2  ]: 6 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m19:00:13.902034 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m19:00:13.911938 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:13.935171 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:13.971815 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 19:00:13.923278 => 19:00:13.971268
[0m19:00:13.983097 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:14.022548 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:14.026785 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m19:00:14.031513 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:00:14.119759 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85301ad0>]}
[0m19:00:14.130678 [info ] [Thread-4  ]: 3 of 9 OK created sql table model DBT_POC.src_ipflow_merge_success_output ...... [[32mSUCCESS 1[0m in 1.44s]
[0m19:00:14.137410 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:14.140817 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:14.147519 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:00:14.150285 [info ] [Thread-1  ]: 4 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_success_output ..... [RUN]
[0m19:00:14.165525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m19:00:14.153844 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 19:00:12.583159 => 19:00:14.153696
[0m19:00:14.170775 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:14.182652 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m19:00:14.203063 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:14.212434 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 19:00:14.172866 => 19:00:14.212060
[0m19:00:14.214757 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:14.279318 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:14.282679 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m19:00:14.285650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:14.328143 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:00:14.334845 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 19:00:12.727330 => 19:00:14.334702
[0m19:00:14.337503 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m19:00:14.480758 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84205090>]}
[0m19:00:14.483604 [info ] [Thread-3  ]: 5 of 11 OK created sql table model DBT_POC.src_ipflow_merge_success_output ..... [[32mSUCCESS 1[0m in 1.96s]
[0m19:00:14.493481 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m19:00:14.514249 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:14.517562 [info ] [Thread-1  ]: 7 of 11 START sql incremental model DBT_POC.stg_ipflow_merge_success_output .... [RUN]
[0m19:00:14.521629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m19:00:14.529186 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:14.536302 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:14.542698 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 19:00:14.532319 => 19:00:14.542458
[0m19:00:14.545112 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:14.550277 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:14.553676 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c4e810>]}
[0m19:00:14.557569 [info ] [Thread-3  ]: 2 of 9 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations . [[32mSUCCESS 1[0m in 1.86s]
[0m19:00:14.560521 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m19:00:14.554341 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m19:00:14.570654 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:14.570702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:14.573153 [info ] [Thread-4  ]: 5 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m19:00:14.605456 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m19:00:14.611655 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:14.617777 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:14.629521 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 19:00:14.614437 => 19:00:14.627910
[0m19:00:14.631903 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:14.638662 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:14.646310 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m19:00:14.649173 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:00:14.898411 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:14.908543 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:14.915686 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m19:00:15.023399 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m19:00:15.029522 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.032224 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m19:00:15.106648 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:15.116556 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.119294 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m19:00:15.122892 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:15.127674 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.130492 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m19:00:15.146531 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m19:00:15.184997 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.191742 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m19:00:15.303908 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m19:00:15.330207 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.343615 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.342531 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:00:15.345224 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m19:00:15.349531 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.355639 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:00:15.356511 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m19:00:15.361607 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.364360 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m19:00:15.390663 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:15.394901 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.397491 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m19:00:15.481212 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:00:15.487037 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.490434 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m19:00:15.505085 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m19:00:15.510270 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.512899 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m19:00:15.519240 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:15.521242 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:00:15.523180 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.528390 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m19:00:15.533530 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.536546 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m19:00:15.641253 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m19:00:15.647226 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.649920 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m19:00:15.655323 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:00:15.663757 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.672820 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.680272 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m19:00:15.699341 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:00:15.721136 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.738992 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.741665 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m19:00:15.839790 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m19:00:15.851355 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.859430 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.861627 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m19:00:15.918139 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:15.921134 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:15.923510 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m19:00:15.986079 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:15.988627 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:15.992110 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m19:00:16.015451 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:16.040629 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:16.043314 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m19:00:16.254034 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:00:16.257328 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:16.260154 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m19:00:16.780147 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m19:00:16.780189 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:16.783265 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:16.791553 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:16.791563 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m19:00:16.794630 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m19:00:16.994824 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:17.006379 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:17.009464 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m19:00:17.145857 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:17.153308 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 19:00:14.242451 => 19:00:17.153113
[0m19:00:17.156245 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m19:00:17.237227 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:17.243396 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 19:00:13.986343 => 19:00:17.243242
[0m19:00:17.245824 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m19:00:17.807199 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2.0 seconds
[0m19:00:17.807522 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2.0 seconds
[0m19:00:17.819530 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:17.809510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c3c3d0>]}
[0m19:00:17.861608 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m19:00:17.813500 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:17.809522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841d8750>]}
[0m19:00:17.863565 [info ] [Thread-1  ]: 4 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 3.64s]
[0m19:00:17.868257 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m19:00:17.872415 [info ] [Thread-2  ]: 6 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 3.91s]
[0m19:00:17.873713 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:17.882204 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:17.884124 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:17.886761 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:17.887857 [info ] [Thread-3  ]: 6 of 9 START sql table model DBT_POC.src_ipflow_normalized_location ............ [RUN]
[0m19:00:17.894471 [info ] [Thread-3  ]: 8 of 11 START sql table model DBT_POC.fact_ip_to_company_domain ................ [RUN]
[0m19:00:17.897397 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m19:00:17.899633 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m19:00:17.900864 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:17.903394 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:17.908316 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m19:00:17.916527 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m19:00:17.922877 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 19:00:17.905431 => 19:00:17.922252
[0m19:00:17.930056 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 19:00:17.913733 => 19:00:17.929761
[0m19:00:17.930594 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:17.932633 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:17.937080 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m19:00:17.938683 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m19:00:17.947287 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m19:00:17.949914 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m19:00:17.952492 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:00:17.952256 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m19:00:17.955188 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m19:00:17.958131 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:00:18.316157 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:18.326363 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m19:00:18.330510 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m19:00:18.358049 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:18.365158 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m19:00:18.367583 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m19:00:18.502785 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:18.520354 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 19:00:14.547013 => 19:00:18.520177
[0m19:00:18.524061 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m19:00:18.537391 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:18.541669 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 19:00:14.634927 => 19:00:18.541519
[0m19:00:18.548319 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m19:00:18.757841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876943d0>]}
[0m19:00:18.763503 [info ] [Thread-1  ]: 7 of 11 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 4.24s]
[0m19:00:18.768480 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m19:00:18.772323 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:18.775557 [info ] [Thread-2  ]: 9 of 11 START sql table model DBT_POC.src_ipflow_normalized_location ........... [RUN]
[0m19:00:18.778787 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m19:00:18.782531 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:18.788531 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m19:00:18.795904 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 19:00:18.786211 => 19:00:18.795709
[0m19:00:18.821549 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:18.824403 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88720b50>]}
[0m19:00:18.827017 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m19:00:18.828862 [info ] [Thread-4  ]: 5 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 4.22s]
[0m19:00:18.833856 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m19:00:18.836145 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m19:00:18.840760 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:18.844041 [info ] [Thread-1  ]: 7 of 9 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m19:00:18.841606 [debug] [Thread-2  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m19:00:18.847421 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.fact_ip_to_company_domain)
[0m19:00:18.849304 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:00:18.856155 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:18.863462 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m19:00:18.877922 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 19:00:18.860735 => 19:00:18.877669
[0m19:00:18.880439 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:18.884428 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m19:00:18.895243 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m19:00:18.897070 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m19:00:18.899037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:19.135696 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:19.145895 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 19:00:17.936464 => 19:00:19.145683
[0m19:00:19.150263 [debug] [Thread-3  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m19:00:19.359516 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84219a50>]}
[0m19:00:19.364491 [info ] [Thread-3  ]: 8 of 11 OK created sql table model DBT_POC.fact_ip_to_company_domain ........... [[32mSUCCESS 1[0m in 1.46s]
[0m19:00:19.368248 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:20.175706 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:00:20.177622 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:20.200453 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 19:00:17.934383 => 19:00:20.200062
[0m19:00:20.214208 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 19:00:18.882303 => 19:00:20.214038
[0m19:00:20.217912 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m19:00:20.222095 [debug] [Thread-1  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m19:00:20.443558 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85262c10>]}
[0m19:00:20.444653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85231990>]}
[0m19:00:20.458304 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:00:20.454654 [info ] [Thread-3  ]: 6 of 9 OK created sql table model DBT_POC.src_ipflow_normalized_location ....... [[32mSUCCESS 1[0m in 2.55s]
[0m19:00:20.458858 [info ] [Thread-1  ]: 7 of 9 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 1.60s]
[0m19:00:20.463223 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:20.465359 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 19:00:18.824311 => 19:00:20.464890
[0m19:00:20.465891 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m19:00:20.472848 [debug] [Thread-2  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m19:00:20.472289 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:20.480176 [info ] [Thread-4  ]: 8 of 9 START sql table model DBT_POC.src_ipflow_ip_to_location ................. [RUN]
[0m19:00:20.484058 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m19:00:20.487081 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:20.491591 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m19:00:20.501515 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 19:00:20.489143 => 19:00:20.501168
[0m19:00:20.504188 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:20.507866 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m19:00:20.540836 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m19:00:20.544200 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m19:00:20.547548 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:00:20.697314 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1321d0>]}
[0m19:00:20.701572 [info ] [Thread-2  ]: 9 of 11 OK created sql table model DBT_POC.src_ipflow_normalized_location ...... [[32mSUCCESS 1[0m in 1.92s]
[0m19:00:20.705470 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m19:00:20.709646 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:20.712273 [info ] [Thread-1  ]: 10 of 11 START sql table model DBT_POC.src_ipflow_ip_to_location ............... [RUN]
[0m19:00:20.720209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_success_output, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m19:00:20.722525 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:20.728262 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m19:00:20.741791 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 19:00:20.725831 => 19:00:20.741590
[0m19:00:20.744399 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:20.749214 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m19:00:20.760371 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m19:00:20.762888 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m19:00:20.765282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:21.896755 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:21.898248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:21.905199 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 19:00:20.747053 => 19:00:21.905034
[0m19:00:21.908308 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m19:00:21.905288 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 19:00:20.505658 => 19:00:21.905104
[0m19:00:21.914877 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m19:00:22.154002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84141e50>]}
[0m19:00:22.156349 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8520e690>]}
[0m19:00:22.159773 [info ] [Thread-1  ]: 10 of 11 OK created sql table model DBT_POC.src_ipflow_ip_to_location .......... [[32mSUCCESS 1[0m in 1.43s]
[0m19:00:22.163652 [info ] [Thread-4  ]: 8 of 9 OK created sql table model DBT_POC.src_ipflow_ip_to_location ............ [[32mSUCCESS 1[0m in 1.67s]
[0m19:00:22.167818 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:22.175289 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m19:00:22.178554 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:22.182373 [info ] [Thread-3  ]: 11 of 11 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [RUN]
[0m19:00:22.180126 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:22.186229 [info ] [Thread-3  ]: 9 of 9 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings .. [RUN]
[0m19:00:22.185352 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m19:00:22.196183 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:22.193528 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_normalized_location, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m19:00:22.199192 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:22.201170 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:22.204023 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:22.218677 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 19:00:22.197952 => 19:00:22.218456
[0m19:00:22.220207 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 19:00:22.201299 => 19:00:22.219712
[0m19:00:22.224854 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:22.227115 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:22.233567 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:22.233597 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:22.235874 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m19:00:22.238618 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m19:00:22.240782 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:00:22.243395 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:00:22.772670 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:22.780350 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:22.783491 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m19:00:22.925579 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:00:22.941965 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:22.945137 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m19:00:22.947074 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:00:22.953991 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:22.960773 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m19:00:23.062765 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:00:23.070033 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.073144 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m19:00:23.135038 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:00:23.141018 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.143387 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m19:00:23.166802 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:00:23.173027 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.182320 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.209663 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m19:00:23.242632 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:00:23.247735 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.250461 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m19:00:23.353313 [debug] [Thread-3  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m19:00:23.359506 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.368528 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.375694 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m19:00:23.421016 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:23.424612 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.427588 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m19:00:23.485048 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:23.487827 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:23.490748 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m19:00:24.326816 [debug] [Thread-3  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:00:24.329756 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:24.332772 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m19:00:24.779200 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:24.788051 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:24.790744 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m19:00:24.990457 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:24.995805 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 19:00:22.229448 => 19:00:24.995677
[0m19:00:24.998302 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m19:00:25.229864 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '613e3fc3-23bb-4524-aef1-39a3730fb8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84129450>]}
[0m19:00:25.232808 [info ] [Thread-3  ]: 11 of 11 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 2[0m in 3.04s]
[0m19:00:25.235348 [debug] [Thread-3  ]: SQL status: SUCCESS 2 in 2.0 seconds
[0m19:00:25.242229 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:25.244269 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m19:00:25.237290 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:25.335273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:25.340272 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m19:00:25.344262 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_normalized_location' was properly closed.
[0m19:00:25.346610 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m19:00:25.352231 [info ] [MainThread]: 
[0m19:00:25.355398 [info ] [MainThread]: Finished running 7 table models, 4 incremental models in 0 hours 0 minutes and 16.64 seconds (16.64s).
[0m19:00:25.361008 [debug] [MainThread]: Command end result
[0m19:00:25.439791 [info ] [MainThread]: 
[0m19:00:25.450337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:00:25.452959 [info ] [MainThread]: 
[0m19:00:25.455448 [error] [MainThread]: [33mCompilation Error in model src_ipflow_merge_output (models/ipflow/src_ipflow_merge_output.sql)[0m
[0m19:00:25.458374 [error] [MainThread]:   Required var 'env' not found in config:
[0m19:00:25.460858 [error] [MainThread]:   Vars supplied to src_ipflow_merge_output = {}
[0m19:00:25.463400 [info ] [MainThread]: 
[0m19:00:25.465585 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=1 TOTAL=11
[0m19:00:25.470374 [debug] [MainThread]: Command `dbt run` failed at 19:00:25.470221 after 17.69 seconds
[0m19:00:25.472765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f16fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f16ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f16fe90>]}
[0m19:00:25.476380 [debug] [MainThread]: Flushing usage events
[0m19:00:25.536142 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:25.544268 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m19:00:25.548834 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m19:00:25.711482 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:00:25.717877 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 19:00:22.230382 => 19:00:25.717734
[0m19:00:25.726467 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m19:00:25.974679 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec52193b-fa39-4b2b-94f5-a48c151d1573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852b0050>]}
[0m19:00:25.980878 [info ] [Thread-3  ]: 9 of 9 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 2[0m in 3.78s]
[0m19:00:25.984422 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m19:00:26.022869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:26.028883 [debug] [MainThread]: Connection 'model.dbt_dsg_app.fact_ip_to_company_domain' was properly closed.
[0m19:00:26.032475 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m19:00:26.048467 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m19:00:26.055309 [info ] [MainThread]: 
[0m19:00:26.086227 [info ] [MainThread]: Finished running 6 table models, 3 incremental models in 0 hours 0 minutes and 17.34 seconds (17.34s).
[0m19:00:26.090217 [debug] [MainThread]: Command end result
[0m19:00:26.163763 [info ] [MainThread]: 
[0m19:00:26.169365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:26.176321 [info ] [MainThread]: 
[0m19:00:26.193608 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:00:26.200230 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:26.200028 after 18.42 seconds
[0m19:00:26.204050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87941290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88677210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887202d0>]}
[0m19:00:26.207175 [debug] [MainThread]: Flushing usage events
[0m19:04:28.609109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5831bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5831f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5831ed0>]}


============================== 19:04:28.623085 | a9c65aeb-d243-49ee-aed8-bbc09d1ec29d ==============================
[0m19:04:28.623085 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:04:28.628152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:04:29.356464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6441c90>]}
[0m19:04:29.389061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0fb750>]}
[0m19:04:29.410029 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m19:04:29.450721 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:04:29.455267 [debug] [MainThread]: previous checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, current checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c
[0m19:04:29.460514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d198050>]}
[0m19:04:29.971581 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m19:04:29.988085 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m19:04:29.996172 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m19:04:30.005328 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m19:04:30.012744 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m19:04:30.045362 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m19:04:30.051726 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m19:04:30.057748 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m19:04:30.063423 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m19:04:30.101371 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m19:04:30.106115 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m19:04:30.114802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m19:04:30.118097 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m19:04:30.123695 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m19:04:30.127616 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m19:04:30.133408 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m19:04:30.141682 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m19:04:30.252262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d132350>]}
[0m19:04:30.303326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0c3290>]}
[0m19:04:30.307130 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:04:30.333076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0b7450>]}
[0m19:04:30.336650 [info ] [MainThread]: 
[0m19:04:30.339180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:30.342072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m19:04:30.353613 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m19:04:30.356307 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m19:04:30.358493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:31.096775 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:04:31.109327 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m19:04:31.317905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m19:04:31.326576 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m19:04:31.329660 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m19:04:31.332488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:31.851444 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m19:04:31.857543 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m19:04:32.076387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c745650>]}
[0m19:04:32.080344 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:32.084066 [info ] [MainThread]: 
[0m19:04:32.093661 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m19:04:32.096662 [info ] [Thread-1  ]: 1 of 2 START sql table model DBT_POC.src_ipflow_merge_output ................... [RUN]
[0m19:04:32.100626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m19:04:32.126662 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m19:04:32.132064 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m19:04:32.140766 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 19:04:32.129281 => 19:04:32.140584
[0m19:04:32.143006 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m19:04:32.164673 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m19:04:32.176584 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m19:04:32.179442 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from dev_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m19:04:32.187690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:33.610930 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:04:33.634709 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 19:04:32.145000 => 19:04:33.634555
[0m19:04:33.637658 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m19:04:33.841035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0b6ad0>]}
[0m19:04:33.844624 [info ] [Thread-1  ]: 1 of 2 OK created sql table model DBT_POC.src_ipflow_merge_output .............. [[32mSUCCESS 1[0m in 1.74s]
[0m19:04:33.848215 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m19:04:33.851728 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m19:04:33.854359 [info ] [Thread-3  ]: 2 of 2 START sql incremental model DBT_POC.stg_ipflow_merge_output ............. [RUN]
[0m19:04:33.858777 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_merge_output'
[0m19:04:33.861268 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m19:04:33.868194 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:33.905366 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 19:04:33.863476 => 19:04:33.905116
[0m19:04:33.907969 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m19:04:33.937628 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:33.940040 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m19:04:33.942919 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:04:34.498799 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:04:34.536540 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:34.541093 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m19:04:34.655157 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:04:34.662278 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:34.668990 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m19:04:34.811516 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:04:34.822960 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:34.825611 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m19:04:34.935280 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:04:34.960361 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:34.970862 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:34.974790 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m19:04:35.095460 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:04:35.099238 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:35.102773 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m19:04:36.261104 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:04:36.269649 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:36.274094 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m19:04:36.672354 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:04:36.680790 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m19:04:36.683605 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m19:04:36.817370 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:04:36.822135 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 19:04:33.910335 => 19:04:36.821984
[0m19:04:36.824690 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m19:04:37.028355 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c65aeb-d243-49ee-aed8-bbc09d1ec29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0b6410>]}
[0m19:04:37.031583 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ........ [[32mSUCCESS 1[0m in 3.17s]
[0m19:04:37.035096 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m19:04:37.086820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:37.090531 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_merge_output' was properly closed.
[0m19:04:37.094219 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_output' was properly closed.
[0m19:04:37.096996 [info ] [MainThread]: 
[0m19:04:37.099259 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m19:04:37.126800 [debug] [MainThread]: Command end result
[0m19:04:37.180394 [info ] [MainThread]: 
[0m19:04:37.183350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:37.189083 [info ] [MainThread]: 
[0m19:04:37.191547 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:04:37.194626 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:37.194366 after 8.63 seconds
[0m19:04:37.208663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c328e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c190610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c190a90>]}
[0m19:04:37.211792 [debug] [MainThread]: Flushing usage events
[0m22:10:00.219689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb15c8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb1f27e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb1f6e040>]}


============================== 22:10:00.224043 | da10a513-3561-4b05-b58b-923e612eb9ee ==============================
[0m22:10:00.224043 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:10:00.224746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:10:00.537945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb1f274f0>]}
[0m22:10:00.549072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb2756b20>]}
[0m22:10:00.573301 [debug] [MainThread]: checksum: 49e139483dadcd05e2451e3e64d06671cb5623b1d6f0e13685681912273c51f9, vars: {'env': 'DEV'}, profile: , target: , version: 1.5.1
[0m22:10:00.584478 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:10:00.584985 [debug] [MainThread]: previous checksum: 49e139483dadcd05e2451e3e64d06671cb5623b1d6f0e13685681912273c51f9, current checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf
[0m22:10:00.585409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb2778a00>]}
[0m22:10:01.088723 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m22:10:01.104113 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m22:10:01.107059 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m22:10:01.110112 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m22:10:01.113439 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m22:10:01.118102 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m22:10:01.119496 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m22:10:01.122539 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m22:10:01.125557 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m22:10:01.129787 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m22:10:01.131241 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m22:10:01.135140 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m22:10:01.136643 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m22:10:01.139362 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m22:10:01.143292 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m22:10:01.144847 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m22:10:01.147531 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m22:10:01.205418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb281d0d0>]}
[0m22:10:01.211508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb28166d0>]}
[0m22:10:01.211911 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:10:01.212240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb2827ee0>]}
[0m22:10:01.213465 [info ] [MainThread]: 
[0m22:10:01.214236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:10:01.215170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m22:10:01.226526 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m22:10:01.226996 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m22:10:01.227278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:02.753706 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m22:10:02.755402 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m22:10:02.904033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now create_DEV_QA_DBT_POC_public)
[0m22:10:02.905115 [debug] [ThreadPool]: Creating schema "database: "DEV_QA"
schema: "DBT_POC_public"
"
[0m22:10:02.908941 [debug] [ThreadPool]: Using snowflake connection "create_DEV_QA_DBT_POC_public"
[0m22:10:02.909269 [debug] [ThreadPool]: On create_DEV_QA_DBT_POC_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "create_DEV_QA_DBT_POC_public"} */
create schema if not exists DEV_QA.DBT_POC_public
[0m22:10:02.909490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:03.465615 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:10:03.469430 [debug] [ThreadPool]: On create_DEV_QA_DBT_POC_public: Close
[0m22:10:03.605316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_DEV_QA_DBT_POC_public, now list_DEV_QA_DBT_POC)
[0m22:10:03.606931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC_public'
[0m22:10:03.623820 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m22:10:03.626110 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC_public"
[0m22:10:03.626557 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m22:10:03.626927 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC_public"} */
show terse objects in DEV_QA.DBT_POC_public
[0m22:10:03.627264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:03.627582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:03.958703 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m22:10:03.962258 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC_public: Close
[0m22:10:03.966313 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m22:10:03.969422 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m22:10:04.158652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb27ce3a0>]}
[0m22:10:04.160177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:04.160834 [info ] [MainThread]: 
[0m22:10:04.170270 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m22:10:04.171857 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC_public.src_ipflow_merge_output ............ [RUN]
[0m22:10:04.173075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m22:10:04.173722 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m22:10:04.177538 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m22:10:04.179745 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 22:10:04.174037 => 22:10:04.179359
[0m22:10:04.180237 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m22:10:04.211098 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m22:10:04.213006 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m22:10:04.213405 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC_public.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m22:10:04.213710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:10:05.845779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:10:05.862599 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 22:10:04.180497 => 22:10:05.862433
[0m22:10:05.862953 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m22:10:05.993065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da10a513-3561-4b05-b58b-923e612eb9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb28163a0>]}
[0m22:10:05.993891 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC_public.src_ipflow_merge_output ....... [[32mSUCCESS 1[0m in 1.82s]
[0m22:10:05.994515 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m22:10:05.999739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:06.000477 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_merge_output' was properly closed.
[0m22:10:06.000996 [debug] [MainThread]: Connection 'list_DEV_QA_DBT_POC_public' was properly closed.
[0m22:10:06.001536 [info ] [MainThread]: 
[0m22:10:06.002250 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m22:10:06.003381 [debug] [MainThread]: Command end result
[0m22:10:06.012631 [info ] [MainThread]: 
[0m22:10:06.013192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:06.013507 [info ] [MainThread]: 
[0m22:10:06.013847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:10:06.014512 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:06.014400 after 5.84 seconds
[0m22:10:06.014842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb15c8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb27b2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb2806ee0>]}
[0m22:10:06.015159 [debug] [MainThread]: Flushing usage events
[0m02:26:59.233511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf841bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf841f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf841fd0>]}
[0m02:26:59.233814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ce0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ce0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ce0f90>]}


============================== 02:26:59.288039 | 34510387-9e8a-44d2-9cbc-bf390c1b738d ==============================
[0m02:26:59.288039 [info ] [MainThread]: Running with dbt=1.5.1
[0m02:26:59.328346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}


============================== 02:26:59.295310 | e666b155-15f4-429d-ae5f-ad065d32a703 ==============================
[0m02:26:59.295310 [info ] [MainThread]: Running with dbt=1.5.1
[0m02:26:59.342771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m02:27:01.065913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c794d0>]}
[0m02:27:01.171767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba38f50>]}
[0m02:27:01.188963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7db450>]}
[0m02:27:01.207674 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m02:27:01.229111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf841bd0>]}
[0m02:27:01.249718 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m02:27:01.301866 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:27:01.310592 [debug] [MainThread]: previous checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, current checksum: 49e139483dadcd05e2451e3e64d06671cb5623b1d6f0e13685681912273c51f9
[0m02:27:01.314131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715442d0>]}
[0m02:27:01.309137 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:27:01.328812 [debug] [MainThread]: previous checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, current checksum: 49e139483dadcd05e2451e3e64d06671cb5623b1d6f0e13685681912273c51f9
[0m02:27:01.352407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9705c2d0>]}
[0m02:27:02.202076 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m02:27:02.217901 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m02:27:02.224119 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m02:27:02.230847 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m02:27:02.239166 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m02:27:02.245422 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m02:27:02.251481 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m02:27:02.266912 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m02:27:02.313207 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m02:27:02.322896 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m02:27:02.326249 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m02:27:02.336704 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m02:27:02.344244 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m02:27:02.353223 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m02:27:02.369008 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m02:27:02.375704 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m02:27:02.381176 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m02:27:02.386378 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m02:27:02.414993 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m02:27:02.420476 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m02:27:02.429895 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m02:27:02.441349 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m02:27:02.450815 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m02:27:02.464790 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m02:27:02.472981 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m02:27:02.477443 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m02:27:02.480701 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m02:27:02.494768 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m02:27:02.506589 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m02:27:02.517956 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m02:27:02.528088 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m02:27:02.538185 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m02:27:02.548749 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m02:27:02.554836 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m02:27:02.631192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71544750>]}
[0m02:27:02.754377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970af410>]}
[0m02:27:02.769305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7155ba10>]}
[0m02:27:02.772315 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:27:02.799154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71544710>]}
[0m02:27:02.804343 [info ] [MainThread]: 
[0m02:27:02.808437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:27:02.807519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96724490>]}
[0m02:27:02.814354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m02:27:02.814260 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:27:02.821149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97189a90>]}
[0m02:27:02.824848 [info ] [MainThread]: 
[0m02:27:02.827446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:27:02.827420 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m02:27:02.830390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m02:27:02.832455 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m02:27:02.837122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:02.844810 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m02:27:02.847853 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m02:27:02.850996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:03.856976 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:27:03.872174 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m02:27:03.908444 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:27:03.920509 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m02:27:04.053204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m02:27:04.063847 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m02:27:04.066412 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m02:27:04.069185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:04.150309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m02:27:04.161902 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m02:27:04.164328 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m02:27:04.167108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:27:04.461319 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m02:27:04.468442 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m02:27:04.548648 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m02:27:04.554242 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m02:27:04.650258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96754a90>]}
[0m02:27:04.708213 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:27:04.710917 [info ] [MainThread]: 
[0m02:27:04.719416 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:04.722042 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m02:27:04.725198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m02:27:04.727814 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:04.741684 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:27:04.747316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bb335d0>]}
[0m02:27:04.752175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:27:04.761625 [info ] [MainThread]: 
[0m02:27:04.769384 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 02:27:04.739431 => 02:27:04.768695
[0m02:27:04.772195 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:04.774812 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:04.775969 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m02:27:04.791894 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m02:27:04.794252 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:04.798812 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:27:04.813651 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 02:27:04.796358 => 02:27:04.813197
[0m02:27:04.816185 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:04.828681 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:27:04.844913 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:27:04.846797 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:27:04.850156 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m02:27:04.854962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:27:04.857835 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:27:04.860899 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m02:27:04.864926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:27:05.304348 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01add4d3-0404-ad39-002b-b10702d0f77e
[0m02:27:05.304300 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01add4d3-0404-ad39-002b-b10702d0f782
[0m02:27:05.308979 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0' does not exist or not authorized.
[0m02:27:05.312851 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0' does not exist or not authorized.
[0m02:27:05.320694 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 02:27:04.819169 => 02:27:05.320240
[0m02:27:05.316947 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 02:27:04.788653 => 02:27:05.316699
[0m02:27:05.322081 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m02:27:05.334172 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m02:27:05.512363 [debug] [Thread-1  ]: Database Error in model stg_ipflow_input_data (models/ipflow/stg_ipflow_input_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0' does not exist or not authorized.
  compiled Code at target/run/dbt_dsg_app/models/ipflow/stg_ipflow_input_data.sql
[0m02:27:05.512883 [debug] [Thread-1  ]: Database Error in model stg_ipflow_input_data (models/ipflow/stg_ipflow_input_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0' does not exist or not authorized.
  compiled Code at target/run/dbt_dsg_app/models/ipflow/stg_ipflow_input_data.sql
[0m02:27:05.530262 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34510387-9e8a-44d2-9cbc-bf390c1b738d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955fbe10>]}
[0m02:27:05.534428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e666b155-15f4-429d-ae5f-ad065d32a703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bad3e50>]}
[0m02:27:05.541898 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model DBT_POC.stg_ipflow_input_data ............ [[31mERROR[0m in 0.81s]
[0m02:27:05.558417 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:05.557446 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model DBT_POC.stg_ipflow_input_data ............ [[31mERROR[0m in 0.74s]
[0m02:27:05.563207 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:27:05.583352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:05.586257 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m02:27:05.589173 [info ] [MainThread]: 
[0m02:27:05.591667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m02:27:05.594868 [debug] [MainThread]: Command end result
[0m02:27:05.628881 [info ] [MainThread]: 
[0m02:27:05.632303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:27:05.635961 [info ] [MainThread]: 
[0m02:27:05.637914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:05.638675 [error] [MainThread]: [33mDatabase Error in model stg_ipflow_input_data (models/ipflow/stg_ipflow_input_data.sql)[0m
[0m02:27:05.640760 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m02:27:05.642762 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m02:27:05.644826 [info ] [MainThread]: 
[0m02:27:05.694427 [error] [MainThread]:   Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0' does not exist or not authorized.
[0m02:27:05.697429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m02:27:05.697960 [error] [MainThread]:   compiled Code at target/run/dbt_dsg_app/models/ipflow/stg_ipflow_input_data.sql
[0m02:27:05.701167 [debug] [MainThread]: Command end result
[0m02:27:05.703389 [info ] [MainThread]: 
[0m02:27:05.706210 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:27:05.709250 [debug] [MainThread]: Command `dbt run` failed at 02:27:05.709105 after 6.58 seconds
[0m02:27:05.722026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c79650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c79610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c79150>]}
[0m02:27:05.725362 [debug] [MainThread]: Flushing usage events
[0m02:27:05.757688 [info ] [MainThread]: 
[0m02:27:05.760143 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:27:05.768460 [info ] [MainThread]: 
[0m02:27:05.771006 [error] [MainThread]: [33mDatabase Error in model stg_ipflow_input_data (models/ipflow/stg_ipflow_input_data.sql)[0m
[0m02:27:05.773661 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m02:27:05.776028 [error] [MainThread]:   Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_9_0' does not exist or not authorized.
[0m02:27:05.783868 [error] [MainThread]:   compiled Code at target/run/dbt_dsg_app/models/ipflow/stg_ipflow_input_data.sql
[0m02:27:05.786457 [info ] [MainThread]: 
[0m02:27:05.789329 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:27:05.792639 [debug] [MainThread]: Command `dbt run` failed at 02:27:05.792435 after 6.67 seconds
[0m02:27:05.795101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23b4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7edf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7ed110>]}
[0m02:27:05.798223 [debug] [MainThread]: Flushing usage events
[0m02:29:36.990937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4553490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4553f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4553fd0>]}


============================== 02:29:36.998376 | 198ab896-3b52-49c5-ab22-b8610316cda7 ==============================
[0m02:29:36.998376 [info ] [MainThread]: Running with dbt=1.5.1
[0m02:29:37.001235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m02:29:37.543946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '198ab896-3b52-49c5-ab22-b8610316cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4516710>]}
[0m02:29:37.558723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '198ab896-3b52-49c5-ab22-b8610316cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70664d0>]}
[0m02:29:37.572322 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m02:29:37.674175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:29:37.676905 [debug] [MainThread]: Partial parsing: updated file: dbt_dsg_app://models/ipflow/stg_ipflow_input_data.sql
[0m02:29:37.694316 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m02:29:37.814364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '198ab896-3b52-49c5-ab22-b8610316cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca8c750>]}
[0m02:29:37.868550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '198ab896-3b52-49c5-ab22-b8610316cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca5ac50>]}
[0m02:29:37.876486 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:29:37.879504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '198ab896-3b52-49c5-ab22-b8610316cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca5a810>]}
[0m02:29:37.882207 [info ] [MainThread]: 
[0m02:29:37.889582 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:29:37.892762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m02:29:37.906218 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m02:29:37.909114 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m02:29:37.912410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:38.561950 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:29:38.568966 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m02:29:38.747489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m02:29:38.767123 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m02:29:38.770768 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m02:29:38.773736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:39.244253 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m02:29:39.254761 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m02:29:39.431780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '198ab896-3b52-49c5-ab22-b8610316cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca4a4d0>]}
[0m02:29:39.437458 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:29:39.441521 [info ] [MainThread]: 
[0m02:29:39.459141 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:29:39.461729 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m02:29:39.464739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m02:29:39.521724 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:29:39.528872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:29:39.537730 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 02:29:39.524374 => 02:29:39.537445
[0m02:29:39.554750 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:29:39.585693 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:29:39.605654 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m02:29:39.608516 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_10_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m02:29:39.612118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:29:42.222694 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:29:42.295924 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 02:29:39.556920 => 02:29:42.295773
[0m02:29:42.299112 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m02:29:42.473905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '198ab896-3b52-49c5-ab22-b8610316cda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a509910>]}
[0m02:29:42.479704 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 3.01s]
[0m02:29:42.485797 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m02:29:42.517474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:29:42.520923 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m02:29:42.524513 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m02:29:42.529222 [info ] [MainThread]: 
[0m02:29:42.532478 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m02:29:42.535425 [debug] [MainThread]: Command end result
[0m02:29:42.622839 [info ] [MainThread]: 
[0m02:29:42.631788 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:29:42.634408 [info ] [MainThread]: 
[0m02:29:42.637452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:29:42.640886 [debug] [MainThread]: Command `dbt run` succeeded at 02:29:42.640754 after 5.68 seconds
[0m02:29:42.643041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4500f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4500fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd74990>]}
[0m02:29:42.652152 [debug] [MainThread]: Flushing usage events
[0m02:29:46.604682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3bbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3bbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3bbf10>]}


============================== 02:29:46.612003 | f7e5304e-7800-4875-bfb5-f6c375fe45db ==============================
[0m02:29:46.612003 [info ] [MainThread]: Running with dbt=1.5.1
[0m02:29:46.615185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m02:29:47.149750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e5304e-7800-4875-bfb5-f6c375fe45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba368c50>]}
[0m02:29:47.162579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e5304e-7800-4875-bfb5-f6c375fe45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1171d0>]}
[0m02:29:47.179372 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m02:29:47.263678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:29:47.266487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:29:47.274419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e5304e-7800-4875-bfb5-f6c375fe45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b22650>]}
[0m02:29:47.370486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e5304e-7800-4875-bfb5-f6c375fe45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ac9cd0>]}
[0m02:29:47.373626 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:29:47.383408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e5304e-7800-4875-bfb5-f6c375fe45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ac9550>]}
[0m02:29:47.387276 [info ] [MainThread]: 
[0m02:29:47.391266 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:29:47.394895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m02:29:47.414471 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m02:29:47.426681 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m02:29:47.430881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:47.958633 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m02:29:47.965857 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m02:29:48.193135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e5304e-7800-4875-bfb5-f6c375fe45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81ad1d0>]}
[0m02:29:48.197190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:29:48.199936 [info ] [MainThread]: 
[0m02:29:48.209129 [debug] [Thread-1  ]: Began running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m02:29:48.209548 [debug] [Thread-2  ]: Began running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m02:29:48.211718 [info ] [Thread-1  ]: 1 of 2 START test not_null_stg_ipflow_input_data_user_ip ....................... [RUN]
[0m02:29:48.214413 [info ] [Thread-2  ]: 2 of 2 START test unique_stg_ipflow_input_data_user_ip ......................... [RUN]
[0m02:29:48.217342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11)
[0m02:29:48.219593 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095'
[0m02:29:48.226547 [debug] [Thread-2  ]: Began compiling node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m02:29:48.224352 [debug] [Thread-1  ]: Began compiling node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m02:29:48.236299 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m02:29:48.242677 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m02:29:48.256543 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (compile): 02:29:48.228802 => 02:29:48.256304
[0m02:29:48.257447 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (compile): 02:29:48.237440 => 02:29:48.257097
[0m02:29:48.260638 [debug] [Thread-2  ]: Began executing node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m02:29:48.263425 [debug] [Thread-1  ]: Began executing node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m02:29:48.280908 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m02:29:48.282760 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m02:29:48.344858 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"
[0m02:29:48.347499 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_ip as unique_field,
    count(*) as n_records

from DEV_QA.DBT_POC.stg_ipflow_input_data
where user_ip is not null
group by user_ip
having count(*) > 1



      
    ) dbt_internal_test
[0m02:29:48.348523 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"
[0m02:29:48.359184 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:29:48.361287 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_ip
from DEV_QA.DBT_POC.stg_ipflow_input_data
where user_ip is null



      
    ) dbt_internal_test
[0m02:29:48.366817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:29:49.027047 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:29:49.028932 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:29:49.063126 [debug] [Thread-1  ]: Timing info for test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11 (execute): 02:29:48.281169 => 02:29:49.062823
[0m02:29:49.065053 [debug] [Thread-2  ]: Timing info for test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095 (execute): 02:29:48.265747 => 02:29:49.064836
[0m02:29:49.068343 [debug] [Thread-1  ]: On test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11: Close
[0m02:29:49.080193 [debug] [Thread-2  ]: On test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095: Close
[0m02:29:49.253521 [info ] [Thread-1  ]: 1 of 2 PASS not_null_stg_ipflow_input_data_user_ip ............................. [[32mPASS[0m in 1.04s]
[0m02:29:49.259213 [debug] [Thread-1  ]: Finished running node test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11
[0m02:29:49.258469 [info ] [Thread-2  ]: 2 of 2 PASS unique_stg_ipflow_input_data_user_ip ............................... [[32mPASS[0m in 1.04s]
[0m02:29:49.266277 [debug] [Thread-2  ]: Finished running node test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095
[0m02:29:49.320351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:29:49.326313 [debug] [MainThread]: Connection 'test.dbt_dsg_app.not_null_stg_ipflow_input_data_user_ip.2f5d498b11' was properly closed.
[0m02:29:49.329301 [debug] [MainThread]: Connection 'test.dbt_dsg_app.unique_stg_ipflow_input_data_user_ip.8927593095' was properly closed.
[0m02:29:49.332711 [info ] [MainThread]: 
[0m02:29:49.335939 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m02:29:49.338596 [debug] [MainThread]: Command end result
[0m02:29:49.429560 [info ] [MainThread]: 
[0m02:29:49.438249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:29:49.440329 [info ] [MainThread]: 
[0m02:29:49.442734 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:29:49.445549 [debug] [MainThread]: Command `dbt test` succeeded at 02:29:49.445460 after 2.91 seconds
[0m02:29:49.454858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba35ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba35ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81ad1d0>]}
[0m02:29:49.457764 [debug] [MainThread]: Flushing usage events
[0m02:29:55.915202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99f3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99f3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99f3fd0>]}


============================== 02:29:55.921753 | 0bb91ad2-f8cf-4219-9fea-ba036699fa35 ==============================
[0m02:29:55.921753 [info ] [MainThread]: Running with dbt=1.5.1
[0m02:29:55.916668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe40d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe40f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdd7b10>]}
[0m02:29:55.924866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}


============================== 02:29:55.927607 | 80e6d203-d543-4940-9b69-9c8ceb7976d5 ==============================
[0m02:29:55.927607 [info ] [MainThread]: Running with dbt=1.5.1
[0m02:29:55.940990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m02:29:56.489919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdd70d0>]}
[0m02:29:56.490601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa999fe50>]}
[0m02:29:56.502541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677304d0>]}
[0m02:29:56.504593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa999fe90>]}
[0m02:29:56.515379 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m02:29:56.516801 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m02:29:56.630474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:29:56.631748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:29:56.633283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:29:56.636352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:29:56.641747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98184bd0>]}
[0m02:29:56.644467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677b8710>]}
[0m02:29:56.702841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980ebe10>]}
[0m02:29:56.723404 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:29:56.728171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980ebc10>]}
[0m02:29:56.731358 [info ] [MainThread]: 
[0m02:29:56.735600 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:29:56.734394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6775de50>]}
[0m02:29:56.738446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m02:29:56.738516 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:29:56.743713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6775d690>]}
[0m02:29:56.748922 [info ] [MainThread]: 
[0m02:29:56.751804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:29:56.753424 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m02:29:56.755431 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m02:29:56.757420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m02:29:56.806289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:56.820352 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m02:29:56.823485 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m02:29:56.827296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:57.365318 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:29:57.373437 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m02:29:57.383505 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m02:29:57.388364 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m02:29:57.555069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m02:29:57.569951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m02:29:57.629977 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m02:29:57.633229 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m02:29:57.635536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:29:57.654574 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m02:29:57.657843 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m02:29:57.661260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:29:57.996581 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m02:29:58.004376 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m02:29:58.041221 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m02:29:58.047660 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m02:29:58.186561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9117c890>]}
[0m02:29:58.192132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:29:58.194641 [info ] [MainThread]: 
[0m02:29:58.204316 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_output
[0m02:29:58.207554 [info ] [Thread-1  ]: 1 of 2 START sql table model DBT_POC.src_ipflow_merge_output ................... [RUN]
[0m02:29:58.259859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.src_ipflow_merge_output)
[0m02:29:58.262370 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_output
[0m02:29:58.265386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66a7d850>]}
[0m02:29:58.267479 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m02:29:58.268264 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:29:58.272691 [info ] [MainThread]: 
[0m02:29:58.290292 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (compile): 02:29:58.264656 => 02:29:58.289744
[0m02:29:58.295757 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_output
[0m02:29:58.292648 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_success_data
[0m02:29:58.308082 [info ] [Thread-1  ]: 1 of 9 START sql table model DBT_POC.stg_ipflow_success_data ................... [RUN]
[0m02:29:58.310827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_success_data)
[0m02:29:58.313338 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_success_data
[0m02:29:58.318158 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m02:29:58.330705 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_output"
[0m02:29:58.336286 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (compile): 02:29:58.315832 => 02:29:58.335828
[0m02:29:58.338746 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_success_data
[0m02:29:58.350155 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_output"
[0m02:29:58.352305 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from dev_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
      group by user_ip
        );
[0m02:29:58.354508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:29:58.377884 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_success_data"
[0m02:29:58.389557 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_success_data"
[0m02:29:58.391912 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_success_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_success_data
         as
        (

select * from DEV_IP_FLOW.RAW_DATA.IP_FLOW_API_OUTPUT_DATA 
where last_response_code = 200
        );
[0m02:29:58.394170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:29:59.154730 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:29:59.156412 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:29:59.174832 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_success_data (execute): 02:29:58.350401 => 02:29:59.174683
[0m02:29:59.177563 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_success_data: Close
[0m02:29:59.180443 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_output (execute): 02:29:58.298456 => 02:29:59.180248
[0m02:29:59.183354 [debug] [Thread-1  ]: On model.dbt_dsg_app.src_ipflow_merge_output: Close
[0m02:29:59.351957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66780350>]}
[0m02:29:59.356661 [info ] [Thread-1  ]: 1 of 9 OK created sql table model DBT_POC.stg_ipflow_success_data .............. [[32mSUCCESS 1[0m in 1.04s]
[0m02:29:59.360834 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_success_data
[0m02:29:59.364324 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m02:29:59.366854 [info ] [Thread-3  ]: 2 of 9 START sql table model DBT_POC.src_ipflow_merge_domain_observations ...... [RUN]
[0m02:29:59.364765 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m02:29:59.370321 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_domain_observations'
[0m02:29:59.386843 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m02:29:59.382792 [info ] [Thread-4  ]: 3 of 9 START sql table model DBT_POC.src_ipflow_merge_success_output ........... [RUN]
[0m02:29:59.393733 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m02:29:59.404976 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.src_ipflow_merge_success_output'
[0m02:29:59.409651 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m02:29:59.412162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9031e550>]}
[0m02:29:59.416249 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m02:29:59.423952 [info ] [Thread-1  ]: 1 of 2 OK created sql table model DBT_POC.src_ipflow_merge_output .............. [[32mSUCCESS 1[0m in 1.15s]
[0m02:29:59.425233 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (compile): 02:29:59.389470 => 02:29:59.424851
[0m02:29:59.438397 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_output
[0m02:29:59.449287 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m02:29:59.452501 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m02:29:59.450650 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (compile): 02:29:59.412944 => 02:29:59.450507
[0m02:29:59.454695 [info ] [Thread-3  ]: 2 of 2 START sql incremental model DBT_POC.stg_ipflow_merge_output ............. [RUN]
[0m02:29:59.455371 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m02:29:59.461381 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.stg_ipflow_merge_output'
[0m02:29:59.459578 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m02:29:59.464985 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_output
[0m02:29:59.468463 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m02:29:59.470711 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_domain_observations"
[0m02:29:59.473590 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_domain_observations"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_domain_observations
         as
        (

WITH source as (
SELECT 
DISTINCT 
USER_IP as IP,
MIN(LAST_RESPONSE_CODE) AS LAST_RESPONSE_CODE,
 MAX(LAST_QUERY_DATE) AS LAST_QUERY_DATE, 
 ANY_VALUE(API_RESPONSE) AS API_RESPONSE, 
 'IP FLOW' AS SOURCE 
 FROM  DEV_QA.DBT_POC.stg_ipflow_success_data 
GROUP BY USER_IP
)

SELECT 
IP,
SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 2) || '.' || SPLIT_PART(PARSE_JSON(API_RESPONSE):website::string, '.', 3) AS NORMALIZED_COMPANY_DOMAIN,
SOURCE,
NULL as SOURCE_CONFIDENCE,
LAST_QUERY_DATE 
from 
source
        );
[0m02:29:59.475934 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:29:59.476884 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_merge_success_output"
[0m02:29:59.482821 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_merge_success_output"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_merge_success_output
         as
        (

select user_ip, min(last_response_code) as last_response_code,
       max(last_query_date) as last_query_date, any_value(api_response) as api_response 
       from DEV_QA.DBT_POC.stg_ipflow_success_data 
      group by user_ip
        );
[0m02:29:59.485941 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:29:59.484207 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:29:59.498425 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (compile): 02:29:59.468359 => 02:29:59.498190
[0m02:29:59.503580 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_output
[0m02:29:59.534555 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:29:59.537796 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m02:29:59.590109 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:30:00.114955 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:30:00.135556 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:00.140835 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp
[0m02:30:00.221412 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:30:00.245955 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m02:30:00.249141 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_success_output (execute): 02:29:59.466116 => 02:30:00.248852
[0m02:30:00.254624 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:00.261646 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_output
[0m02:30:00.257738 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_merge_success_output: Close
[0m02:30:00.352019 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m02:30:00.361647 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:00.364715 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_OUTPUT"
[0m02:30:00.450801 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f543d0>]}
[0m02:30:00.454891 [info ] [Thread-4  ]: 3 of 9 OK created sql table model DBT_POC.src_ipflow_merge_success_output ...... [[32mSUCCESS 1[0m in 1.05s]
[0m02:30:00.457815 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_success_output
[0m02:30:00.461475 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m02:30:00.469814 [info ] [Thread-1  ]: 4 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_success_output ..... [RUN]
[0m02:30:00.472640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_success_data, now model.dbt_dsg_app.stg_ipflow_merge_success_output)
[0m02:30:00.476489 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m02:30:00.487869 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:00.498314 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (compile): 02:30:00.481446 => 02:30:00.498071
[0m02:30:00.501651 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m02:30:00.515444 [debug] [Thread-3  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m02:30:00.531646 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:30:00.541821 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:00.537960 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:00.541144 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_merge_domain_observations (execute): 02:29:59.452760 => 02:30:00.541031
[0m02:30:00.551557 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_merge_domain_observations: Close
[0m02:30:00.553379 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:00.555576 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
-- back compat for old kwarg name
  
  begin;
[0m02:30:00.545510 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_success_output

),

updates AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    

        WHERE USER_IP IN (SELECT USER_IP FROM DEV_QA.DBT_POC.stg_ipflow_merge_success_output)

    

),

inserts AS (

    SELECT 
    USER_IP,
    LAST_RESPONSE_CODE,
    LAST_QUERY_DATE,
    API_RESPONSE 
    FROM 
    using_clause 


    WHERE USER_IP NOT IN (SELECT USER_IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m02:30:00.560209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:30:00.704321 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:00.707351 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:00.710752 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m02:30:00.778781 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66884e50>]}
[0m02:30:00.783270 [info ] [Thread-3  ]: 2 of 9 OK created sql table model DBT_POC.src_ipflow_merge_domain_observations . [[32mSUCCESS 1[0m in 1.41s]
[0m02:30:00.787081 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_merge_domain_observations
[0m02:30:00.790738 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m02:30:00.800105 [info ] [Thread-4  ]: 5 of 9 START sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [RUN]
[0m02:30:00.802961 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_success_output, now model.dbt_dsg_app.stg_ipflow_merge_domain_observations)
[0m02:30:00.805651 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m02:30:00.811060 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:00.826321 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (compile): 02:30:00.808325 => 02:30:00.826130
[0m02:30:00.828364 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m02:30:00.840155 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:00.842895 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    NORMALIZED_COMPANY_DOMAIN,
    SOURCE,
    SOURCE_CONFIDENCE,
    LAST_QUERY_DATE 
    FROM 
    DEV_QA.DBT_POC.src_ipflow_merge_domain_observations 

),

updates AS (

    SELECT 
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    

        WHERE IP || SOURCE IN (SELECT IP || SOURCE FROM DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations)

    

),

inserts AS (

    SELECT
    IP, 
    NORMALIZED_COMPANY_DOMAIN, 
    SOURCE, 
    SOURCE_CONFIDENCE, 
    LAST_QUERY_DATE 
    FROM 
    using_clause 


    WHERE IP || SOURCE NOT IN (SELECT IP || SOURCE FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m02:30:00.845851 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m02:30:01.095534 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:30:01.116630 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:01.120616 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp
[0m02:30:01.222094 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m02:30:01.231900 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:01.236580 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_success_output
[0m02:30:01.325867 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:01.327914 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m02:30:01.337034 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:01.351916 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:01.353805 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp
[0m02:30:01.360588 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_SUCCESS_OUTPUT"
[0m02:30:01.467830 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m02:30:01.476604 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:01.481628 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
[0m02:30:01.485631 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m02:30:01.488871 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:01.492109 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
COMMIT
[0m02:30:01.495182 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m02:30:01.565151 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:01.577720 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:01.579654 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m02:30:01.581545 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
-- back compat for old kwarg name
  
  begin;
[0m02:30:01.595689 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:01.601702 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_MERGE_DOMAIN_OBSERVATIONS"
[0m02:30:01.711882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:01.715758 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:01.724642 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:01.729407 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_success_output as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_IP = DBT_INTERNAL_DEST.USER_IP
            )

    
    when matched then update set
        "USER_IP" = DBT_INTERNAL_SOURCE."USER_IP","LAST_RESPONSE_CODE" = DBT_INTERNAL_SOURCE."LAST_RESPONSE_CODE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE","API_RESPONSE" = DBT_INTERNAL_SOURCE."API_RESPONSE"
    

    when not matched then insert
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")
    values
        ("USER_IP", "LAST_RESPONSE_CODE", "LAST_QUERY_DATE", "API_RESPONSE")

;
[0m02:30:01.734597 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_output"
[0m02:30:01.745175 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_output__dbt_tmp cascade
[0m02:30:01.745479 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m02:30:01.753827 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:01.772420 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:01.774770 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
-- back compat for old kwarg name
  
  begin;
[0m02:30:01.873567 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:01.878297 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_output (execute): 02:29:59.505525 => 02:30:01.878162
[0m02:30:01.884575 [debug] [Thread-3  ]: On model.dbt_dsg_app.stg_ipflow_merge_output: Close
[0m02:30:01.933097 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:01.937517 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:01.943693 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
merge into DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
                ) and (
                    DBT_INTERNAL_SOURCE.SOURCE = DBT_INTERNAL_DEST.SOURCE
                )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","NORMALIZED_COMPANY_DOMAIN" = DBT_INTERNAL_SOURCE."NORMALIZED_COMPANY_DOMAIN","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","SOURCE_CONFIDENCE" = DBT_INTERNAL_SOURCE."SOURCE_CONFIDENCE","LAST_QUERY_DATE" = DBT_INTERNAL_SOURCE."LAST_QUERY_DATE"
    

    when not matched then insert
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")
    values
        ("IP", "NORMALIZED_COMPANY_DOMAIN", "SOURCE", "SOURCE_CONFIDENCE", "LAST_QUERY_DATE")

;
[0m02:30:02.069757 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bb91ad2-f8cf-4219-9fea-ba036699fa35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902a36d0>]}
[0m02:30:02.072845 [info ] [Thread-3  ]: 2 of 2 OK created sql incremental model DBT_POC.stg_ipflow_merge_output ........ [[32mSUCCESS 0[0m in 2.61s]
[0m02:30:02.076086 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_output
[0m02:30:02.154827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:02.158321 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_merge_output' was properly closed.
[0m02:30:02.160793 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_output' was properly closed.
[0m02:30:02.163260 [info ] [MainThread]: 
[0m02:30:02.167168 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m02:30:02.169775 [debug] [MainThread]: Command end result
[0m02:30:02.262560 [info ] [MainThread]: 
[0m02:30:02.270466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:02.279750 [info ] [MainThread]: 
[0m02:30:02.285508 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:30:02.298413 [debug] [MainThread]: Command `dbt run` succeeded at 02:30:02.298222 after 6.41 seconds
[0m02:30:02.301736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa998d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa998d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa998d610>]}
[0m02:30:02.304458 [debug] [MainThread]: Flushing usage events
[0m02:30:02.461482 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m02:30:02.464570 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:02.473548 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
COMMIT
[0m02:30:02.678463 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:02.693663 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_success_output"
[0m02:30:02.696893 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_success_output"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_success_output__dbt_tmp cascade
[0m02:30:02.819749 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:02.828149 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_success_output (execute): 02:30:00.506182 => 02:30:02.827939
[0m02:30:02.832979 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_merge_success_output: Close
[0m02:30:02.935176 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m02:30:02.938672 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:02.941859 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
COMMIT
[0m02:30:03.006256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64eacc90>]}
[0m02:30:03.011204 [info ] [Thread-1  ]: 4 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_success_output  [[32mSUCCESS 0[0m in 2.53s]
[0m02:30:03.015969 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_success_output
[0m02:30:03.019858 [debug] [Thread-3  ]: Began running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m02:30:03.024431 [info ] [Thread-3  ]: 6 of 9 START sql table model DBT_POC.src_ipflow_normalized_location ............ [RUN]
[0m02:30:03.088511 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.src_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_normalized_location)
[0m02:30:03.091494 [debug] [Thread-3  ]: Began compiling node model.dbt_dsg_app.src_ipflow_normalized_location
[0m02:30:03.097827 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m02:30:03.107525 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (compile): 02:30:03.094554 => 02:30:03.106943
[0m02:30:03.123071 [debug] [Thread-3  ]: Began executing node model.dbt_dsg_app.src_ipflow_normalized_location
[0m02:30:03.126625 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:03.142857 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"
[0m02:30:03.134849 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m02:30:03.149629 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_merge_domain_observations"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations__dbt_tmp cascade
[0m02:30:03.167463 [debug] [Thread-3  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_normalized_location"
[0m02:30:03.177680 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_normalized_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_normalized_location
         as
        (

with normalized_country as (

  select 
  a.user_ip, 
  a.last_query_date, 
  b.isocode_3 as country_isocode_3,
  PARSE_JSON(a.API_RESPONSE):location:region::string as region_name, 
  PARSE_JSON(a.API_RESPONSE):location:town::string as city_name, 
  
  ---THE IP_TO_LOCATION table only allows numeric zipcodes which is only in the US
  CASE WHEN PARSE_JSON(a.API_RESPONSE):location:countryCode::string = 'US' THEN 
  PARSE_JSON(a.API_RESPONSE):location:postalCode::string END as postal_code 
  
  from DEV_QA.DBT_POC.stg_ipflow_merge_success_output as a 
  left join DEV_IP_FLOW.raw_data.country_iso_codes as b
  on PARSE_JSON(a.API_RESPONSE):location:countryCode::string = b.isocode_2
), 

normalized_region as (
select a.*, b.region_isocode_2
  from normalized_country as a 
  left join DEV_IP_FLOW.raw_data.usa_region as b
  on a.region_name = b.region_name
)

select distinct
USER_IP as IP,
LAST_QUERY_DATE as DATE_UPDATED,
COUNTRY_ISOCODE_3 as NORMALIZED_COUNTRY_CODE,
REGION_ISOCODE_2 as NORMALIZED_REGION_CODE,
CITY_NAME as NORMALIZED_CITY_NAME,
POSTAL_CODE as NORMALIZED_ZIP
from normalized_region
        );
[0m02:30:03.180596 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m02:30:03.320917 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:03.325896 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.stg_ipflow_merge_domain_observations (execute): 02:30:00.837218 => 02:30:03.325758
[0m02:30:03.328609 [debug] [Thread-4  ]: On model.dbt_dsg_app.stg_ipflow_merge_domain_observations: Close
[0m02:30:03.506712 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64defa50>]}
[0m02:30:03.509767 [info ] [Thread-4  ]: 5 of 9 OK created sql incremental model DBT_POC.stg_ipflow_merge_domain_observations  [[32mSUCCESS 0[0m in 2.70s]
[0m02:30:03.515468 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.stg_ipflow_merge_domain_observations
[0m02:30:03.519171 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m02:30:03.521884 [info ] [Thread-2  ]: 7 of 9 START sql table model DBT_POC.fact_ip_to_company_domain ................. [RUN]
[0m02:30:03.524291 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_dsg_app.fact_ip_to_company_domain'
[0m02:30:03.527778 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.fact_ip_to_company_domain
[0m02:30:03.533390 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m02:30:03.544710 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (compile): 02:30:03.530636 => 02:30:03.544177
[0m02:30:03.552842 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.fact_ip_to_company_domain
[0m02:30:03.564496 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m02:30:03.595928 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.fact_ip_to_company_domain"
[0m02:30:03.607794 [debug] [Thread-2  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.fact_ip_to_company_domain"} */
create or replace transient table DEV_QA.DBT_POC.fact_ip_to_company_domain
         as
        (

with scores as(
    select distinct
    ip,
    normalized_company_domain,
    source,
    source_confidence,
    case source
        when 'DIGITAL ELEMENT' then 0.3
        when 'IP FLOW' then 0.5
        when 'FIVE BY FIVE' then 0.9
        when 'LASTBOUNCE' then 0.7
    else 0.5 end as source_score,
    1.0-(0.01*(current_date - LAST_QUERY_DATE)) as recency_score,
    ifnull(source_confidence, 1)*recency_score*source_score as score
from DEV_QA.DBT_POC.stg_ipflow_merge_domain_observations
where normalized_company_domain != 'Shared'
and normalized_company_domain is not null
and len(normalized_company_domain)>1
),
map_scores as (
    select
    ip,
    normalized_company_domain,
    array_agg(distinct source) as sources,
    sum(score) as score
  from scores
  group by 1,2
),
score_totals as (
    select
    ip,
    sum(score) as score_total
    from map_scores
  group by 1
)
select distinct
    a.ip,
    normalized_company_domain,
    greatest(0.1, (CASE WHEN score_total=0 THEN 0 ELSE score/score_total END) ) as score
from map_scores a
join score_totals b
on a.ip = b.ip
        );
[0m02:30:03.678678 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:30:04.788261 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:30:04.801290 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.fact_ip_to_company_domain (execute): 02:30:03.557859 => 02:30:04.801090
[0m02:30:04.804687 [debug] [Thread-2  ]: On model.dbt_dsg_app.fact_ip_to_company_domain: Close
[0m02:30:04.995219 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff676d6ad0>]}
[0m02:30:05.008157 [info ] [Thread-2  ]: 7 of 9 OK created sql table model DBT_POC.fact_ip_to_company_domain ............ [[32mSUCCESS 1[0m in 1.47s]
[0m02:30:05.022601 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.fact_ip_to_company_domain
[0m02:30:05.121458 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:30:05.127675 [debug] [Thread-3  ]: Timing info for model.dbt_dsg_app.src_ipflow_normalized_location (execute): 02:30:03.130253 => 02:30:05.127539
[0m02:30:05.130840 [debug] [Thread-3  ]: On model.dbt_dsg_app.src_ipflow_normalized_location: Close
[0m02:30:05.313385 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66871410>]}
[0m02:30:05.321210 [info ] [Thread-3  ]: 6 of 9 OK created sql table model DBT_POC.src_ipflow_normalized_location ....... [[32mSUCCESS 1[0m in 2.23s]
[0m02:30:05.330464 [debug] [Thread-3  ]: Finished running node model.dbt_dsg_app.src_ipflow_normalized_location
[0m02:30:05.349115 [debug] [Thread-4  ]: Began running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m02:30:05.353410 [info ] [Thread-4  ]: 8 of 9 START sql table model DBT_POC.src_ipflow_ip_to_location ................. [RUN]
[0m02:30:05.357699 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.stg_ipflow_merge_domain_observations, now model.dbt_dsg_app.src_ipflow_ip_to_location)
[0m02:30:05.361191 [debug] [Thread-4  ]: Began compiling node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m02:30:05.369404 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m02:30:05.378580 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (compile): 02:30:05.364722 => 02:30:05.378321
[0m02:30:05.381140 [debug] [Thread-4  ]: Began executing node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m02:30:05.388689 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m02:30:05.400215 [debug] [Thread-4  ]: Using snowflake connection "model.dbt_dsg_app.src_ipflow_ip_to_location"
[0m02:30:05.403990 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.src_ipflow_ip_to_location"} */
create or replace transient table DEV_QA.DBT_POC.src_ipflow_ip_to_location
         as
        (

SELECT IP, MAX(DATE_UPDATED) AS DATE_UPDATED, ANY_VALUE(NORMALIZED_COUNTRY_CODE) AS NORMALIZED_COUNTRY_CODE, 
       ANY_VALUE(NORMALIZED_REGION_CODE) AS NORMALIZED_REGION_CODE, 
       ANY_VALUE(NORMALIZED_CITY_NAME) AS NORMALIZED_CITY_NAME, 
       ANY_VALUE(NORMALIZED_ZIP) AS NORMALIZED_ZIP
       FROM DEV_QA.DBT_POC.src_ipflow_normalized_location
       GROUP BY IP
        );
[0m02:30:05.406953 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m02:30:06.325240 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:30:06.331714 [debug] [Thread-4  ]: Timing info for model.dbt_dsg_app.src_ipflow_ip_to_location (execute): 02:30:05.386339 => 02:30:06.331499
[0m02:30:06.334760 [debug] [Thread-4  ]: On model.dbt_dsg_app.src_ipflow_ip_to_location: Close
[0m02:30:06.503238 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66775190>]}
[0m02:30:06.515518 [info ] [Thread-4  ]: 8 of 9 OK created sql table model DBT_POC.src_ipflow_ip_to_location ............ [[32mSUCCESS 1[0m in 1.15s]
[0m02:30:06.519768 [debug] [Thread-4  ]: Finished running node model.dbt_dsg_app.src_ipflow_ip_to_location
[0m02:30:06.524448 [debug] [Thread-2  ]: Began running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m02:30:06.527550 [info ] [Thread-2  ]: 9 of 9 START sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings .. [RUN]
[0m02:30:06.540479 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_dsg_app.fact_ip_to_company_domain, now model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings)
[0m02:30:06.545358 [debug] [Thread-2  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m02:30:06.551748 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:06.570784 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (compile): 02:30:06.547461 => 02:30:06.570339
[0m02:30:06.573498 [debug] [Thread-2  ]: Began executing node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m02:30:06.579458 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:06.582509 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
create or replace  temporary view DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
  
   as (
    

WITH 

using_clause AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP
    FROM 
    DEV_QA.DBT_POC.src_ipflow_ip_to_location

),

updates AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    

        WHERE IP IN (SELECT IP FROM DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings)

    

),

inserts AS (

    SELECT 
    IP,
    DATE_UPDATED,
    NORMALIZED_COUNTRY_CODE,
    NORMALIZED_REGION_CODE,
    NORMALIZED_CITY_NAME,
    NORMALIZED_ZIP 
    FROM 
    using_clause 


    WHERE IP NOT IN (SELECT IP FROM updates)

)

SELECT * FROM updates 
UNION 
SELECT * FROM inserts
  );
[0m02:30:06.586172 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:30:07.147165 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:30:07.154573 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:07.171917 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp
[0m02:30:07.273715 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m02:30:07.280271 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:07.291868 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings
[0m02:30:07.405843 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m02:30:07.415743 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:07.419314 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
describe table "DEV_QA"."DBT_POC"."STG_IPFLOW_IP_TO_LOCATION_MAPPINGS"
[0m02:30:07.507127 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m02:30:07.512456 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:07.523137 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:07.528423 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
-- back compat for old kwarg name
  
  begin;
[0m02:30:07.699464 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:07.704158 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:07.707209 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
merge into DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings as DBT_INTERNAL_DEST
        using DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.IP = DBT_INTERNAL_DEST.IP
            )

    
    when matched then update set
        "IP" = DBT_INTERNAL_SOURCE."IP","DATE_UPDATED" = DBT_INTERNAL_SOURCE."DATE_UPDATED","NORMALIZED_COUNTRY_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_COUNTRY_CODE","NORMALIZED_REGION_CODE" = DBT_INTERNAL_SOURCE."NORMALIZED_REGION_CODE","NORMALIZED_CITY_NAME" = DBT_INTERNAL_SOURCE."NORMALIZED_CITY_NAME","NORMALIZED_ZIP" = DBT_INTERNAL_SOURCE."NORMALIZED_ZIP"
    

    when not matched then insert
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")
    values
        ("IP", "DATE_UPDATED", "NORMALIZED_COUNTRY_CODE", "NORMALIZED_REGION_CODE", "NORMALIZED_CITY_NAME", "NORMALIZED_ZIP")

;
[0m02:30:08.534499 [debug] [Thread-2  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m02:30:08.537407 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:08.540259 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
COMMIT
[0m02:30:08.870491 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:08.875796 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"
[0m02:30:08.881639 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings"} */
drop view if exists DEV_QA.DBT_POC.stg_ipflow_ip_to_location_mappings__dbt_tmp cascade
[0m02:30:09.002541 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m02:30:09.007166 [debug] [Thread-2  ]: Timing info for model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings (execute): 02:30:06.575727 => 02:30:09.006905
[0m02:30:09.009541 [debug] [Thread-2  ]: On model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings: Close
[0m02:30:09.192251 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e6d203-d543-4940-9b69-9c8ceb7976d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64e02f10>]}
[0m02:30:09.195844 [info ] [Thread-2  ]: 9 of 9 OK created sql incremental model DBT_POC.stg_ipflow_ip_to_location_mappings  [[32mSUCCESS 2[0m in 2.65s]
[0m02:30:09.199345 [debug] [Thread-2  ]: Finished running node model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings
[0m02:30:09.243394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:09.249540 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_merge_success_output' was properly closed.
[0m02:30:09.253929 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_normalized_location' was properly closed.
[0m02:30:09.257212 [debug] [MainThread]: Connection 'model.dbt_dsg_app.src_ipflow_ip_to_location' was properly closed.
[0m02:30:09.259691 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_ip_to_location_mappings' was properly closed.
[0m02:30:09.266457 [info ] [MainThread]: 
[0m02:30:09.270590 [info ] [MainThread]: Finished running 6 table models, 3 incremental models in 0 hours 0 minutes and 12.51 seconds (12.51s).
[0m02:30:09.276736 [debug] [MainThread]: Command end result
[0m02:30:09.373638 [info ] [MainThread]: 
[0m02:30:09.383198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:09.387228 [info ] [MainThread]: 
[0m02:30:09.389285 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m02:30:09.392985 [debug] [MainThread]: Command `dbt run` succeeded at 02:30:09.392794 after 13.51 seconds
[0m02:30:09.407075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdd7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdd7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdd7110>]}
[0m02:30:09.411233 [debug] [MainThread]: Flushing usage events
[0m10:18:13.557183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda8e7b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb8e0fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb8e0ffa0>]}


============================== 10:18:13.562181 | 962fed72-6579-4d79-8d40-70c7c03cdfc5 ==============================
[0m10:18:13.562181 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:18:13.562766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:18:17.162131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '962fed72-6579-4d79-8d40-70c7c03cdfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb8e0f730>]}
[0m10:18:17.173983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '962fed72-6579-4d79-8d40-70c7c03cdfc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd780eca90>]}
[0m00:00:04.160236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b9cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b9ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b9cfd0>]}


============================== 00:00:04.168737 | 0216d4b7-688e-46bc-927e-6dab3f1a5b1e ==============================
[0m00:00:04.168737 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:04.175150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:04.770340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0216d4b7-688e-46bc-927e-6dab3f1a5b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b37190>]}
[0m00:00:04.785293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0216d4b7-688e-46bc-927e-6dab3f1a5b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879344d0>]}
[0m00:00:04.802634 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:00:04.833795 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:00:04.837402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0216d4b7-688e-46bc-927e-6dab3f1a5b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3da390>]}
[0m00:00:05.307687 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m00:00:05.322609 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m00:00:05.350197 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m00:00:05.357071 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m00:00:05.364254 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m00:00:05.370523 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m00:00:05.379783 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m00:00:05.386006 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m00:00:05.391041 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m00:00:05.432059 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m00:00:05.438513 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m00:00:05.444912 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m00:00:05.448664 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m00:00:05.454751 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m00:00:05.459479 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m00:00:05.524806 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m00:00:05.529549 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m00:00:05.631732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0216d4b7-688e-46bc-927e-6dab3f1a5b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8412fe90>]}
[0m00:00:05.690264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0216d4b7-688e-46bc-927e-6dab3f1a5b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8412fdd0>]}
[0m00:00:05.693195 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:05.695271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0216d4b7-688e-46bc-927e-6dab3f1a5b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8412fc50>]}
[0m00:00:05.699497 [info ] [MainThread]: 
[0m00:00:05.702478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:05.705798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:05.719516 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:05.722294 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:05.724052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:06.175706 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:06.179227 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:06.183100 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:00:06.185357 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:06.187853 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:00:06.191763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:06.195790 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:06.199282 [info ] [MainThread]: 
[0m00:00:06.201583 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m00:00:06.204428 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:00:06.266188 [debug] [MainThread]: Command `dbt run` failed at 00:00:06.265851 after 2.14 seconds
[0m00:00:06.269151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b37550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b37610>]}
[0m00:00:06.272240 [debug] [MainThread]: Flushing usage events
[0m00:00:06.461081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e9d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e9de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e9df50>]}


============================== 00:00:06.470915 | 7f654eb2-634c-4b47-8084-b612aa51161b ==============================
[0m00:00:06.470915 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:06.475995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:07.511471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f654eb2-634c-4b47-8084-b612aa51161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa015a210>]}
[0m00:00:07.525478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f654eb2-634c-4b47-8084-b612aa51161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e7f650>]}
[0m00:00:07.546741 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:00:07.848146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:07.852113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:07.874888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f654eb2-634c-4b47-8084-b612aa51161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d61f50>]}
[0m00:00:07.952328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f654eb2-634c-4b47-8084-b612aa51161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9879e210>]}
[0m00:00:07.957429 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:07.965446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f654eb2-634c-4b47-8084-b612aa51161b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9879ef10>]}
[0m00:00:07.973008 [info ] [MainThread]: 
[0m00:00:07.977632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:07.983672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:08.000336 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:08.004385 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:08.008744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:09.212123 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:09.221996 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:09.225133 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:00:09.228664 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:09.231858 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:00:09.243932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:09.248761 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:09.251507 [info ] [MainThread]: 
[0m00:00:09.254724 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m00:00:09.258218 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:00:09.261441 [debug] [MainThread]: Command `dbt run` failed at 00:00:09.261134 after 2.88 seconds
[0m00:00:09.264755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e3bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e3be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e49f50>]}
[0m00:00:09.267716 [debug] [MainThread]: Flushing usage events
[0m00:00:05.099965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9930bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9930be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9930bfd0>]}


============================== 00:00:05.113259 | e42506ee-0520-4a5f-9a89-ac5ba13d3f70 ==============================
[0m00:00:05.113259 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:05.116873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:05.810059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e42506ee-0520-4a5f-9a89-ac5ba13d3f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992a6750>]}
[0m00:00:05.822955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e42506ee-0520-4a5f-9a89-ac5ba13d3f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89af5a90>]}
[0m00:00:05.835869 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:00:06.062250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:06.068857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:06.077738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e42506ee-0520-4a5f-9a89-ac5ba13d3f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88124450>]}
[0m00:00:06.136737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e42506ee-0520-4a5f-9a89-ac5ba13d3f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880c7910>]}
[0m00:00:06.138985 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:06.142010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e42506ee-0520-4a5f-9a89-ac5ba13d3f70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880c7590>]}
[0m00:00:06.145695 [info ] [MainThread]: 
[0m00:00:06.148296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:06.151177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:06.162965 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:06.165918 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:06.168667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:06.693060 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:06.697198 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:06.701225 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:00:06.707134 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:06.710253 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:00:06.714094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:06.716899 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:06.719981 [info ] [MainThread]: 
[0m00:00:06.724490 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m00:00:06.727086 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:00:06.730521 [debug] [MainThread]: Command `dbt run` failed at 00:00:06.730385 after 1.68 seconds
[0m00:00:06.733025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992b9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992b9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992b9f50>]}
[0m00:00:06.737910 [debug] [MainThread]: Flushing usage events
[0m00:00:03.755567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9106d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9106de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9106df50>]}


============================== 00:00:03.763328 | 200ca356-bec4-40c0-aebb-944049796ee2 ==============================
[0m00:00:03.763328 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:03.767546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:04.323215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '200ca356-bec4-40c0-aebb-944049796ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9101cd10>]}
[0m00:00:04.337074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '200ca356-bec4-40c0-aebb-944049796ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fc3690>]}
[0m00:00:04.352635 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:00:04.583098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:04.586346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:04.602539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '200ca356-bec4-40c0-aebb-944049796ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff795b0110>]}
[0m00:00:04.675804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '200ca356-bec4-40c0-aebb-944049796ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79553110>]}
[0m00:00:04.679928 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:04.685657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '200ca356-bec4-40c0-aebb-944049796ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79553510>]}
[0m00:00:04.704125 [info ] [MainThread]: 
[0m00:00:04.709480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:04.715816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:04.735111 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:04.739033 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:04.742353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:06.214991 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:06.226307 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:06.230536 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:00:06.243097 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:06.257433 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:00:06.276044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:06.311097 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:06.318134 [info ] [MainThread]: 
[0m00:00:06.337839 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m00:00:06.361264 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:00:06.378511 [debug] [MainThread]: Command `dbt run` failed at 00:00:06.378235 after 2.66 seconds
[0m00:00:06.385725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91009350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91009310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91009390>]}
[0m00:00:06.402082 [debug] [MainThread]: Flushing usage events
[0m00:04:52.883885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6748b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6748f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6748fd0>]}


============================== 00:04:52.894043 | 88c73546-f416-43ab-ad9b-0f896c46e639 ==============================
[0m00:04:52.894043 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:04:52.903271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:04:53.784044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88c73546-f416-43ab-ad9b-0f896c46e639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66e4310>]}
[0m00:04:53.798882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88c73546-f416-43ab-ad9b-0f896c46e639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6703550>]}
[0m00:04:53.818095 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:04:54.089570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:54.093575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:54.103507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88c73546-f416-43ab-ad9b-0f896c46e639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94eb6650>]}
[0m00:04:54.176398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88c73546-f416-43ab-ad9b-0f896c46e639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e5cd50>]}
[0m00:04:54.178911 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:04:54.182066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88c73546-f416-43ab-ad9b-0f896c46e639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e5c350>]}
[0m00:04:54.185215 [info ] [MainThread]: 
[0m00:04:54.194337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:54.198587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:04:54.211473 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:04:54.213821 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:04:54.217129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:54.821420 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:04:54.824644 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:04:54.827804 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:04:54.831510 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:04:54.834822 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:04:54.839396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:54.841950 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:04:54.846714 [info ] [MainThread]: 
[0m00:04:54.849805 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m00:04:54.853050 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:04:54.856038 [debug] [MainThread]: Command `dbt run` failed at 00:04:54.855875 after 2.04 seconds
[0m00:04:54.859492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6748b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6748f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6748fd0>]}
[0m00:04:54.863593 [debug] [MainThread]: Flushing usage events
[0m00:15:22.011875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89bb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89bbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89bbf50>]}


============================== 00:15:22.020904 | 1eab6fab-b0ef-426d-9877-9b2b4ccd6a36 ==============================
[0m00:15:22.020904 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:15:22.030981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:15:22.531190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eab6fab-b0ef-426d-9877-9b2b4ccd6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8954410>]}
[0m00:15:22.543348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eab6fab-b0ef-426d-9877-9b2b4ccd6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa897c310>]}
[0m00:15:22.558500 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:15:22.815157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:15:22.817789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:15:22.824919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eab6fab-b0ef-426d-9877-9b2b4ccd6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9310e5d0>]}
[0m00:15:22.869393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eab6fab-b0ef-426d-9877-9b2b4ccd6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930b1650>]}
[0m00:15:22.873095 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:15:22.875626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eab6fab-b0ef-426d-9877-9b2b4ccd6a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930b1fd0>]}
[0m00:15:22.878601 [info ] [MainThread]: 
[0m00:15:22.881226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:15:22.884223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:15:22.896720 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:15:22.899149 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:15:22.901782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:23.728389 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:15:23.735792 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:15:23.740960 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:15:23.746643 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:15:23.751525 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:15:23.765148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:23.768349 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:15:23.771348 [info ] [MainThread]: 
[0m00:15:23.774117 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m00:15:23.784390 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:15:23.787136 [debug] [MainThread]: Command `dbt run` failed at 00:15:23.787000 after 1.82 seconds
[0m00:15:23.789922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8958f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8967f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8967d50>]}
[0m00:15:23.792215 [debug] [MainThread]: Flushing usage events
[0m00:03:17.154665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1289c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1289e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1289f90>]}


============================== 00:03:17.162129 | 5e65f2ac-2659-416c-a3f0-80ea5136efe1 ==============================
[0m00:03:17.162129 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:03:17.166480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:03:17.587662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e65f2ac-2659-416c-a3f0-80ea5136efe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1225090>]}
[0m00:03:17.600049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e65f2ac-2659-416c-a3f0-80ea5136efe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1289690>]}
[0m00:03:17.611582 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:03:17.815844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:03:17.820102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:03:17.837699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e65f2ac-2659-416c-a3f0-80ea5136efe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9002efd0>]}
[0m00:03:17.894228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e65f2ac-2659-416c-a3f0-80ea5136efe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90044e50>]}
[0m00:03:17.897203 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:03:17.902882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e65f2ac-2659-416c-a3f0-80ea5136efe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90044890>]}
[0m00:03:17.905912 [info ] [MainThread]: 
[0m00:03:17.908735 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:03:17.911888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:03:17.931041 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:03:17.933708 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:03:17.936621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:18.378140 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:03:18.381349 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:03:18.384038 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:03:18.386855 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:03:18.401307 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:03:18.405045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:18.408495 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:03:18.411084 [info ] [MainThread]: 
[0m00:03:18.413342 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m00:03:18.415876 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:03:18.418427 [debug] [MainThread]: Command `dbt run` failed at 00:03:18.418312 after 1.30 seconds
[0m00:03:18.420898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1225390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1225350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1225410>]}
[0m00:03:18.425669 [debug] [MainThread]: Flushing usage events
[0m00:37:56.866322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7da4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7dae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7daf50>]}


============================== 00:37:56.874407 | d3c6b554-aaf7-4d62-8285-1ab1544bba57 ==============================
[0m00:37:56.874407 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:37:56.877441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:37:57.494109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3c6b554-aaf7-4d62-8285-1ab1544bba57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c79f710>]}
[0m00:37:57.507253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3c6b554-aaf7-4d62-8285-1ab1544bba57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1b1610>]}
[0m00:37:57.525643 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:37:57.715980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:57.727131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:57.734995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3c6b554-aaf7-4d62-8285-1ab1544bba57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64d75710>]}
[0m00:37:57.788012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3c6b554-aaf7-4d62-8285-1ab1544bba57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64d18210>]}
[0m00:37:57.790242 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:37:57.796704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3c6b554-aaf7-4d62-8285-1ab1544bba57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64d18610>]}
[0m00:37:57.800488 [info ] [MainThread]: 
[0m00:37:57.802491 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:37:57.806122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:37:57.817377 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:37:57.819536 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:37:57.822559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:03.798818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834b4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834b4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834b4fd0>]}


============================== 00:00:03.805648 | ad6d5fa5-f436-417b-81b2-0dd3b5627dca ==============================
[0m00:00:03.805648 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:03.808315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:04.239814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad6d5fa5-f436-417b-81b2-0dd3b5627dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8344d950>]}
[0m00:00:04.250843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad6d5fa5-f436-417b-81b2-0dd3b5627dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8349a890>]}
[0m00:00:04.267556 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:00:04.452683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:04.454753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:04.461748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad6d5fa5-f436-417b-81b2-0dd3b5627dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ad85fd0>]}
[0m00:00:04.498034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad6d5fa5-f436-417b-81b2-0dd3b5627dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ad9bd90>]}
[0m00:00:04.501399 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:04.503778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6d5fa5-f436-417b-81b2-0dd3b5627dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ad9bd10>]}
[0m00:00:04.506864 [info ] [MainThread]: 
[0m00:00:04.509380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:04.520489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:04.533043 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:04.535497 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:04.540133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:04.971971 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:04.979179 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:04.982841 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:00:04.985643 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:04.988702 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:00:04.992085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:04.997043 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:04.999694 [info ] [MainThread]: 
[0m00:00:05.002043 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:00:05.004462 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:00:05.007712 [debug] [MainThread]: Command `dbt run` failed at 00:00:05.007347 after 1.24 seconds
[0m00:00:05.010748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83455dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83455e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83455210>]}
[0m00:00:05.013050 [debug] [MainThread]: Flushing usage events
[0m00:00:03.406740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5908b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5908f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5908fd0>]}


============================== 00:00:03.413933 | c9755526-d103-4b6d-9318-5342a8f3fd04 ==============================
[0m00:00:03.413933 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:03.416946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:03.834262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9755526-d103-4b6d-9318-5342a8f3fd04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58b7f90>]}
[0m00:00:03.845855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9755526-d103-4b6d-9318-5342a8f3fd04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960c4590>]}
[0m00:00:03.860336 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:00:04.040609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:04.043339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:04.050265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9755526-d103-4b6d-9318-5342a8f3fd04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976a1550>]}
[0m00:00:04.086947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9755526-d103-4b6d-9318-5342a8f3fd04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1de190>]}
[0m00:00:04.091402 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:04.093538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9755526-d103-4b6d-9318-5342a8f3fd04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1de5d0>]}
[0m00:00:04.096848 [info ] [MainThread]: 
[0m00:00:04.099389 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:04.102349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:04.114817 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:04.117477 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:04.121057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:04.968961 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:04.972415 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:04.974755 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:00:04.977445 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:04.979781 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:00:04.982989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:04.986829 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:04.988957 [info ] [MainThread]: 
[0m00:00:04.991332 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m00:00:04.994358 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:00:04.997344 [debug] [MainThread]: Command `dbt run` failed at 00:00:04.997243 after 1.62 seconds
[0m00:00:05.000250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58b7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58b7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58b7ed0>]}
[0m00:00:05.002460 [debug] [MainThread]: Flushing usage events
[0m00:00:02.771212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d54c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d54e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d54fd0>]}


============================== 00:00:02.779544 | 854836ba-ae50-432d-aa03-77d21df76cae ==============================
[0m00:00:02.779544 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:02.783659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:03.252809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854836ba-ae50-432d-aa03-77d21df76cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d00e50>]}
[0m00:00:03.265319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854836ba-ae50-432d-aa03-77d21df76cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d246190>]}
[0m00:00:03.278393 [debug] [MainThread]: checksum: dd372e29977c7fe73dff7b608295c619376ed29830304de87983dac7e6e8f1bf, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.1
[0m00:00:03.386868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:03.389666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:03.397132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '854836ba-ae50-432d-aa03-77d21df76cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d309c90>]}
[0m00:00:03.456803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '854836ba-ae50-432d-aa03-77d21df76cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d26e190>]}
[0m00:00:03.459466 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:03.461580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854836ba-ae50-432d-aa03-77d21df76cae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d26e5d0>]}
[0m00:00:03.467281 [info ] [MainThread]: 
[0m00:00:03.470585 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:03.473786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:03.485576 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:03.488359 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:03.497272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:03.901116 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:03.913965 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:03.917549 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:00:03.921439 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:00:03.924417 [debug] [ThreadPool]: On list_DEV_QA: No close available on handle
[0m00:00:03.927801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:03.930684 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:03.934920 [info ] [MainThread]: 
[0m00:00:03.937326 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m00:00:03.940262 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV_QA"
  Database Error
    250001 (08001): Failed to connect to DB: bcb55215.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m00:00:03.943366 [debug] [MainThread]: Command `dbt run` failed at 00:00:03.943271 after 1.21 seconds
[0m00:00:03.946185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cee050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cee610>]}
[0m00:00:03.948802 [debug] [MainThread]: Flushing usage events
[0m13:10:58.980935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e0820a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e103fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e103feb0>]}


============================== 13:10:58.992251 | e452d4d7-4004-4deb-8086-5aced85988d5 ==============================
[0m13:10:58.992251 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:10:58.992940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:10:58.993540 [info ] [MainThread]: dbt version: 1.5.1
[0m13:10:58.993844 [info ] [MainThread]: python version: 3.9.13
[0m13:10:58.994122 [info ] [MainThread]: python path: /Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/bin/python
[0m13:10:58.994391 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m13:10:58.994654 [info ] [MainThread]: Using profiles.yml file at /Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app/profiles.yml
[0m13:10:58.994967 [info ] [MainThread]: Using dbt_project.yml file at /Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app/dbt_project.yml
[0m13:10:58.995532 [info ] [MainThread]: Configuration:
[0m13:10:59.272047 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:10:59.290034 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:10:59.290557 [info ] [MainThread]: Required dependencies:
[0m13:10:59.290953 [debug] [MainThread]: Executing "git --help"
[0m13:10:59.331879 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:10:59.332867 [debug] [MainThread]: STDERR: "b''"
[0m13:10:59.333243 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:10:59.333591 [info ] [MainThread]: Connection:
[0m13:10:59.334361 [info ] [MainThread]:   account: bcb55215.us-east-1
[0m13:10:59.334780 [info ] [MainThread]:   user: aokubanjo
[0m13:10:59.335076 [info ] [MainThread]:   database: DEV_QA
[0m13:10:59.335343 [info ] [MainThread]:   schema: DBT_POC
[0m13:10:59.335601 [info ] [MainThread]:   warehouse: dev_transform
[0m13:10:59.335857 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:10:59.336114 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:10:59.336387 [info ] [MainThread]:   query_tag: None
[0m13:10:59.346740 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:10:59.348127 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:10:59.348398 [debug] [MainThread]: On debug: select 1 as id
[0m13:10:59.348637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:01.604546 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:11:01.607660 [debug] [MainThread]: On debug: Close
[0m13:11:01.698157 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:11:01.699254 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:11:01.701079 [debug] [MainThread]: Command `dbt debug` succeeded at 13:11:01.700493 after 2.76 seconds
[0m13:11:01.701757 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:11:01.702467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e0820a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e186ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e1885250>]}
[0m13:11:01.703277 [debug] [MainThread]: Flushing usage events
[0m18:12:45.213736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd7f10>]}


============================== 18:12:45.253597 | 56e866b5-f553-4a38-bf89-11fe2697a41a ==============================
[0m18:12:45.253597 [info ] [MainThread]: Running with dbt=1.5.4
[0m18:12:45.258352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:12:45.715461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fec7d0>]}
[0m18:12:45.728485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7411b190>]}
[0m18:12:45.732028 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m18:12:45.755635 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m18:12:45.798356 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:12:45.801190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c79fa50>]}
[0m18:12:46.422121 [debug] [MainThread]: 1699: static parser successfully parsed global/fact_ip_to_company_domain.sql
[0m18:12:46.434364 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_ip_to_location.sql
[0m18:12:46.440148 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_domain_observations.sql
[0m18:12:46.445846 [debug] [MainThread]: 1603: static parser failed on ipflow/src_ipflow_merge_output.sql
[0m18:12:46.451769 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/src_ipflow_merge_output.sql
[0m18:12:46.455452 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_merge_success_output.sql
[0m18:12:46.460068 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/src_ipflow_normalized_location.sql
[0m18:12:46.466201 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m18:12:46.471412 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m18:12:46.509618 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_ip_to_location_mappings.sql
[0m18:12:46.514187 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_domain_observations.sql
[0m18:12:46.552435 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_domain_observations.sql
[0m18:12:46.556787 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_output.sql
[0m18:12:46.562650 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_output.sql
[0m18:12:46.566644 [debug] [MainThread]: 1603: static parser failed on ipflow/stg_ipflow_merge_success_output.sql
[0m18:12:46.572687 [debug] [MainThread]: 1602: parser fallback to jinja rendering on ipflow/stg_ipflow_merge_success_output.sql
[0m18:12:46.576160 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_success_data.sql
[0m18:12:46.661400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c093410>]}
[0m18:12:46.736352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c0a01d0>]}
[0m18:12:46.746202 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:12:46.748648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74059d90>]}
[0m18:12:46.752148 [info ] [MainThread]: 
[0m18:12:46.754329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:12:46.766007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m18:12:46.778340 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m18:12:46.781448 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m18:12:46.784194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:47.758588 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:12:47.769100 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m18:12:47.951577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m18:12:47.961358 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m18:12:47.964234 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m18:12:47.966635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:48.337520 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m18:12:48.341231 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m18:12:48.536551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f051890>]}
[0m18:12:48.540426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:12:48.553373 [info ] [MainThread]: 
[0m18:12:48.561336 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:12:48.565383 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m18:12:48.568918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m18:12:48.571018 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:12:48.575578 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:12:48.588487 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 18:12:48.573303 => 18:12:48.588216
[0m18:12:48.593283 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:12:48.617286 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:12:48.669319 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:12:48.675334 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_10_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m18:12:48.686430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:49.198353 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ae1664-0604-b217-002b-b10702f59612
[0m18:12:49.218245 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_10_0' does not exist or not authorized.
[0m18:12:49.228961 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 18:12:48.595262 => 18:12:49.228423
[0m18:12:49.233847 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m18:12:49.417839 [debug] [Thread-1  ]: Database Error in model stg_ipflow_input_data (models/ipflow/stg_ipflow_input_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_10_0' does not exist or not authorized.
  compiled Code at target/run/dbt_dsg_app/models/ipflow/stg_ipflow_input_data.sql
[0m18:12:49.431130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e866b5-f553-4a38-bf89-11fe2697a41a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ed610d0>]}
[0m18:12:49.435795 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model DBT_POC.stg_ipflow_input_data ............ [[31mERROR[0m in 0.85s]
[0m18:12:49.452237 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:12:49.472505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:49.478367 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m18:12:49.486047 [info ] [MainThread]: 
[0m18:12:49.491640 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m18:12:49.497929 [debug] [MainThread]: Command end result
[0m18:12:49.682538 [info ] [MainThread]: 
[0m18:12:49.686754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:12:49.689272 [info ] [MainThread]: 
[0m18:12:49.692328 [error] [MainThread]: [33mDatabase Error in model stg_ipflow_input_data (models/ipflow/stg_ipflow_input_data.sql)[0m
[0m18:12:49.695161 [error] [MainThread]:   002003 (42S02): SQL compilation error:
[0m18:12:49.699327 [error] [MainThread]:   Object 'FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_10_0' does not exist or not authorized.
[0m18:12:49.704285 [error] [MainThread]:   compiled Code at target/run/dbt_dsg_app/models/ipflow/stg_ipflow_input_data.sql
[0m18:12:49.711731 [info ] [MainThread]: 
[0m18:12:49.715456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:12:49.721449 [debug] [MainThread]: Command `dbt run` failed at 18:12:49.721140 after 4.54 seconds
[0m18:12:49.725623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fd7710>]}
[0m18:12:49.729630 [debug] [MainThread]: Flushing usage events
[0m18:14:13.044964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b90c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b90ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b90cbd0>]}


============================== 18:14:13.053024 | 3860e112-f291-480d-9658-5e848dd0c0bd ==============================
[0m18:14:13.053024 [info ] [MainThread]: Running with dbt=1.5.4
[0m18:14:13.062338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:14:13.526844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3860e112-f291-480d-9658-5e848dd0c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b920cd0>]}
[0m18:14:13.539735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3860e112-f291-480d-9658-5e848dd0c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1d2850>]}
[0m18:14:13.542594 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m18:14:13.561745 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m18:14:13.719328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:13.722531 [debug] [MainThread]: Partial parsing: updated file: dbt_dsg_app://models/ipflow/stg_ipflow_input_data.sql
[0m18:14:13.739711 [debug] [MainThread]: 1699: static parser successfully parsed ipflow/stg_ipflow_input_data.sql
[0m18:14:13.839515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3860e112-f291-480d-9658-5e848dd0c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8292c290>]}
[0m18:14:13.908375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3860e112-f291-480d-9658-5e848dd0c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f3c3d0>]}
[0m18:14:13.911552 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:14:13.913661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3860e112-f291-480d-9658-5e848dd0c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f3cd10>]}
[0m18:14:13.916600 [info ] [MainThread]: 
[0m18:14:13.919664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:14:13.923324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m18:14:13.939423 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m18:14:13.942132 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m18:14:13.945024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:14.732693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:14:14.738389 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m18:14:14.913973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m18:14:14.932391 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m18:14:14.935323 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m18:14:14.938067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:15.411090 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m18:14:15.418807 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m18:14:15.596225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3860e112-f291-480d-9658-5e848dd0c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828fc7d0>]}
[0m18:14:15.599816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:15.602704 [info ] [MainThread]: 
[0m18:14:15.611445 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:14:15.614265 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m18:14:15.617097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m18:14:15.619887 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:14:15.624303 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:14:15.664467 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 18:14:15.622385 => 18:14:15.664021
[0m18:14:15.666908 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:14:15.690388 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:14:15.700595 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:14:15.708106 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_11_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m18:14:15.711748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:14:18.776727 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:14:18.796248 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 18:14:15.669320 => 18:14:18.796104
[0m18:14:18.798996 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m18:14:18.981805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3860e112-f291-480d-9658-5e848dd0c0bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81be2450>]}
[0m18:14:18.984802 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 3.36s]
[0m18:14:18.988873 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:14:18.994359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:18.996746 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m18:14:18.999994 [info ] [MainThread]: 
[0m18:14:19.002522 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m18:14:19.005575 [debug] [MainThread]: Command end result
[0m18:14:19.059581 [info ] [MainThread]: 
[0m18:14:19.062553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:19.065325 [info ] [MainThread]: 
[0m18:14:19.070433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:14:19.105775 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:19.105647 after 6.11 seconds
[0m18:14:19.108703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b92ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b92ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b92fcd0>]}
[0m18:14:19.110975 [debug] [MainThread]: Flushing usage events
[0m18:20:27.828812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dd57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dd5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dd5c50>]}


============================== 18:20:27.838109 | 0e3a59ab-d3b2-4fe4-8321-64088cb464e8 ==============================
[0m18:20:27.838109 [info ] [MainThread]: Running with dbt=1.5.4
[0m18:20:27.842263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:20:28.454771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e3a59ab-d3b2-4fe4-8321-64088cb464e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7de8b50>]}
[0m18:20:28.473896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e3a59ab-d3b2-4fe4-8321-64088cb464e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9864c890>]}
[0m18:20:28.479537 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m18:20:28.530387 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m18:20:28.635375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:20:28.638654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:20:28.680146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e3a59ab-d3b2-4fe4-8321-64088cb464e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fef650>]}
[0m18:20:28.744808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e3a59ab-d3b2-4fe4-8321-64088cb464e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7a69d0>]}
[0m18:20:28.747185 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:20:28.749882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e3a59ab-d3b2-4fe4-8321-64088cb464e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7a6c50>]}
[0m18:20:28.752559 [info ] [MainThread]: 
[0m18:20:28.755413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:20:28.758565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m18:20:28.771732 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m18:20:28.775030 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m18:20:28.779928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:29.414049 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:20:29.427122 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m18:20:29.618033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m18:20:29.666809 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m18:20:29.678572 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m18:20:29.681617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:30.207910 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
[0m18:20:30.229211 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m18:20:30.407019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e3a59ab-d3b2-4fe4-8321-64088cb464e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f614f10>]}
[0m18:20:30.412148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:20:30.414910 [info ] [MainThread]: 
[0m18:20:30.424627 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:20:30.428677 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m18:20:30.465235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m18:20:30.468466 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:20:30.473596 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:20:30.483166 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 18:20:30.471137 => 18:20:30.482492
[0m18:20:30.492492 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:20:30.515217 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:20:30.524142 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m18:20:30.534861 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_11_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m18:20:30.537201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:20:32.994099 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:20:33.045666 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 18:20:30.494776 => 18:20:33.045418
[0m18:20:33.050968 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m18:20:33.232476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e3a59ab-d3b2-4fe4-8321-64088cb464e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e872110>]}
[0m18:20:33.240892 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 2.77s]
[0m18:20:33.247942 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m18:20:33.321261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:33.329026 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m18:20:33.333123 [info ] [MainThread]: 
[0m18:20:33.339156 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m18:20:33.384944 [debug] [MainThread]: Command end result
[0m18:20:33.437494 [info ] [MainThread]: 
[0m18:20:33.443976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:33.449278 [info ] [MainThread]: 
[0m18:20:33.454161 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:20:33.457115 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:33.457007 after 5.67 seconds
[0m18:20:33.459647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5c5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb2e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7b5710>]}
[0m18:20:33.463401 [debug] [MainThread]: Flushing usage events
[0m00:00:02.999459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1fb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1fbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1fbc90>]}


============================== 00:00:03.006771 | f0787423-052e-4c61-a4b5-1e0ab24b8330 ==============================
[0m00:00:03.006771 [info ] [MainThread]: Running with dbt=1.5.4
[0m00:00:03.009548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:03.484246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0787423-052e-4c61-a4b5-1e0ab24b8330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab3f8910>]}
[0m00:00:03.532295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0787423-052e-4c61-a4b5-1e0ab24b8330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ee83d0>]}
[0m00:00:03.535266 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m00:00:03.546747 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m00:00:03.657658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:03.660085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:03.668936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0787423-052e-4c61-a4b5-1e0ab24b8330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa84c8510>]}
[0m00:00:03.754499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0787423-052e-4c61-a4b5-1e0ab24b8330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85a5150>]}
[0m00:00:03.757723 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:03.760225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0787423-052e-4c61-a4b5-1e0ab24b8330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85a54d0>]}
[0m00:00:03.770632 [info ] [MainThread]: 
[0m00:00:03.774168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:03.781501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:03.794688 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:03.802201 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:03.805033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:04.465070 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:00:04.471849 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:00:04.670865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m00:00:04.721340 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:00:04.724994 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:00:04.733051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.165378 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:00:05.172346 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:00:05.626043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0787423-052e-4c61-a4b5-1e0ab24b8330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83c6690>]}
[0m00:00:05.630686 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:05.636475 [info ] [MainThread]: 
[0m00:00:05.664692 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:05.673334 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:00:05.676992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:00:05.720768 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:05.728187 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:05.746284 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:00:05.724848 => 00:00:05.745992
[0m00:00:05.749321 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:05.783390 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:05.811422 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:05.813638 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_11_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:00:05.829449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:08.838484 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m00:00:08.865566 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:00:05.752233 => 00:00:08.865306
[0m00:00:08.869466 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:00:09.047759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0787423-052e-4c61-a4b5-1e0ab24b8330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85a5b50>]}
[0m00:00:09.051809 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 3.37s]
[0m00:00:09.054860 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:09.144473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:09.147963 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m00:00:09.151445 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:00:09.155251 [info ] [MainThread]: 
[0m00:00:09.158622 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m00:00:09.161660 [debug] [MainThread]: Command end result
[0m00:00:09.237466 [info ] [MainThread]: 
[0m00:00:09.244677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:09.247306 [info ] [MainThread]: 
[0m00:00:09.249511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:00:09.252287 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:09.252189 after 6.28 seconds
[0m00:00:09.254106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba216b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba210250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba210390>]}
[0m00:00:09.256073 [debug] [MainThread]: Flushing usage events
[0m00:00:02.703473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaec1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaec1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaec1d50>]}


============================== 00:00:02.713418 | 12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28 ==============================
[0m00:00:02.713418 [info ] [MainThread]: Running with dbt=1.5.4
[0m00:00:02.716900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:03.226655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaedbe50>]}
[0m00:00:03.238576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaec1390>]}
[0m00:00:03.249891 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m00:00:03.261314 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m00:00:03.371121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:03.373903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:03.382836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9897f310>]}
[0m00:00:03.487071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99673e90>]}
[0m00:00:03.490690 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:03.500164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99673790>]}
[0m00:00:03.504308 [info ] [MainThread]: 
[0m00:00:03.509297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:03.517305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:03.537122 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:03.546688 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:03.549859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:04.631628 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:00:04.637326 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:00:04.822680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:00:04.836145 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:00:04.841518 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:00:04.844400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:05.340074 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:00:05.344517 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:00:05.518326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98883d90>]}
[0m00:00:05.521799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:05.524425 [info ] [MainThread]: 
[0m00:00:05.533449 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:05.536239 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:00:05.545488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:00:05.548380 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:05.553304 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:05.570116 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:00:05.551190 => 00:00:05.569709
[0m00:00:05.572634 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:05.600314 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:05.670353 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:05.676967 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_11_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:00:05.679061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:08.210097 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m00:00:08.231228 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:00:05.576491 => 00:00:08.231071
[0m00:00:08.236029 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:00:08.428935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e0a9df-e18d-4ddb-a8c7-567d9cf1aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9146c290>]}
[0m00:00:08.438009 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 2.88s]
[0m00:00:08.441952 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:08.528439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:08.532303 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:00:08.536914 [info ] [MainThread]: 
[0m00:00:08.539731 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m00:00:08.544191 [debug] [MainThread]: Command end result
[0m00:00:08.641623 [info ] [MainThread]: 
[0m00:00:08.645517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:08.648038 [info ] [MainThread]: 
[0m00:00:08.661125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:00:08.668165 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:08.668051 after 6.00 seconds
[0m00:00:08.671114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaeecd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaeecf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaeecd10>]}
[0m00:00:08.673430 [debug] [MainThread]: Flushing usage events
[0m00:04:05.224270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bc9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bc9f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bc9c50>]}


============================== 00:04:05.233632 | 68110ad5-dbd7-4f07-bc52-2a5edbf8f642 ==============================
[0m00:04:05.233632 [info ] [MainThread]: Running with dbt=1.5.4
[0m00:04:05.237300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:04:05.932203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68110ad5-dbd7-4f07-bc52-2a5edbf8f642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1be4d90>]}
[0m00:04:05.955454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68110ad5-dbd7-4f07-bc52-2a5edbf8f642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41d5690>]}
[0m00:04:05.961589 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m00:04:05.976708 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m00:04:06.186419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:06.190983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:06.200808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68110ad5-dbd7-4f07-bc52-2a5edbf8f642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892c2510>]}
[0m00:04:06.262902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68110ad5-dbd7-4f07-bc52-2a5edbf8f642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90088dd0>]}
[0m00:04:06.265519 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:04:06.269198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68110ad5-dbd7-4f07-bc52-2a5edbf8f642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900888d0>]}
[0m00:04:06.272162 [info ] [MainThread]: 
[0m00:04:06.275328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:06.278530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:04:06.293722 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:04:06.349624 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:04:06.357746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:07.384072 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:04:07.398798 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:04:07.569116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:04:07.579936 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:04:07.599442 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:04:07.603987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:08.090687 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:04:08.101208 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:04:08.312325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68110ad5-dbd7-4f07-bc52-2a5edbf8f642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892d4450>]}
[0m00:04:08.316017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:04:08.318844 [info ] [MainThread]: 
[0m00:04:08.328042 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:04:08.330737 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:04:08.334123 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:04:08.336645 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:04:08.343532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:04:08.359925 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:04:08.341075 => 00:04:08.359593
[0m00:04:08.362546 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:04:08.384193 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:04:08.459847 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:04:08.462308 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_11_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:04:08.473089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:04:11.392422 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m00:04:11.438938 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:04:08.364452 => 00:04:11.438618
[0m00:04:11.444470 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:04:11.632480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68110ad5-dbd7-4f07-bc52-2a5edbf8f642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9007a910>]}
[0m00:04:11.667661 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 3.30s]
[0m00:04:11.672321 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:04:11.776250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:11.794441 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:04:11.798160 [info ] [MainThread]: 
[0m00:04:11.800886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m00:04:11.804329 [debug] [MainThread]: Command end result
[0m00:04:11.840175 [info ] [MainThread]: 
[0m00:04:11.842721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:04:11.844976 [info ] [MainThread]: 
[0m00:04:11.848314 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:04:11.851630 [debug] [MainThread]: Command `dbt run` succeeded at 00:04:11.851519 after 6.67 seconds
[0m00:04:11.854571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1be00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bf5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bf5f90>]}
[0m00:04:11.857624 [debug] [MainThread]: Flushing usage events
[0m00:00:03.621750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94af7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94af7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94af7bd0>]}


============================== 00:00:03.629516 | 945876ac-26e3-4e4d-b4cb-3be38a657020 ==============================
[0m00:00:03.629516 [info ] [MainThread]: Running with dbt=1.5.4
[0m00:00:03.632521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:04.154009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '945876ac-26e3-4e4d-b4cb-3be38a657020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b1bed0>]}
[0m00:00:04.168839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '945876ac-26e3-4e4d-b4cb-3be38a657020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9673b490>]}
[0m00:00:04.172176 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m00:00:04.261743 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m00:00:04.421644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:04.426349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:04.440538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '945876ac-26e3-4e4d-b4cb-3be38a657020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c302590>]}
[0m00:00:04.481739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '945876ac-26e3-4e4d-b4cb-3be38a657020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0b8350>]}
[0m00:00:04.484046 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:04.486427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '945876ac-26e3-4e4d-b4cb-3be38a657020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0b89d0>]}
[0m00:00:04.491409 [info ] [MainThread]: 
[0m00:00:04.494300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:00:04.497575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m00:00:04.512264 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m00:00:04.521191 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m00:00:04.527069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.724277 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m00:00:05.729311 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m00:00:05.920861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_QA, now list_DEV_QA_DBT_POC)
[0m00:00:05.936255 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m00:00:05.939636 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m00:00:05.959328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:06.377569 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m00:00:06.388440 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m00:00:06.598721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '945876ac-26e3-4e4d-b4cb-3be38a657020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2c4c10>]}
[0m00:00:06.607357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:06.616111 [info ] [MainThread]: 
[0m00:00:06.636992 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:06.640661 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m00:00:06.644064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m00:00:06.647013 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:06.651563 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:06.671016 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 00:00:06.649292 => 00:00:06.670702
[0m00:00:06.673294 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:06.695788 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:06.772246 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m00:00:06.775365 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_11_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m00:00:06.779247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:09.321913 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m00:00:09.367123 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 00:00:06.675640 => 00:00:09.366918
[0m00:00:09.370199 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m00:00:09.556023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '945876ac-26e3-4e4d-b4cb-3be38a657020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff773696d0>]}
[0m00:00:09.570947 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 2.91s]
[0m00:00:09.578634 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m00:00:09.663035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:09.666299 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m00:00:09.672202 [info ] [MainThread]: 
[0m00:00:09.680256 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m00:00:09.686670 [debug] [MainThread]: Command end result
[0m00:00:09.725738 [info ] [MainThread]: 
[0m00:00:09.729938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:09.733054 [info ] [MainThread]: 
[0m00:00:09.735954 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:00:09.738614 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:09.738491 after 6.16 seconds
[0m00:00:09.803645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b1bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b1bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b1bcd0>]}
[0m00:00:09.806253 [debug] [MainThread]: Flushing usage events
[0m13:56:16.408977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6979810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6979f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6979c50>]}


============================== 13:56:16.416813 | 115de9bf-1821-47be-a2f5-74bbc0685dc8 ==============================
[0m13:56:16.416813 [info ] [MainThread]: Running with dbt=1.5.4
[0m13:56:16.420007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/dbt_dsg_app/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:56:17.155440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '115de9bf-1821-47be-a2f5-74bbc0685dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6993b50>]}
[0m13:56:17.169012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '115de9bf-1821-47be-a2f5-74bbc0685dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a020d0>]}
[0m13:56:17.179179 [info ] [MainThread]: Registered adapter: snowflake=1.5.1
[0m13:56:17.191520 [debug] [MainThread]: checksum: 4ae71392e2d5fedaff752880eb5cefdeb993a2e058ebd7ff8fcd5cc9af6bd535, vars: {'env': 'dev'}, profile: , target: dev, version: 1.5.4
[0m13:56:17.332936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:17.339006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:17.349197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '115de9bf-1821-47be-a2f5-74bbc0685dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9447f2d0>]}
[0m13:56:17.405922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '115de9bf-1821-47be-a2f5-74bbc0685dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94566290>]}
[0m13:56:17.408922 [info ] [MainThread]: Found 12 models, 2 tests, 0 snapshots, 0 analyses, 322 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:56:17.411852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115de9bf-1821-47be-a2f5-74bbc0685dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94566710>]}
[0m13:56:17.415156 [info ] [MainThread]: 
[0m13:56:17.428111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:56:17.431832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA'
[0m13:56:17.443113 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA"
[0m13:56:17.446756 [debug] [ThreadPool]: On list_DEV_QA: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA"} */
show terse schemas in database DEV_QA
    limit 10000
[0m13:56:17.449757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:18.233646 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:56:18.240708 [debug] [ThreadPool]: On list_DEV_QA: Close
[0m13:56:18.431381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_QA_DBT_POC'
[0m13:56:18.511119 [debug] [ThreadPool]: Using snowflake connection "list_DEV_QA_DBT_POC"
[0m13:56:18.514728 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "connection_name": "list_DEV_QA_DBT_POC"} */
show terse objects in DEV_QA.DBT_POC
[0m13:56:18.520933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:18.917369 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.0 seconds
[0m13:56:18.928426 [debug] [ThreadPool]: On list_DEV_QA_DBT_POC: Close
[0m13:56:19.147044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115de9bf-1821-47be-a2f5-74bbc0685dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4dced0>]}
[0m13:56:19.155909 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:19.167478 [info ] [MainThread]: 
[0m13:56:19.202389 [debug] [Thread-1  ]: Began running node model.dbt_dsg_app.stg_ipflow_input_data
[0m13:56:19.211399 [info ] [Thread-1  ]: 1 of 1 START sql table model DBT_POC.stg_ipflow_input_data ..................... [RUN]
[0m13:56:19.227913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DEV_QA_DBT_POC, now model.dbt_dsg_app.stg_ipflow_input_data)
[0m13:56:19.252909 [debug] [Thread-1  ]: Began compiling node model.dbt_dsg_app.stg_ipflow_input_data
[0m13:56:19.261016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m13:56:19.293362 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (compile): 13:56:19.255194 => 13:56:19.293053
[0m13:56:19.314413 [debug] [Thread-1  ]: Began executing node model.dbt_dsg_app.stg_ipflow_input_data
[0m13:56:19.450889 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dsg_app.stg_ipflow_input_data"
[0m13:56:19.505397 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_dsg_app.stg_ipflow_input_data"
[0m13:56:19.513507 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: /* {"app": "dbt", "dbt_version": "1.5.4", "profile_name": "dbt_dsg_app", "target_name": "dev", "node_id": "model.dbt_dsg_app.stg_ipflow_input_data"} */
create or replace transient table DEV_QA.DBT_POC.stg_ipflow_input_data
         as
        (

with mapped_ips as (
select  DISTINCT BD.USER_IP 
 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN FIVE_BY_FIVE_DEMO.PRODUCTS.IP_COMPANY_2_11_0 AS FBF 
ON IP_ADDRESS =  USER_IP

UNION 

select  DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
INNER JOIN DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA AS IPF 
ON BD.USER_IP =  IPF.USER_IP
WHERE IPF.LAST_RESPONSE_CODE = 200
)
, unmapped_ips as (
select DISTINCT BD.USER_IP 
FROM DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY AS BD 
where BD.USER_IP not in (select user_ip from mapped_ips)
) ,
unmapped_ips_frequency as (
select a.USER_IP, count(b.PAGE_URL) as frequency from unmapped_ips as a 
left join DEV_BIDSTREAM.ACTIVITY.USER_ACTIVITY b 
on a.USER_IP = b.USER_IP
group by a.USER_IP
),
unmapped_ips_ranked as (
select a.*, row_number() over (order by frequency desc) as row_number_ranked
  from unmapped_ips_frequency as a
),
unmapped_ips_zero_deprioritized as (
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) <> 0
union
select USER_IP from unmapped_ips_ranked where SPLIT_PART(USER_IP, '.', 4) = 0 
)
select USER_IP from unmapped_ips_zero_deprioritized a
where not exists  
( select null from DEV_IP_FLOW.STAGING.IP_FLOW_API_OUTPUT_DATA as b  
where a.USER_IP = b.USER_IP   
and ( b.LAST_QUERY_DATE >= DATE( DATEADD(day, -30, GETDATE()) ) 
and b.LAST_RESPONSE_CODE = 204 )  )
limit 1
        );
[0m13:56:19.525153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:22.942961 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:56:23.161321 [debug] [Thread-1  ]: Timing info for model.dbt_dsg_app.stg_ipflow_input_data (execute): 13:56:19.319081 => 13:56:23.160182
[0m13:56:23.173005 [debug] [Thread-1  ]: On model.dbt_dsg_app.stg_ipflow_input_data: Close
[0m13:56:23.420553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115de9bf-1821-47be-a2f5-74bbc0685dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4a9ed0>]}
[0m13:56:23.434262 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DBT_POC.stg_ipflow_input_data ................ [[32mSUCCESS 1[0m in 4.19s]
[0m13:56:23.492915 [debug] [Thread-1  ]: Finished running node model.dbt_dsg_app.stg_ipflow_input_data
[0m13:56:23.561354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:23.708202 [debug] [MainThread]: Connection 'list_DEV_QA' was properly closed.
[0m13:56:23.719088 [debug] [MainThread]: Connection 'model.dbt_dsg_app.stg_ipflow_input_data' was properly closed.
[0m13:56:23.749388 [info ] [MainThread]: 
[0m13:56:23.757370 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m13:56:23.765840 [debug] [MainThread]: Command end result
[0m13:56:23.961271 [info ] [MainThread]: 
[0m13:56:23.977987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:23.985932 [info ] [MainThread]: 
[0m13:56:23.990506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:56:24.000839 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:24.000384 after 7.64 seconds
[0m13:56:24.007372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69a2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69a2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69a2b50>]}
[0m13:56:24.014995 [debug] [MainThread]: Flushing usage events
[0m10:11:49.542473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf104d0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef0658cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef0658e80>]}


============================== 10:11:49.547250 | 547542c7-aca8-419f-8bfb-391555acc898 ==============================
[0m10:11:49.547250 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:11:49.547826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:11:49.548314 [info ] [MainThread]: dbt version: 1.5.1
[0m10:11:49.548603 [info ] [MainThread]: python version: 3.9.13
[0m10:11:49.548880 [info ] [MainThread]: python path: /Users/dayookubanjo/Documents/dev-test-local/dsg-airflow-standalone/dbt_venv/bin/python
[0m10:11:49.549158 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m10:11:49.549433 [info ] [MainThread]: Using profiles.yml file at /Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app/profiles.yml
[0m10:11:49.549734 [info ] [MainThread]: Using dbt_project.yml file at /Users/dayookubanjo/Documents/dev-test-local/ec2-dsg-airflow-standalone/dbt/dbt_dsg_app/dbt_project.yml
[0m10:11:49.550019 [info ] [MainThread]: Configuration:
[0m10:11:50.003780 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:11:50.022422 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:11:50.022952 [info ] [MainThread]: Required dependencies:
[0m10:11:50.023354 [debug] [MainThread]: Executing "git --help"
[0m10:11:50.096971 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:11:50.097838 [debug] [MainThread]: STDERR: "b''"
[0m10:11:50.098128 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:11:50.098452 [info ] [MainThread]: Connection:
[0m10:11:50.098901 [info ] [MainThread]:   account: bcb55215.us-east-1
[0m10:11:50.099272 [info ] [MainThread]:   user: DEV_AIRFLOW
[0m10:11:50.099566 [info ] [MainThread]:   database: DEV_QA
[0m10:11:50.099844 [info ] [MainThread]:   schema: DBT_POC
[0m10:11:50.100112 [info ] [MainThread]:   warehouse: dev_transform
[0m10:11:50.100372 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:11:50.100634 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:11:50.100893 [info ] [MainThread]:   query_tag: None
[0m10:11:50.110605 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:11:50.112183 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:11:50.112449 [debug] [MainThread]: On debug: select 1 as id
[0m10:11:50.112710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:51.613529 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:11:51.615796 [debug] [MainThread]: On debug: Close
[0m10:11:51.703700 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:11:51.704358 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:11:51.705462 [debug] [MainThread]: Command `dbt debug` succeeded at 10:11:51.705105 after 2.20 seconds
[0m10:11:51.705857 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:11:51.706236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf104d0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf01d38550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf019f9e80>]}
[0m10:11:51.706679 [debug] [MainThread]: Flushing usage events
